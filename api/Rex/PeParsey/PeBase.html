<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>
  Class: Rex::PeParsey::PeBase
  
    &mdash; Documentation by YARD 0.8.7.6
  
</title>

  <link rel="stylesheet" href="../../css/style.css" type="text/css" charset="utf-8" />

  <link rel="stylesheet" href="../../css/common.css" type="text/css" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  hasFrames = window.top.frames.main ? true : false;
  relpath = '../../';
  framesUrl = "../../frames.html#!Rex/PeParsey/PeBase.html";
</script>


  <script type="text/javascript" charset="utf-8" src="../../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../../js/app.js"></script>


  </head>
  <body>
    <div id="header">
      <div id="menu">
  
    <a href="../../_index.html">Index (P)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../../Rex.html" title="Rex (module)">Rex</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../PeParsey.html" title="Rex::PeParsey (module)">PeParsey</a></span></span>
     &raquo; 
    <span class="title">PeBase</span>
  

  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../../class_list.html">
      Class List
    </a>
  
    <a class="full_list_link" id="method_list_link"
        href="../../method_list.html">
      Method List
    </a>
  
    <a class="full_list_link" id="file_list_link"
        href="../../file_list.html">
      File List
    </a>
  
</div>
      <div class="clear"></div>
    </div>

    <iframe id="search_frame"></iframe>

    <div id="content"><h1>Class: Rex::PeParsey::PeBase
  
  
  
</h1>

<dl class="box">
  
    <dt class="r1">Inherits:</dt>
    <dd class="r1">
      <span class="inheritName">Object</span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next">Rex::PeParsey::PeBase</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
      </dd>
    
  
  
    
  
    
  
  
  
    <dt class="r2 last">Defined in:</dt>
    <dd class="r2 last">lib/rex/peparsey/pebase.rb</dd>
  
</dl>
<div class="clear"></div>

<div id="subclasses">
  <h2>Direct Known Subclasses</h2>
  <p class="children"><span class='object_link'><a href="Pe.html" title="Rex::PeParsey::Pe (class)">Pe</a></span></p>
</div>
<h2>Defined Under Namespace</h2>
<p class="children">
  
    
  
    
      <strong class="classes">Classes:</strong> <span class='object_link'><a href="PeBase/ConfigHeader.html" title="Rex::PeParsey::PeBase::ConfigHeader (class)">ConfigHeader</a></span>, <span class='object_link'><a href="PeBase/DosHeader.html" title="Rex::PeParsey::PeBase::DosHeader (class)">DosHeader</a></span>, <span class='object_link'><a href="PeBase/ExportDirectory.html" title="Rex::PeParsey::PeBase::ExportDirectory (class)">ExportDirectory</a></span>, <span class='object_link'><a href="PeBase/ExportEntry.html" title="Rex::PeParsey::PeBase::ExportEntry (class)">ExportEntry</a></span>, <span class='object_link'><a href="PeBase/FileHeader.html" title="Rex::PeParsey::PeBase::FileHeader (class)">FileHeader</a></span>, <span class='object_link'><a href="PeBase/GenericHeader.html" title="Rex::PeParsey::PeBase::GenericHeader (class)">GenericHeader</a></span>, <span class='object_link'><a href="PeBase/GenericStruct.html" title="Rex::PeParsey::PeBase::GenericStruct (class)">GenericStruct</a></span>, <span class='object_link'><a href="PeBase/HeaderAccessor.html" title="Rex::PeParsey::PeBase::HeaderAccessor (class)">HeaderAccessor</a></span>, <span class='object_link'><a href="PeBase/ImportDescriptor.html" title="Rex::PeParsey::PeBase::ImportDescriptor (class)">ImportDescriptor</a></span>, <span class='object_link'><a href="PeBase/ImportEntry.html" title="Rex::PeParsey::PeBase::ImportEntry (class)">ImportEntry</a></span>, <span class='object_link'><a href="PeBase/OptionalHeader.html" title="Rex::PeParsey::PeBase::OptionalHeader (class)">OptionalHeader</a></span>, <span class='object_link'><a href="PeBase/OptionalHeader32.html" title="Rex::PeParsey::PeBase::OptionalHeader32 (class)">OptionalHeader32</a></span>, <span class='object_link'><a href="PeBase/OptionalHeader64.html" title="Rex::PeParsey::PeBase::OptionalHeader64 (class)">OptionalHeader64</a></span>, <span class='object_link'><a href="PeBase/RelocationDirectory.html" title="Rex::PeParsey::PeBase::RelocationDirectory (class)">RelocationDirectory</a></span>, <span class='object_link'><a href="PeBase/RelocationEntry.html" title="Rex::PeParsey::PeBase::RelocationEntry (class)">RelocationEntry</a></span>, <span class='object_link'><a href="PeBase/ResourceDirectory.html" title="Rex::PeParsey::PeBase::ResourceDirectory (class)">ResourceDirectory</a></span>, <span class='object_link'><a href="PeBase/ResourceEntry.html" title="Rex::PeParsey::PeBase::ResourceEntry (class)">ResourceEntry</a></span>, <span class='object_link'><a href="PeBase/RuntimeFunctionEntry.html" title="Rex::PeParsey::PeBase::RuntimeFunctionEntry (class)">RuntimeFunctionEntry</a></span>, <span class='object_link'><a href="PeBase/SectionHeader.html" title="Rex::PeParsey::PeBase::SectionHeader (class)">SectionHeader</a></span>, <span class='object_link'><a href="PeBase/TLSHeader.html" title="Rex::PeParsey::PeBase::TLSHeader (class)">TLSHeader</a></span>, <span class='object_link'><a href="PeBase/UnwindCode.html" title="Rex::PeParsey::PeBase::UnwindCode (class)">UnwindCode</a></span>, <span class='object_link'><a href="PeBase/UnwindInfo.html" title="Rex::PeParsey::PeBase::UnwindInfo (class)">UnwindInfo</a></span>
    
  
</p>

  <h2>Constant Summary</h2>
  
    <dl class="constants">
      
        <dt id="IMAGE_DOS_SIGNATURE-constant" class="">IMAGE_DOS_SIGNATURE =
          <div class="docstring">
  <div class="discussion">
    
<p>#define IMAGE_DOS_SIGNATURE                 0x5A4D      // MZ</p>


  </div>
</div>
<div class="tags">
  

</div>
        </dt>
        <dd><pre class="code"><span class='int'>0x5a4d</span></pre></dd>
      
        <dt id="IMAGE_DOS_HEADER_SIZE-constant" class="">IMAGE_DOS_HEADER_SIZE =
          
        </dt>
        <dd><pre class="code"><span class='int'>64</span></pre></dd>
      
        <dt id="IMAGE_DOS_HEADER-constant" class="">IMAGE_DOS_HEADER =
          <div class="docstring">
  <div class="discussion">
    
<p>Struct</p>

<pre class="code ruby"><code class="ruby">typedef struct _IMAGE_DOS_HEADER {      // DOS .EXE header
    WORD   e_magic;                     // Magic number
    WORD   e_cblp;                      // Bytes on last page of file
    WORD   e_cp;                        // Pages in file
    WORD   e_crlc;                      // Relocations
    WORD   e_cparhdr;                   // Size of header in paragraphs
    WORD   e_minalloc;                  // Minimum extra paragraphs needed
    WORD   e_maxalloc;                  // Maximum extra paragraphs needed
    WORD   e_ss;                        // Initial (relative) SS value
    WORD   e_sp;                        // Initial SP value
    WORD   e_csum;                      // Checksum
    WORD   e_ip;                        // Initial IP value
    WORD   e_cs;                        // Initial (relative) CS value
    WORD   e_lfarlc;                    // File address of relocation table
    WORD   e_ovno;                      // Overlay number
    WORD   e_res[4];                    // Reserved words
    WORD   e_oemid;                     // OEM identifier (for e_oeminfo)
    WORD   e_oeminfo;                   // OEM information; e_oemid specific
    WORD   e_res2[10];                  // Reserved words
    LONG   e_lfanew;                    // File address of new exe header
} IMAGE_DOS_HEADER, *PIMAGE_DOS_HEADER;</code></pre>


  </div>
</div>
<div class="tags">
  

</div>
        </dt>
        <dd><pre class="code"><span class='const'>Rex</span><span class='op'>::</span><span class='const'>Struct2</span><span class='op'>::</span><span class='const'>CStructTemplate</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint16v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>e_magic</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>     <span class='const'>IMAGE_DOS_SIGNATURE</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint16v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>e_cblp</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>      <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint16v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>e_cp</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>        <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint16v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>e_crlc</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>      <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint16v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>e_cparhdr</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>   <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint16v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>e_minalloc</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>  <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint16v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>e_maxalloc</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>  <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint16v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>e_ss</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>        <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint16v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>e_sp</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>        <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint16v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>e_csum</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>      <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint16v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>e_ip</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>        <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint16v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>e_cs</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>        <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint16v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>e_lfarlc</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>    <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint16v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>e_ovno</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>      <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>template</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>e_res</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='const'>Rex</span><span class='op'>::</span><span class='const'>Struct2</span><span class='op'>::</span><span class='const'>CStructTemplate</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span>
    <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint16v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>e_res_0</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
    <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint16v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>e_res_1</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
    <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint16v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>e_res_2</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
    <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint16v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>e_res_3</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='int'>0</span> <span class='rbracket'>]</span>
  <span class='rparen'>)</span><span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint16v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>e_oemid</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>     <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint16v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>e_oeminfo</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>   <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>template</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>e_res2</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='const'>Rex</span><span class='op'>::</span><span class='const'>Struct2</span><span class='op'>::</span><span class='const'>CStructTemplate</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span>
    <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint16v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>e_res2_0</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
    <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint16v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>e_res2_1</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
    <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint16v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>e_res2_2</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
    <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint16v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>e_res2_3</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
    <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint16v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>e_res2_4</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
    <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint16v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>e_res2_5</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
    <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint16v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>e_res2_6</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
    <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint16v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>e_res2_7</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
    <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint16v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>e_res2_8</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
    <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint16v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>e_res2_9</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='int'>0</span> <span class='rbracket'>]</span>
  <span class='rparen'>)</span><span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint32v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>e_lfanew</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>    <span class='int'>0</span> <span class='rbracket'>]</span>
<span class='rparen'>)</span></pre></dd>
      
        <dt id="IMAGE_NT_SIGNATURE-constant" class="">IMAGE_NT_SIGNATURE =
          <div class="docstring">
  <div class="discussion">
    
<p>#define IMAGE_NT_SIGNATURE                  0x00004550  // PE00</p>


  </div>
</div>
<div class="tags">
  

</div>
        </dt>
        <dd><pre class="code"><span class='int'>0x00004550</span></pre></dd>
      
        <dt id="IMAGE_FILE_MACHINE_I386-constant" class="">IMAGE_FILE_MACHINE_I386 =
          <div class="docstring">
  <div class="discussion">
    
<p>#define IMAGE_FILE_MACHINE_I386              0x014c  // Intel 386.</p>


  </div>
</div>
<div class="tags">
  

</div>
        </dt>
        <dd><pre class="code"><span class='int'>0x014c</span></pre></dd>
      
        <dt id="IMAGE_FILE_MACHINE_IA64-constant" class="">IMAGE_FILE_MACHINE_IA64 =
          <div class="docstring">
  <div class="discussion">
    
<p>#define IMAGE_FILE_MACHINE_IA64              0x0200  // Intel 64</p>


  </div>
</div>
<div class="tags">
  

</div>
        </dt>
        <dd><pre class="code"><span class='int'>0x0200</span></pre></dd>
      
        <dt id="IMAGE_FILE_MACHINE_ALPHA64-constant" class="">IMAGE_FILE_MACHINE_ALPHA64 =
          <div class="docstring">
  <div class="discussion">
    
<p>#define IMAGE_FILE_MACHINE_ALPHA64           0x0284  // ALPHA64</p>


  </div>
</div>
<div class="tags">
  

</div>
        </dt>
        <dd><pre class="code"><span class='int'>0x0284</span></pre></dd>
      
        <dt id="IMAGE_FILE_MACHINE_AMD64-constant" class="">IMAGE_FILE_MACHINE_AMD64 =
          <div class="docstring">
  <div class="discussion">
    
<p>#define IMAGE_FILE_MACHINE_AMD64             0x8664  // AMD64 (K8)</p>


  </div>
</div>
<div class="tags">
  

</div>
        </dt>
        <dd><pre class="code"><span class='int'>0x8664</span></pre></dd>
      
        <dt id="IMAGE_FILE_HEADER_SIZE-constant" class="">IMAGE_FILE_HEADER_SIZE =
          <div class="docstring">
  <div class="discussion">
    
<p>#define IMAGE_SIZEOF_FILE_HEADER             20</p>


  </div>
</div>
<div class="tags">
  

</div>
        </dt>
        <dd><pre class="code"><span class='int'>20</span><span class='op'>+</span><span class='int'>4</span></pre></dd>
      
        <dt id="IMAGE_FILE_HEADER-constant" class="">IMAGE_FILE_HEADER =
          <div class="docstring">
  <div class="discussion">
    
<p>C struct defining the PE file header</p>

<pre class="code ruby"><code class="ruby">typedef struct _IMAGE_FILE_HEADER {
    WORD    Machine;
    WORD    NumberOfSections;
    DWORD   TimeDateStamp;
    DWORD   PointerToSymbolTable;
    DWORD   NumberOfSymbols;
    WORD    SizeOfOptionalHeader;
    WORD    Characteristics;
} IMAGE_FILE_HEADER, *PIMAGE_FILE_HEADER;</code></pre>


  </div>
</div>
<div class="tags">
  

</div>
        </dt>
        <dd><pre class="code"><span class='const'>Rex</span><span class='op'>::</span><span class='const'>Struct2</span><span class='op'>::</span><span class='const'>CStructTemplate</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span>
  <span class='comment'># not really in the header, but easier for us this way
</span>  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint32v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>NtSignature</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>           <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint16v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Machine</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>               <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint16v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>NumberOfSections</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>      <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint32v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>TimeDateStamp</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>         <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint32v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>PointerToSymbolTable</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>  <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint32v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>NumberOfSymbols</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>       <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint16v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>SizeOfOptionalHeader</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>  <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint16v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Characteristics</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>       <span class='int'>0</span> <span class='rbracket'>]</span>
<span class='rparen'>)</span></pre></dd>
      
        <dt id="SUPPORTED_MACHINES-constant" class="">SUPPORTED_MACHINES =
          
        </dt>
        <dd><pre class="code"><span class='lbracket'>[</span>
  <span class='const'>IMAGE_FILE_MACHINE_I386</span><span class='comma'>,</span>
  <span class='const'>IMAGE_FILE_MACHINE_IA64</span><span class='comma'>,</span>
  <span class='const'>IMAGE_FILE_MACHINE_ALPHA64</span><span class='comma'>,</span>
  <span class='const'>IMAGE_FILE_MACHINE_AMD64</span>
<span class='rbracket'>]</span></pre></dd>
      
        <dt id="IMAGE_ORDINAL_FLAG32-constant" class="">IMAGE_ORDINAL_FLAG32 =
          
        </dt>
        <dd><pre class="code"><span class='int'>0x80000000</span></pre></dd>
      
        <dt id="IMAGE_IMPORT_DESCRIPTOR_SIZE-constant" class="">IMAGE_IMPORT_DESCRIPTOR_SIZE =
          
        </dt>
        <dd><pre class="code"><span class='int'>20</span></pre></dd>
      
        <dt id="IMAGE_IMPORT_DESCRIPTOR-constant" class="">IMAGE_IMPORT_DESCRIPTOR =
          <div class="docstring">
  <div class="discussion">
    
<p>Struct</p>

<pre class="code ruby"><code class="ruby">typedef struct _IMAGE_IMPORT_DESCRIPTOR {
    union {
        DWORD   Characteristics;            // 0 for terminating null import descriptor
        DWORD   OriginalFirstThunk;         // RVA to original unbound IAT (PIMAGE_THUNK_DATA)
    };
    DWORD   TimeDateStamp;                  // 0 if not bound,
                                            // -1 if bound, and real date\time stamp
                                            //     in IMAGE_DIRECTORY_ENTRY_BOUND_IMPORT (new BIND)
                                            // O.W. date/time stamp of DLL bound to (Old BIND)

    DWORD   ForwarderChain;                 // -1 if no forwarders
    DWORD   Name;
    DWORD   FirstThunk;                     // RVA to IAT (if bound this IAT has actual addresses)
} IMAGE_IMPORT_DESCRIPTOR;</code></pre>


  </div>
</div>
<div class="tags">
  

</div>
        </dt>
        <dd><pre class="code"><span class='const'>Rex</span><span class='op'>::</span><span class='const'>Struct2</span><span class='op'>::</span><span class='const'>CStructTemplate</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint32v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>OriginalFirstThunk</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>           <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint32v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>TimeDateStamp</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>                <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint32v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>ForwarderChain</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>               <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint32v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Name</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>                         <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint32v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>FirstThunk</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>                   <span class='int'>0</span> <span class='rbracket'>]</span>
<span class='rparen'>)</span></pre></dd>
      
        <dt id="IMAGE_EXPORT_DESCRIPTOR_SIZE-constant" class="">IMAGE_EXPORT_DESCRIPTOR_SIZE =
          <div class="docstring">
  <div class="discussion">
    
<p>sizeof(struct _IMAGE_EXPORT_DESCRIPTOR)</p>


  </div>
</div>
<div class="tags">
  

</div>
        </dt>
        <dd><pre class="code"><span class='int'>40</span></pre></dd>
      
        <dt id="IMAGE_EXPORT_DESCRIPTOR-constant" class="">IMAGE_EXPORT_DESCRIPTOR =
          <div class="docstring">
  <div class="discussion">
    
<p>Struct defining the export table</p>

<pre class="code ruby"><code class="ruby">typedef struct _IMAGE_EXPORT_DIRECTORY {
    DWORD   Characteristics;
    DWORD   TimeDateStamp;
    WORD    MajorVersion;
    WORD    MinorVersion;
    DWORD   Name;
    DWORD   Base;
    DWORD   NumberOfFunctions;
    DWORD   NumberOfNames;
    DWORD   AddressOfFunctions;     // RVA from base of image
    DWORD   AddressOfNames;         // RVA from base of image
    DWORD   AddressOfNameOrdinals;  // RVA from base of image
} IMAGE_EXPORT_DIRECTORY, *PIMAGE_EXPORT_DIRECTORY;</code></pre>


  </div>
</div>
<div class="tags">
  

</div>
        </dt>
        <dd><pre class="code"><span class='const'>Rex</span><span class='op'>::</span><span class='const'>Struct2</span><span class='op'>::</span><span class='const'>CStructTemplate</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint32v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Characteristics</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>              <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint32v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>TimeDateStamp</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>                <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint16v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>MajorVersion</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>                 <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint16v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>MinorVersion</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>                 <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint32v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Name</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>                         <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint32v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Base</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>                         <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint32v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>NumberOfFunctions</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>            <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint32v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>NumberOfNames</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>                <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint32v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>AddressOfFunctions</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>           <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint32v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>AddressOfNames</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>               <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint32v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>AddressOfNameOrdinals</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>        <span class='int'>0</span> <span class='rbracket'>]</span>
<span class='rparen'>)</span></pre></dd>
      
        <dt id="IMAGE_NUMBEROF_DIRECTORY_ENTRIES-constant" class="">IMAGE_NUMBEROF_DIRECTORY_ENTRIES =
          
        </dt>
        <dd><pre class="code"><span class='int'>16</span></pre></dd>
      
        <dt id="IMAGE_DATA_DIRECTORY_SIZE-constant" class="">IMAGE_DATA_DIRECTORY_SIZE =
          
        </dt>
        <dd><pre class="code"><span class='int'>8</span></pre></dd>
      
        <dt id="IMAGE_DIRECTORY_ENTRY_EXPORT-constant" class="">IMAGE_DIRECTORY_ENTRY_EXPORT =
          
        </dt>
        <dd><pre class="code"><span class='int'>0</span></pre></dd>
      
        <dt id="IMAGE_DIRECTORY_ENTRY_IMPORT-constant" class="">IMAGE_DIRECTORY_ENTRY_IMPORT =
          
        </dt>
        <dd><pre class="code"><span class='int'>1</span></pre></dd>
      
        <dt id="IMAGE_DIRECTORY_ENTRY_RESOURCE-constant" class="">IMAGE_DIRECTORY_ENTRY_RESOURCE =
          
        </dt>
        <dd><pre class="code"><span class='int'>2</span></pre></dd>
      
        <dt id="IMAGE_DIRECTORY_ENTRY_EXCEPTION-constant" class="">IMAGE_DIRECTORY_ENTRY_EXCEPTION =
          
        </dt>
        <dd><pre class="code"><span class='int'>3</span></pre></dd>
      
        <dt id="IMAGE_DIRECTORY_ENTRY_SECURITY-constant" class="">IMAGE_DIRECTORY_ENTRY_SECURITY =
          
        </dt>
        <dd><pre class="code"><span class='int'>4</span></pre></dd>
      
        <dt id="IMAGE_DIRECTORY_ENTRY_BASERELOC-constant" class="">IMAGE_DIRECTORY_ENTRY_BASERELOC =
          
        </dt>
        <dd><pre class="code"><span class='int'>5</span></pre></dd>
      
        <dt id="IMAGE_DIRECTORY_ENTRY_DEBUG-constant" class="">IMAGE_DIRECTORY_ENTRY_DEBUG =
          
        </dt>
        <dd><pre class="code"><span class='int'>6</span></pre></dd>
      
        <dt id="IMAGE_DIRECTORY_ENTRY_COPYRIGHT-constant" class="">IMAGE_DIRECTORY_ENTRY_COPYRIGHT =
          
        </dt>
        <dd><pre class="code"><span class='int'>7</span></pre></dd>
      
        <dt id="IMAGE_DIRECTORY_ENTRY_ARCHITECTURE-constant" class="">IMAGE_DIRECTORY_ENTRY_ARCHITECTURE =
          
        </dt>
        <dd><pre class="code"><span class='int'>7</span></pre></dd>
      
        <dt id="IMAGE_DIRECTORY_ENTRY_GLOBALPTR-constant" class="">IMAGE_DIRECTORY_ENTRY_GLOBALPTR =
          
        </dt>
        <dd><pre class="code"><span class='int'>8</span></pre></dd>
      
        <dt id="IMAGE_DIRECTORY_ENTRY_TLS-constant" class="">IMAGE_DIRECTORY_ENTRY_TLS =
          
        </dt>
        <dd><pre class="code"><span class='int'>9</span></pre></dd>
      
        <dt id="IMAGE_DIRECTORY_ENTRY_LOAD_CONFIG-constant" class="">IMAGE_DIRECTORY_ENTRY_LOAD_CONFIG =
          
        </dt>
        <dd><pre class="code"><span class='int'>10</span></pre></dd>
      
        <dt id="IMAGE_DIRECTORY_ENTRY_BOUND_IMPORT-constant" class="">IMAGE_DIRECTORY_ENTRY_BOUND_IMPORT =
          
        </dt>
        <dd><pre class="code"><span class='int'>11</span></pre></dd>
      
        <dt id="IMAGE_DIRECTORY_ENTRY_IAT-constant" class="">IMAGE_DIRECTORY_ENTRY_IAT =
          
        </dt>
        <dd><pre class="code"><span class='int'>12</span></pre></dd>
      
        <dt id="IMAGE_DIRECTORY_ENTRY_DELAY_IMPORT-constant" class="">IMAGE_DIRECTORY_ENTRY_DELAY_IMPORT =
          
        </dt>
        <dd><pre class="code"><span class='int'>13</span></pre></dd>
      
        <dt id="IMAGE_DIRECTORY_ENTRY_COM_DESCRIPTOR-constant" class="">IMAGE_DIRECTORY_ENTRY_COM_DESCRIPTOR =
          
        </dt>
        <dd><pre class="code"><span class='int'>14</span></pre></dd>
      
        <dt id="IMAGE_DATA_DIRECTORY-constant" class="">IMAGE_DATA_DIRECTORY =
          <div class="docstring">
  <div class="discussion">
    
<p>Struct</p>

<pre class="code ruby"><code class="ruby">typedef struct _IMAGE_DATA_DIRECTORY {
    DWORD   VirtualAddress;
    DWORD   Size;
} IMAGE_DATA_DIRECTORY, *PIMAGE_DATA_DIRECTORY;</code></pre>


  </div>
</div>
<div class="tags">
  

</div>
        </dt>
        <dd><pre class="code"><span class='const'>Rex</span><span class='op'>::</span><span class='const'>Struct2</span><span class='op'>::</span><span class='const'>CStructTemplate</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint32v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>VirtualAddress</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>               <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint32v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Size</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>                         <span class='int'>0</span> <span class='rbracket'>]</span>
<span class='rparen'>)</span></pre></dd>
      
        <dt id="IMAGE_NT_OPTIONAL_HDR32_MAGIC-constant" class="">IMAGE_NT_OPTIONAL_HDR32_MAGIC =
          <div class="docstring">
  <div class="discussion">
    
<p>Struct</p>

<pre class="code ruby"><code class="ruby">typedef struct _IMAGE_OPTIONAL_HEADER {
    //
    // Standard fields.
    //

    WORD    Magic;
    BYTE    MajorLinkerVersion;
    BYTE    MinorLinkerVersion;
    DWORD   SizeOfCode;
    DWORD   SizeOfInitializedData;
    DWORD   SizeOfUninitializedData;
    DWORD   AddressOfEntryPoint;
    DWORD   BaseOfCode;
    DWORD   BaseOfData;

    //
    // NT additional fields.
    //

    DWORD   ImageBase;
    DWORD   SectionAlignment;
    DWORD   FileAlignment;
    WORD    MajorOperatingSystemVersion;
    WORD    MinorOperatingSystemVersion;
    WORD    MajorImageVersion;
    WORD    MinorImageVersion;
    WORD    MajorSubsystemVersion;
    WORD    MinorSubsystemVersion;
    DWORD   Win32VersionValue;
    DWORD   SizeOfImage;
    DWORD   SizeOfHeaders;
    DWORD   CheckSum;
    WORD    Subsystem;
    WORD    DllCharacteristics;
    DWORD   SizeOfStackReserve;
    DWORD   SizeOfStackCommit;
    DWORD   SizeOfHeapReserve;
    DWORD   SizeOfHeapCommit;
    DWORD   LoaderFlags;
    DWORD   NumberOfRvaAndSizes;
    IMAGE_DATA_DIRECTORY DataDirectory[IMAGE_NUMBEROF_DIRECTORY_ENTRIES];
} IMAGE_OPTIONAL_HEADER32, *PIMAGE_OPTIONAL_HEADER32;

#define IMAGE_NT_OPTIONAL_HDR32_MAGIC      0x10b
#define IMAGE_SIZEOF_NT_OPTIONAL32_HEADER    224</code></pre>


  </div>
</div>
<div class="tags">
  

</div>
        </dt>
        <dd><pre class="code"><span class='int'>0x10b</span></pre></dd>
      
        <dt id="IMAGE_SIZEOF_NT_OPTIONAL32_HEADER-constant" class="">IMAGE_SIZEOF_NT_OPTIONAL32_HEADER =
          
        </dt>
        <dd><pre class="code"><span class='int'>224</span></pre></dd>
      
        <dt id="IMAGE_OPTIONAL_HEADER32-constant" class="">IMAGE_OPTIONAL_HEADER32 =
          
        </dt>
        <dd><pre class="code"><span class='const'>Rex</span><span class='op'>::</span><span class='const'>Struct2</span><span class='op'>::</span><span class='const'>CStructTemplate</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint16v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Magic</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>                        <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint8</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>   <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>MajorLinkerVersion</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>           <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint8</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>   <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>MinorLinkerVersion</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>           <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint32v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>SizeOfCode</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>                   <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint32v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>SizeOfInitializeData</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>         <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint32v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>SizeOfUninitializeData</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>       <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint32v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>AddressOfEntryPoint</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>          <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint32v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>BaseOfCode</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>                   <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint32v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>BaseOfData</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>                   <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint32v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>ImageBase</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>                    <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint32v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>SectionAlignment</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>             <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint32v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>FileAlignment</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>                <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint16v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>MajorOperatingSystemVersion</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>  <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint16v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>MinorOperatingSystemVersion</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>  <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint16v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>MajorImageVersion</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>            <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint16v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>MinorImageVersion</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>            <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint16v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>MajorSubsystemVersion</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>        <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint16v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>MinorSubsystemVersion</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>        <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint32v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Win32VersionValue</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>            <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint32v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>SizeOfImage</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>                  <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint32v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>SizeOfHeaders</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>                <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint32v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>CheckSum</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>                     <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint16v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Subsystem</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>                    <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint16v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>DllCharacteristics</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>           <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint32v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>SizeOfStackReserve</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>           <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint32v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>SizeOfStackCommit</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>            <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint32v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>SizeOfHeapReserve</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>            <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint32v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>SizeOfHeapCommit</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>             <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint32v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>LoaderFlags</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>                  <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint32v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>NumberOfRvaAndSizes</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>          <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>template</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>DataDirectory</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='const'>Rex</span><span class='op'>::</span><span class='const'>Struct2</span><span class='op'>::</span><span class='const'>CStructTemplate</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span>
    <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>template</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>DataDirectoryEntry_0</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='const'>IMAGE_DATA_DIRECTORY</span> <span class='rbracket'>]</span><span class='comma'>,</span>
    <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>template</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>DataDirectoryEntry_1</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='const'>IMAGE_DATA_DIRECTORY</span> <span class='rbracket'>]</span><span class='comma'>,</span>
    <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>template</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>DataDirectoryEntry_2</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='const'>IMAGE_DATA_DIRECTORY</span> <span class='rbracket'>]</span><span class='comma'>,</span>
    <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>template</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>DataDirectoryEntry_3</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='const'>IMAGE_DATA_DIRECTORY</span> <span class='rbracket'>]</span><span class='comma'>,</span>
    <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>template</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>DataDirectoryEntry_4</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='const'>IMAGE_DATA_DIRECTORY</span> <span class='rbracket'>]</span><span class='comma'>,</span>
    <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>template</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>DataDirectoryEntry_5</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='const'>IMAGE_DATA_DIRECTORY</span> <span class='rbracket'>]</span><span class='comma'>,</span>
    <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>template</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>DataDirectoryEntry_6</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='const'>IMAGE_DATA_DIRECTORY</span> <span class='rbracket'>]</span><span class='comma'>,</span>
    <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>template</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>DataDirectoryEntry_7</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='const'>IMAGE_DATA_DIRECTORY</span> <span class='rbracket'>]</span><span class='comma'>,</span>
    <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>template</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>DataDirectoryEntry_8</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='const'>IMAGE_DATA_DIRECTORY</span> <span class='rbracket'>]</span><span class='comma'>,</span>
    <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>template</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>DataDirectoryEntry_9</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='const'>IMAGE_DATA_DIRECTORY</span> <span class='rbracket'>]</span><span class='comma'>,</span>
    <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>template</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>DataDirectoryEntry_10</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='const'>IMAGE_DATA_DIRECTORY</span> <span class='rbracket'>]</span><span class='comma'>,</span>
    <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>template</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>DataDirectoryEntry_11</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='const'>IMAGE_DATA_DIRECTORY</span> <span class='rbracket'>]</span><span class='comma'>,</span>
    <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>template</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>DataDirectoryEntry_12</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='const'>IMAGE_DATA_DIRECTORY</span> <span class='rbracket'>]</span><span class='comma'>,</span>
    <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>template</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>DataDirectoryEntry_13</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='const'>IMAGE_DATA_DIRECTORY</span> <span class='rbracket'>]</span><span class='comma'>,</span>
    <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>template</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>DataDirectoryEntry_14</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='const'>IMAGE_DATA_DIRECTORY</span> <span class='rbracket'>]</span><span class='comma'>,</span>
    <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>template</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>DataDirectoryEntry_15</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='const'>IMAGE_DATA_DIRECTORY</span> <span class='rbracket'>]</span>
  <span class='rparen'>)</span><span class='rbracket'>]</span>
<span class='rparen'>)</span></pre></dd>
      
        <dt id="IMAGE_NT_OPTIONAL_HDR64_MAGIC-constant" class="">IMAGE_NT_OPTIONAL_HDR64_MAGIC =
          <div class="docstring">
  <div class="discussion">
    
<p>#define IMAGE_SIZEOF_NT_OPTIONAL64_HEADER    240</p>


  </div>
</div>
<div class="tags">
  

</div>
        </dt>
        <dd><pre class="code"><span class='int'>0x20b</span></pre></dd>
      
        <dt id="IMAGE_SIZEOF_NT_OPTIONAL64_HEADER-constant" class="">IMAGE_SIZEOF_NT_OPTIONAL64_HEADER =
          <div class="docstring">
  <div class="discussion">
    
<p>#define IMAGE_NT_OPTIONAL_HDR64_MAGIC      0x20b</p>


  </div>
</div>
<div class="tags">
  

</div>
        </dt>
        <dd><pre class="code"><span class='int'>240</span></pre></dd>
      
        <dt id="IMAGE_OPTIONAL_HEADER64-constant" class="">IMAGE_OPTIONAL_HEADER64 =
          <div class="docstring">
  <div class="discussion">
    
<p>Struct</p>

<pre class="code ruby"><code class="ruby">typedef struct _IMAGE_OPTIONAL_HEADER64 {
   USHORT      Magic;
   UCHAR       MajorLinkerVersion;
   UCHAR       MinorLinkerVersion;
   ULONG       SizeOfCode;
   ULONG       SizeOfInitializedData;
   ULONG       SizeOfUninitializedData;
   ULONG       AddressOfEntryPoint;
   ULONG       BaseOfCode;
   ULONGLONG   ImageBase;
   ULONG       SectionAlignment;
   ULONG       FileAlignment;
   USHORT      MajorOperatingSystemVersion;
   USHORT      MinorOperatingSystemVersion;
   USHORT      MajorImageVersion;
   USHORT      MinorImageVersion;
   USHORT      MajorSubsystemVersion;
   USHORT      MinorSubsystemVersion;
   ULONG       Win32VersionValue;
   ULONG       SizeOfImage;
   ULONG       SizeOfHeaders;
   ULONG       CheckSum;
   USHORT      Subsystem;
   USHORT      DllCharacteristics;
   ULONGLONG   SizeOfStackReserve;
   ULONGLONG   SizeOfStackCommit;
   ULONGLONG   SizeOfHeapReserve;
   ULONGLONG   SizeOfHeapCommit;
   ULONG       LoaderFlags;
   ULONG       NumberOfRvaAndSizes;
   IMAGE_DATA_DIRECTORY DataDirectory[IMAGE_NUMBEROF_DIRECTORY_ENTRIES];
} IMAGE_OPTIONAL_HEADER64, *PIMAGE_OPTIONAL_HEADER64;</code></pre>


  </div>
</div>
<div class="tags">
  

</div>
        </dt>
        <dd><pre class="code"><span class='const'>Rex</span><span class='op'>::</span><span class='const'>Struct2</span><span class='op'>::</span><span class='const'>CStructTemplate</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint16v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Magic</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>                        <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint8</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>   <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>MajorLinkerVersion</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>           <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint8</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>   <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>MinorLinkerVersion</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>           <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint32v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>SizeOfCode</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>                   <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint32v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>SizeOfInitializeData</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>         <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint32v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>SizeOfUninitializeData</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>       <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint32v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>AddressOfEntryPoint</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>          <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint32v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>BaseOfCode</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>                   <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint64v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>ImageBase</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>                    <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint32v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>SectionAlignment</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>             <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint32v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>FileAlignment</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>                <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint16v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>MajorOperatingsystemVersion</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>  <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint16v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>MinorOperatingsystemVersion</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>  <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint16v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>MajorImageVersion</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>            <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint16v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>MinorImageVersion</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>            <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint16v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>MajorSubsystemVersion</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>        <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint16v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>MinorSubsystemVersion</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>        <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint32v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Win32VersionValue</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>            <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint32v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>SizeOfImage</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>                  <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint32v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>SizeOfHeaders</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>                <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint32v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>CheckSum</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>                     <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint16v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Subsystem</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>                    <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint16v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>DllCharacteristics</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>           <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint64v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>SizeOfStackReserve</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>           <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint64v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>SizeOfStackCommit</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>            <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint64v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>SizeOfHeapReserve</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>            <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint64v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>SizeOfHeapCommit</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>             <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint32v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>LoaderFlags</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>                  <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint32v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>NumberOfRvaAndSizes</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>          <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>template</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>DataDirectory</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='const'>Rex</span><span class='op'>::</span><span class='const'>Struct2</span><span class='op'>::</span><span class='const'>CStructTemplate</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span>
    <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>template</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>DataDirectoryEntry_0</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='const'>IMAGE_DATA_DIRECTORY</span> <span class='rbracket'>]</span><span class='comma'>,</span>
    <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>template</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>DataDirectoryEntry_1</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='const'>IMAGE_DATA_DIRECTORY</span> <span class='rbracket'>]</span><span class='comma'>,</span>
    <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>template</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>DataDirectoryEntry_2</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='const'>IMAGE_DATA_DIRECTORY</span> <span class='rbracket'>]</span><span class='comma'>,</span>
    <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>template</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>DataDirectoryEntry_3</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='const'>IMAGE_DATA_DIRECTORY</span> <span class='rbracket'>]</span><span class='comma'>,</span>
    <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>template</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>DataDirectoryEntry_4</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='const'>IMAGE_DATA_DIRECTORY</span> <span class='rbracket'>]</span><span class='comma'>,</span>
    <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>template</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>DataDirectoryEntry_5</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='const'>IMAGE_DATA_DIRECTORY</span> <span class='rbracket'>]</span><span class='comma'>,</span>
    <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>template</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>DataDirectoryEntry_6</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='const'>IMAGE_DATA_DIRECTORY</span> <span class='rbracket'>]</span><span class='comma'>,</span>
    <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>template</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>DataDirectoryEntry_7</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='const'>IMAGE_DATA_DIRECTORY</span> <span class='rbracket'>]</span><span class='comma'>,</span>
    <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>template</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>DataDirectoryEntry_8</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='const'>IMAGE_DATA_DIRECTORY</span> <span class='rbracket'>]</span><span class='comma'>,</span>
    <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>template</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>DataDirectoryEntry_9</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='const'>IMAGE_DATA_DIRECTORY</span> <span class='rbracket'>]</span><span class='comma'>,</span>
    <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>template</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>DataDirectoryEntry_10</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='const'>IMAGE_DATA_DIRECTORY</span> <span class='rbracket'>]</span><span class='comma'>,</span>
    <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>template</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>DataDirectoryEntry_11</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='const'>IMAGE_DATA_DIRECTORY</span> <span class='rbracket'>]</span><span class='comma'>,</span>
    <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>template</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>DataDirectoryEntry_12</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='const'>IMAGE_DATA_DIRECTORY</span> <span class='rbracket'>]</span><span class='comma'>,</span>
    <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>template</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>DataDirectoryEntry_13</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='const'>IMAGE_DATA_DIRECTORY</span> <span class='rbracket'>]</span><span class='comma'>,</span>
    <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>template</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>DataDirectoryEntry_14</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='const'>IMAGE_DATA_DIRECTORY</span> <span class='rbracket'>]</span><span class='comma'>,</span>
    <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>template</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>DataDirectoryEntry_15</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='const'>IMAGE_DATA_DIRECTORY</span> <span class='rbracket'>]</span>
  <span class='rparen'>)</span><span class='rbracket'>]</span>
<span class='rparen'>)</span></pre></dd>
      
        <dt id="IMAGE_SIZEOF_SECTION_HEADER-constant" class="">IMAGE_SIZEOF_SECTION_HEADER =
          <div class="docstring">
  <div class="discussion">
    
<p>#define IMAGE_SIZEOF_SECTION_HEADER          40</p>


  </div>
</div>
<div class="tags">
  

</div>
        </dt>
        <dd><pre class="code"><span class='int'>40</span></pre></dd>
      
        <dt id="IMAGE_SECTION_HEADER-constant" class="">IMAGE_SECTION_HEADER =
          <div class="docstring">
  <div class="discussion">
    
<p>Struct</p>

<pre class="code ruby"><code class="ruby">typedef struct _IMAGE_SECTION_HEADER {
    BYTE    Name[IMAGE_SIZEOF_SHORT_NAME];
    union {
            DWORD   PhysicalAddress;
            DWORD   VirtualSize;
    } Misc;
    DWORD   VirtualAddress;
    DWORD   SizeOfRawData;
    DWORD   PointerToRawData;
    DWORD   PointerToRelocations;
    DWORD   PointerToLinenumbers;
    WORD    NumberOfRelocations;
    WORD    NumberOfLinenumbers;
    DWORD   Characteristics;
} IMAGE_SECTION_HEADER, *PIMAGE_SECTION_HEADER;</code></pre>


  </div>
</div>
<div class="tags">
  

</div>
        </dt>
        <dd><pre class="code"><span class='const'>Rex</span><span class='op'>::</span><span class='const'>Struct2</span><span class='op'>::</span><span class='const'>CStructTemplate</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>string</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>  <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Name</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='int'>8</span><span class='comma'>,</span>               <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint32v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Misc</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>                   <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint32v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>VirtualAddress</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>         <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint32v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>SizeOfRawData</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>          <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint32v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>PointerToRawData</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>       <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint32v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>PointerToRelocations</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>   <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint32v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>NumberOfRelocations</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>    <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint32v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>NumberOfLineNumbers</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>    <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint32v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Characteristics</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>        <span class='int'>0</span> <span class='rbracket'>]</span>
<span class='rparen'>)</span></pre></dd>
      
        <dt id="IMAGE_SIZEOF_BASE_RELOCATION-constant" class="">IMAGE_SIZEOF_BASE_RELOCATION =
          <div class="docstring">
  <div class="discussion">
    
<p>#define IMAGE_SIZEOF_BASE_RELOCATION         8</p>


  </div>
</div>
<div class="tags">
  

</div>
        </dt>
        <dd><pre class="code"><span class='int'>8</span></pre></dd>
      
        <dt id="IMAGE_BASE_RELOCATION-constant" class="">IMAGE_BASE_RELOCATION =
          <div class="docstring">
  <div class="discussion">
    
<p>Struct</p>

<pre class="code ruby"><code class="ruby">typedef struct _IMAGE_BASE_RELOCATION {
    DWORD   VirtualAddress;
    DWORD   SizeOfBlock;
//  WORD    TypeOffset[1];
} IMAGE_BASE_RELOCATION;
typedef IMAGE_BASE_RELOCATION UNALIGNED * PIMAGE_BASE_RELOCATION;</code></pre>


  </div>
</div>
<div class="tags">
  

</div>
        </dt>
        <dd><pre class="code"><span class='const'>Rex</span><span class='op'>::</span><span class='const'>Struct2</span><span class='op'>::</span><span class='const'>CStructTemplate</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint32v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>VirtualAddress</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>         <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint32v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>SizeOfBlock</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>            <span class='int'>0</span> <span class='rbracket'>]</span>
<span class='rparen'>)</span></pre></dd>
      
        <dt id="IMAGE_BASE_RELOCATION_TYPE_OFFSET-constant" class="">IMAGE_BASE_RELOCATION_TYPE_OFFSET =
          
        </dt>
        <dd><pre class="code"><span class='const'>Rex</span><span class='op'>::</span><span class='const'>Struct2</span><span class='op'>::</span><span class='const'>CStructTemplate</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint16v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>TypeOffset</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>             <span class='int'>0</span> <span class='rbracket'>]</span>
<span class='rparen'>)</span></pre></dd>
      
        <dt id="IMAGE_LOAD_CONFIG_DIRECTORY32-constant" class="">IMAGE_LOAD_CONFIG_DIRECTORY32 =
          <div class="docstring">
  <div class="discussion">
    
<p>Struct</p>

<pre class="code ruby"><code class="ruby">typedef struct {
    DWORD   Size;
    DWORD   TimeDateStamp;
    WORD    MajorVersion;
    WORD    MinorVersion;
    DWORD   GlobalFlagsClear;
    DWORD   GlobalFlagsSet;
    DWORD   CriticalSectionDefaultTimeout;
    DWORD   DeCommitFreeBlockThreshold;
    DWORD   DeCommitTotalFreeThreshold;
    DWORD   LockPrefixTable;            // VA
    DWORD   MaximumAllocationSize;
    DWORD   VirtualMemoryThreshold;
    DWORD   ProcessHeapFlags;
    DWORD   ProcessAffinityMask;
    WORD    CSDVersion;
    WORD    Reserved1;
    DWORD   EditList;                   // VA
    DWORD   SecurityCookie;             // VA
    DWORD   SEHandlerTable;             // VA
    DWORD   SEHandlerCount;
} IMAGE_LOAD_CONFIG_DIRECTORY32, *PIMAGE_LOAD_CONFIG_DIRECTORY32;</code></pre>


  </div>
</div>
<div class="tags">
  

</div>
        </dt>
        <dd><pre class="code"><span class='const'>Rex</span><span class='op'>::</span><span class='const'>Struct2</span><span class='op'>::</span><span class='const'>CStructTemplate</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint32v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Size</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>                          <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint32v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>TimeDateStamp</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>                 <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint16v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>MajorVersion</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>                  <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint16v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>MinorVersion</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>                  <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint32v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>GlobalFlagsClear</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>              <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint32v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>GlobalFlagsSet</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>                <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint32v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>CriticalSectionDefaultTimeout</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint32v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>DeCommitFreeBlockThreshold</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>    <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint32v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>DeCommitTotalFreeThreshold</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>    <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint32v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>LockPrefixTable</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>               <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint32v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>MaximumAllocationSize</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>         <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint32v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>VirtualMemoryThreshold</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>        <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint32v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>ProcessHeapFlags</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>              <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint32v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>ProcessAffinityMask</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>           <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint16v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>CSDVersion</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>                    <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint16v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Reserved1</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>                     <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint32v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>EditList</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>                      <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint32v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>SecurityCookie</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>                <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint32v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>SEHandlerTable</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>                <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint32v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>SEHandlerCount</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>                <span class='int'>0</span> <span class='rbracket'>]</span>
<span class='rparen'>)</span></pre></dd>
      
        <dt id="IMAGE_LOAD_CONFIG_DIRECTORY64-constant" class="">IMAGE_LOAD_CONFIG_DIRECTORY64 =
          <div class="docstring">
  <div class="discussion">
    
<p>Struct</p>

<pre class="code ruby"><code class="ruby">typedef struct {
    ULONG      Size;
    ULONG      TimeDateStamp;
    USHORT     MajorVersion;
    USHORT     MinorVersion;
    ULONG      GlobalFlagsClear;
    ULONG      GlobalFlagsSet;
    ULONG      CriticalSectionDefaultTimeout;
    ULONGLONG  DeCommitFreeBlockThreshold;
    ULONGLONG  DeCommitTotalFreeThreshold;
    ULONGLONG  LockPrefixTable;         // VA
    ULONGLONG  MaximumAllocationSize;
    ULONGLONG  VirtualMemoryThreshold;
    ULONGLONG  ProcessAffinityMask;
    ULONG      ProcessHeapFlags;
    USHORT     CSDVersion;
    USHORT     Reserved1;
    ULONGLONG  EditList;                // VA
    ULONGLONG  SecurityCookie;          // VA
    ULONGLONG  SEHandlerTable;          // VA
    ULONGLONG  SEHandlerCount;
} IMAGE_LOAD_CONFIG_DIRECTORY64, *PIMAGE_LOAD_CONFIG_DIRECTORY64;</code></pre>


  </div>
</div>
<div class="tags">
  

</div>
        </dt>
        <dd><pre class="code"><span class='const'>Rex</span><span class='op'>::</span><span class='const'>Struct2</span><span class='op'>::</span><span class='const'>CStructTemplate</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint32v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Size</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>                          <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint32v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>TimeDateStamp</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>                 <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint16v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>MajorVersion</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>                  <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint16v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>MinorVersion</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>                  <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint32v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>GlobalFlagsClear</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>              <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint32v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>GlobalFlagsSet</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>                <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint32v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>CriticalSectionDefaultTimeout</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint64v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>DeCommitFreeBlockThreshold</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>    <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint64v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>DeCommitTotalFreeThreshold</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>    <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint64v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>LockPrefixTable</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>               <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint64v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>MaximumAllocationSize</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>         <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint64v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>VirtualMemoryThreshold</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>        <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint64v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>ProcessAffinityMask</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>           <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint32v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>ProcessHeapFlags</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>              <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint16v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>CSDVersion</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>                    <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint16v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Reserved1</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>                     <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint64v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>EditList</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>                      <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint64v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>SecurityCookie</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>                <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint64v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>SEHandlerTable</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>                <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint64v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>SEHandlerCount</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>                <span class='int'>0</span> <span class='rbracket'>]</span>
<span class='rparen'>)</span></pre></dd>
      
        <dt id="IMAGE_LOAD_TLS_DIRECTORY32-constant" class="">IMAGE_LOAD_TLS_DIRECTORY32 =
          <div class="docstring">
  <div class="discussion">
    
<p>Struct</p>

<pre class="code ruby"><code class="ruby">typedef struct {
    DWORD   Size;
    DWORD   TimeDateStamp;
    WORD    MajorVersion;
    WORD    MinorVersion;
    DWORD   GlobalFlagsClear;
    DWORD   GlobalFlagsSet;
    DWORD   CriticalSectionDefaultTimeout;
    DWORD   DeCommitFreeBlockThreshold;
    DWORD   DeCommitTotalFreeThreshold;
    DWORD   LockPrefixTable;            // VA
    DWORD   MaximumAllocationSize;
    DWORD   VirtualMemoryThreshold;
    DWORD   ProcessHeapFlags;
    DWORD   ProcessAffinityMask;
    WORD    CSDVersion;
    WORD    Reserved1;
    DWORD   EditList;                   // VA
    DWORD   SecurityCookie;             // VA
    DWORD   SEHandlerTable;             // VA
    DWORD   SEHandlerCount;
} IMAGE_LOAD_CONFIG_DIRECTORY32, *PIMAGE_LOAD_CONFIG_DIRECTORY32;</code></pre>


  </div>
</div>
<div class="tags">
  

</div>
        </dt>
        <dd><pre class="code"><span class='const'>Rex</span><span class='op'>::</span><span class='const'>Struct2</span><span class='op'>::</span><span class='const'>CStructTemplate</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint32v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Size</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>                          <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint32v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>TimeDateStamp</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>                 <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint16v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>MajorVersion</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>                  <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint16v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>MinorVersion</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>                  <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint32v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>GlobalFlagsClear</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>              <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint32v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>GlobalFlagsSet</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>                <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint32v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>CriticalSectionDefaultTimeout</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint32v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>DeCommitFreeBlockThreshold</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>    <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint32v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>DeCommitTotalFreeThreshold</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>    <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint32v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>LockPrefixTable</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>               <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint32v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>MaximumAllocationSize</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>         <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint32v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>VirtualMemoryThreshold</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>        <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint32v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>ProcessHeapFlags</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>              <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint32v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>ProcessAffinityMask</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>           <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint16v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>CSDVersion</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>                    <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint16v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Reserved1</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>                     <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint32v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>EditList</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>                      <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint32v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>SecurityCookie</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>                <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint32v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>SEHandlerTable</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>                <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint32v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>SEHandlerCount</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>                <span class='int'>0</span> <span class='rbracket'>]</span>
<span class='rparen'>)</span></pre></dd>
      
        <dt id="IMAGE_LOAD_TLS_DIRECTORY64-constant" class="">IMAGE_LOAD_TLS_DIRECTORY64 =
          <div class="docstring">
  <div class="discussion">
    
<p>Struct</p>

<pre class="code ruby"><code class="ruby">typedef struct {
    ULONG      Size;
    ULONG      TimeDateStamp;
    USHORT     MajorVersion;
    USHORT     MinorVersion;
    ULONG      GlobalFlagsClear;
    ULONG      GlobalFlagsSet;
    ULONG      CriticalSectionDefaultTimeout;
    ULONGLONG  DeCommitFreeBlockThreshold;
    ULONGLONG  DeCommitTotalFreeThreshold;
    ULONGLONG  LockPrefixTable;         // VA
    ULONGLONG  MaximumAllocationSize;
    ULONGLONG  VirtualMemoryThreshold;
    ULONGLONG  ProcessAffinityMask;
    ULONG      ProcessHeapFlags;
    USHORT     CSDVersion;
    USHORT     Reserved1;
    ULONGLONG  EditList;                // VA
    ULONGLONG  SecurityCookie;          // VA
    ULONGLONG  SEHandlerTable;          // VA
    ULONGLONG  SEHandlerCount;
} IMAGE_LOAD_CONFIG_DIRECTORY64, *PIMAGE_LOAD_CONFIG_DIRECTORY64;</code></pre>


  </div>
</div>
<div class="tags">
  

</div>
        </dt>
        <dd><pre class="code"><span class='const'>Rex</span><span class='op'>::</span><span class='const'>Struct2</span><span class='op'>::</span><span class='const'>CStructTemplate</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint32v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Size</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>                          <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint32v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>TimeDateStamp</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>                 <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint16v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>MajorVersion</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>                  <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint16v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>MinorVersion</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>                  <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint32v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>GlobalFlagsClear</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>              <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint32v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>GlobalFlagsSet</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>                <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint32v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>CriticalSectionDefaultTimeout</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint64v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>DeCommitFreeBlockThreshold</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>    <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint64v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>DeCommitTotalFreeThreshold</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>    <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint64v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>LockPrefixTable</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>               <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint64v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>MaximumAllocationSize</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>         <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint64v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>VirtualMemoryThreshold</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>        <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint64v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>ProcessAffinityMask</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>           <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint32v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>ProcessHeapFlags</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>              <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint16v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>CSDVersion</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>                    <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint16v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Reserved1</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>                     <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint64v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>EditList</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>                      <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint64v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>SecurityCookie</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>                <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint64v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>SEHandlerTable</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>                <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint64v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>SEHandlerCount</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>                <span class='int'>0</span> <span class='rbracket'>]</span>
<span class='rparen'>)</span></pre></dd>
      
        <dt id="IMAGE_RUNTIME_FUNCTION_ENTRY_SZ-constant" class="">IMAGE_RUNTIME_FUNCTION_ENTRY_SZ =
          <div class="docstring">
  <div class="discussion">
    
<p>Exception directory</p>


  </div>
</div>
<div class="tags">
  

</div>
        </dt>
        <dd><pre class="code"><span class='int'>12</span></pre></dd>
      
        <dt id="IMAGE_RUNTIME_FUNCTION_ENTRY-constant" class="">IMAGE_RUNTIME_FUNCTION_ENTRY =
          <div class="docstring">
  <div class="discussion">
    
<p>Struct</p>

<pre class="code ruby"><code class="ruby">typedef struct _IMAGE_RUNTIME_FUNCTION_ENTRY {
    DWORD BeginAddress;
    DWORD EndAddress;
    DWORD UnwindInfoAddress;
} _IMAGE_RUNTIME_FUNCTION_ENTRY, *_PIMAGE_RUNTIME_FUNCTION_ENTRY;</code></pre>


  </div>
</div>
<div class="tags">
  

</div>
        </dt>
        <dd><pre class="code"><span class='const'>Rex</span><span class='op'>::</span><span class='const'>Struct2</span><span class='op'>::</span><span class='const'>CStructTemplate</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint32v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>BeginAddress</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>                  <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint32v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>EndAddress</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>                    <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint32v</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>UnwindInfoAddress</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>             <span class='int'>0</span> <span class='rbracket'>]</span>
<span class='rparen'>)</span></pre></dd>
      
        <dt id="UNWIND_INFO_HEADER_SZ-constant" class="">UNWIND_INFO_HEADER_SZ =
          
        </dt>
        <dd><pre class="code"><span class='int'>4</span></pre></dd>
      
        <dt id="UNWIND_INFO_HEADER-constant" class="">UNWIND_INFO_HEADER =
          
        </dt>
        <dd><pre class="code"><span class='const'>Rex</span><span class='op'>::</span><span class='const'>Struct2</span><span class='op'>::</span><span class='const'>CStructTemplate</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint8</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>VersionFlags</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>                  <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint8</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>SizeOfProlog</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>                  <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint8</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>CountOfCodes</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>                  <span class='int'>0</span> <span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uint8</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>FrameRegisterAndOffset</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>        <span class='int'>0</span> <span class='rbracket'>]</span>
<span class='rparen'>)</span></pre></dd>
      
        <dt id="UWOP_PUSH_NONVOL-constant" class="">UWOP_PUSH_NONVOL =
          <div class="docstring">
  <div class="discussion">
    
<p>1 node</p>


  </div>
</div>
<div class="tags">
  

</div>
        </dt>
        <dd><pre class="code"><span class='int'>0</span></pre></dd>
      
        <dt id="UWOP_ALLOC_LARGE-constant" class="">UWOP_ALLOC_LARGE =
          <div class="docstring">
  <div class="discussion">
    
<p>2 or 3 nodes</p>


  </div>
</div>
<div class="tags">
  

</div>
        </dt>
        <dd><pre class="code"><span class='int'>1</span></pre></dd>
      
        <dt id="UWOP_ALLOC_SMALL-constant" class="">UWOP_ALLOC_SMALL =
          <div class="docstring">
  <div class="discussion">
    
<p>1 node</p>


  </div>
</div>
<div class="tags">
  

</div>
        </dt>
        <dd><pre class="code"><span class='int'>2</span></pre></dd>
      
        <dt id="UWOP_SET_FPREG-constant" class="">UWOP_SET_FPREG =
          <div class="docstring">
  <div class="discussion">
    
<p>1 node</p>


  </div>
</div>
<div class="tags">
  

</div>
        </dt>
        <dd><pre class="code"><span class='int'>3</span></pre></dd>
      
        <dt id="UWOP_SAVE_NONVOL-constant" class="">UWOP_SAVE_NONVOL =
          <div class="docstring">
  <div class="discussion">
    
<p>2 nodes</p>


  </div>
</div>
<div class="tags">
  

</div>
        </dt>
        <dd><pre class="code"><span class='int'>4</span></pre></dd>
      
        <dt id="UWOP_SAVE_NONVOL_FAR-constant" class="">UWOP_SAVE_NONVOL_FAR =
          <div class="docstring">
  <div class="discussion">
    
<p>3 nodes</p>


  </div>
</div>
<div class="tags">
  

</div>
        </dt>
        <dd><pre class="code"><span class='int'>5</span></pre></dd>
      
        <dt id="UWOP_SAVE_XMM128-constant" class="">UWOP_SAVE_XMM128 =
          <div class="docstring">
  <div class="discussion">
    
<p>2 nodes</p>


  </div>
</div>
<div class="tags">
  

</div>
        </dt>
        <dd><pre class="code"><span class='int'>8</span></pre></dd>
      
        <dt id="UWOP_SAVE_XMM128_FAR-constant" class="">UWOP_SAVE_XMM128_FAR =
          <div class="docstring">
  <div class="discussion">
    
<p>3 nodes</p>


  </div>
</div>
<div class="tags">
  

</div>
        </dt>
        <dd><pre class="code"><span class='int'>9</span></pre></dd>
      
        <dt id="UWOP_PUSH_MACHFRAME-constant" class="">UWOP_PUSH_MACHFRAME =
          <div class="docstring">
  <div class="discussion">
    
<p>1 node</p>


  </div>
</div>
<div class="tags">
  

</div>
        </dt>
        <dd><pre class="code"><span class='int'>10</span></pre></dd>
      
        <dt id="UNW_FLAG_EHANDLER-constant" class="">UNW_FLAG_EHANDLER =
          
        </dt>
        <dd><pre class="code"><span class='int'>1</span></pre></dd>
      
        <dt id="UNW_FLAG_UHANDLER-constant" class="">UNW_FLAG_UHANDLER =
          
        </dt>
        <dd><pre class="code"><span class='int'>2</span></pre></dd>
      
        <dt id="UNW_FLAG_CHAININFO-constant" class="">UNW_FLAG_CHAININFO =
          
        </dt>
        <dd><pre class="code"><span class='int'>4</span></pre></dd>
      
    </dl>
  




  <h2>Instance Attribute Summary <small>(<a href="#" class="summary_toggle">collapse</a>)</small></h2>
  <ul class="summary">
    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#_config_header-instance_method" title="#_config_header (instance method)">- (Object) <strong>_config_header</strong> </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute _config_header.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#_dos_header-instance_method" title="#_dos_header (instance method)">- (Object) <strong>_dos_header</strong> </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute _dos_header.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#_exception_header-instance_method" title="#_exception_header (instance method)">- (Object) <strong>_exception_header</strong> </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute _exception_header.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#_exports_cache-instance_method" title="#_exports_cache (instance method)">- (Object) <strong>_exports_cache</strong> </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute _exports_cache.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#_exports_cached-instance_method" title="#_exports_cached (instance method)">- (Object) <strong>_exports_cached</strong> </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute _exports_cached.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#_file_header-instance_method" title="#_file_header (instance method)">- (Object) <strong>_file_header</strong> </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute _file_header.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#_imports_cache-instance_method" title="#_imports_cache (instance method)">- (Object) <strong>_imports_cache</strong> </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute _imports_cache.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#_imports_cached-instance_method" title="#_imports_cached (instance method)">- (Object) <strong>_imports_cached</strong> </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute _imports_cached.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#_isource-instance_method" title="#_isource (instance method)">- (Object) <strong>_isource</strong> </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>instance stuff.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#_optional_header-instance_method" title="#_optional_header (instance method)">- (Object) <strong>_optional_header</strong> </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute _optional_header.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#_relocations_cache-instance_method" title="#_relocations_cache (instance method)">- (Object) <strong>_relocations_cache</strong> </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute _relocations_cache.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#_relocations_cached-instance_method" title="#_relocations_cached (instance method)">- (Object) <strong>_relocations_cached</strong> </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute _relocations_cached.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#_resources_cache-instance_method" title="#_resources_cache (instance method)">- (Object) <strong>_resources_cache</strong> </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute _resources_cache.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#_resources_cached-instance_method" title="#_resources_cached (instance method)">- (Object) <strong>_resources_cached</strong> </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute _resources_cached.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#_section_headers-instance_method" title="#_section_headers (instance method)">- (Object) <strong>_section_headers</strong> </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute _section_headers.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#_tls_header-instance_method" title="#_tls_header (instance method)">- (Object) <strong>_tls_header</strong> </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute _tls_header.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#hdr-instance_method" title="#hdr (instance method)">- (Object) <strong>hdr</strong> </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute hdr.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#header_section-instance_method" title="#header_section (instance method)">- (Object) <strong>header_section</strong> </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute header_section.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#image_base-instance_method" title="#image_base (instance method)">- (Object) <strong>image_base</strong> </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute image_base.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#sections-instance_method" title="#sections (instance method)">- (Object) <strong>sections</strong> </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute sections.</p>
</div></span>
  
</li>

    
  </ul>




  
    <h2>
      Class Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#_align_offset-class_method" title="_align_offset (class method)">+ (Object) <strong>_align_offset</strong>(offset, alignment) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Just a stupid routine to round an offset up to it&#39;s alignment.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#_parse_dos_header-class_method" title="_parse_dos_header (class method)">+ (Object) <strong>_parse_dos_header</strong>(rawdata) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#_parse_file_header-class_method" title="_parse_file_header (class method)">+ (Object) <strong>_parse_file_header</strong>(rawdata) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#_parse_optional_header-class_method" title="_parse_optional_header (class method)">+ (Object) <strong>_parse_optional_header</strong>(rawdata) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#_parse_section_headers-class_method" title="_parse_section_headers (class method)">+ (Object) <strong>_parse_section_headers</strong>(rawdata) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#new_from_file-class_method" title="new_from_file (class method)">+ (Object) <strong>new_from_file</strong>(filename, disk_backed = false) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#new_from_string-class_method" title="new_from_string (class method)">+ (Object) <strong>new_from_string</strong>(data) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
    </ul>
  
    <h2>
      Instance Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#_find_section_by_rva-instance_method" title="#_find_section_by_rva (instance method)">- (Object) <strong>_find_section_by_rva</strong>(rva) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Find a section by an RVA.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#_load_exception_directory-instance_method" title="#_load_exception_directory (instance method)">- (Object) <strong>_load_exception_directory</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#_load_exports-instance_method" title="#_load_exports (instance method)">- (Object) <strong>_load_exports</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#_load_imports-instance_method" title="#_load_imports (instance method)">- (Object) <strong>_load_imports</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#_load_relocations-instance_method" title="#_load_relocations (instance method)">- (Object) <strong>_load_relocations</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#_load_resources-instance_method" title="#_load_resources (instance method)">- (Object) <strong>_load_resources</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#_parse_config_header-instance_method" title="#_parse_config_header (instance method)">- (Object) <strong>_parse_config_header</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>– doesn&#39;t seem to be used – not compatible with 64-bit def
self._parse_config_header(rawdata) header =
IMAGE_LOAD_CONFIG_DIRECTORY32.make_struct header.from_s(rawdata)
ConfigHeader.new(header) end ++.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#_parse_resource_directory-instance_method" title="#_parse_resource_directory (instance method)">- (Object) <strong>_parse_resource_directory</strong>(data, rname = 0, rvalue = 0x80000000, path = &#39;0&#39;, pname = nil) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#_parse_resource_entry-instance_method" title="#_parse_resource_entry (instance method)">- (Object) <strong>_parse_resource_entry</strong>(data, rname, rvalue, path, pname) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#_parse_resource_name-instance_method" title="#_parse_resource_name (instance method)">- (Object) <strong>_parse_resource_name</strong>(data, rname) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#_parse_tls_header-instance_method" title="#_parse_tls_header (instance method)">- (Object) <strong>_parse_tls_header</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#_resource_lookup-instance_method" title="#_resource_lookup (instance method)">- (Object) <strong>_resource_lookup</strong>(i) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#close-instance_method" title="#close (instance method)">- (Object) <strong>close</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#config-instance_method" title="#config (instance method)">- (Object) <strong>config</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#exception-instance_method" title="#exception (instance method)">- (Object) <strong>exception</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#exports-instance_method" title="#exports (instance method)">- (Object) <strong>exports</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>We lazily parse the exports, and then cache it.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#file_offset_to_rva-instance_method" title="#file_offset_to_rva (instance method)">- (Object) <strong>file_offset_to_rva</strong>(foffset) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#file_offset_to_vma-instance_method" title="#file_offset_to_vma (instance method)">- (Object) <strong>file_offset_to_vma</strong>(foffset) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#find_section_by_rva-instance_method" title="#find_section_by_rva (instance method)">- (Object) <strong>find_section_by_rva</strong>(rva) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#find_section_by_vma-instance_method" title="#find_section_by_vma (instance method)">- (Object) <strong>find_section_by_vma</strong>(vma) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Find a section by a VMA.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#imports-instance_method" title="#imports (instance method)">- (Object) <strong>imports</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>We lazily parse the imports, and then cache it.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#read_asciiz_rva-instance_method" title="#read_asciiz_rva (instance method)">- (Object) <strong>read_asciiz_rva</strong>(rva) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#read_asciiz_vma-instance_method" title="#read_asciiz_vma (instance method)">- (Object) <strong>read_asciiz_vma</strong>(vma) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#read_rva-instance_method" title="#read_rva (instance method)">- (Object) <strong>read_rva</strong>(rva, length) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Some convenient methods to read a vma/rva without having the section…</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#read_vma-instance_method" title="#read_vma (instance method)">- (Object) <strong>read_vma</strong>(vma, length) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#relocations-instance_method" title="#relocations (instance method)">- (Object) <strong>relocations</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Base relocations in the hizzy.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#resources-instance_method" title="#resources (instance method)">- (Object) <strong>resources</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>We lazily parse the resources, and then cache them.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#rva_to_file_offset-instance_method" title="#rva_to_file_offset (instance method)">- (Object) <strong>rva_to_file_offset</strong>(rva) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#rva_to_vma-instance_method" title="#rva_to_vma (instance method)">- (Object) <strong>rva_to_vma</strong>(rva) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Random rva, vma, file offset, section offset, etc conversion routines…</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#tls-instance_method" title="#tls (instance method)">- (Object) <strong>tls</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#update_checksum-instance_method" title="#update_checksum (instance method)">- (Object) <strong>update_checksum</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#valid_rva%3F-instance_method" title="#valid_rva? (instance method)">- (Boolean) <strong>valid_rva?</strong>(rva) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#valid_vma%3F-instance_method" title="#valid_vma? (instance method)">- (Boolean) <strong>valid_vma?</strong>(vma) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#vma_to_file_offset-instance_method" title="#vma_to_file_offset (instance method)">- (Object) <strong>vma_to_file_offset</strong>(vma) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#vma_to_rva-instance_method" title="#vma_to_rva (instance method)">- (Object) <strong>vma_to_rva</strong>(vma) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
    </ul>
  


  <div id="instance_attr_details" class="attr_details">
    <h2>Instance Attribute Details</h2>
    
      
      <span id="_config_header=-instance_method"></span>
      <div class="method_details first">
  <h3 class="signature first" id="_config_header-instance_method">
  
    - (<tt>Object</tt>) <strong>_config_header</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute _config_header</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1145
1146
1147</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/peparsey/pebase.rb', line 1145</span>

<span class='kw'>def</span> <span class='id identifier rubyid__config_header'>_config_header</span>
  <span class='ivar'>@_config_header</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="_dos_header=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="_dos_header-instance_method">
  
    - (<tt>Object</tt>) <strong>_dos_header</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute _dos_header</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1145
1146
1147</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/peparsey/pebase.rb', line 1145</span>

<span class='kw'>def</span> <span class='id identifier rubyid__dos_header'>_dos_header</span>
  <span class='ivar'>@_dos_header</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="_exception_header=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="_exception_header-instance_method">
  
    - (<tt>Object</tt>) <strong>_exception_header</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute _exception_header</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1145
1146
1147</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/peparsey/pebase.rb', line 1145</span>

<span class='kw'>def</span> <span class='id identifier rubyid__exception_header'>_exception_header</span>
  <span class='ivar'>@_exception_header</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="_exports_cache=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="_exports_cache-instance_method">
  
    - (<tt>Object</tt>) <strong>_exports_cache</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute _exports_cache</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1151
1152
1153</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/peparsey/pebase.rb', line 1151</span>

<span class='kw'>def</span> <span class='id identifier rubyid__exports_cache'>_exports_cache</span>
  <span class='ivar'>@_exports_cache</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="_exports_cached=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="_exports_cached-instance_method">
  
    - (<tt>Object</tt>) <strong>_exports_cached</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute _exports_cached</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1151
1152
1153</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/peparsey/pebase.rb', line 1151</span>

<span class='kw'>def</span> <span class='id identifier rubyid__exports_cached'>_exports_cached</span>
  <span class='ivar'>@_exports_cached</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="_file_header=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="_file_header-instance_method">
  
    - (<tt>Object</tt>) <strong>_file_header</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute _file_header</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1145
1146
1147</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/peparsey/pebase.rb', line 1145</span>

<span class='kw'>def</span> <span class='id identifier rubyid__file_header'>_file_header</span>
  <span class='ivar'>@_file_header</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="_imports_cache=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="_imports_cache-instance_method">
  
    - (<tt>Object</tt>) <strong>_imports_cache</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute _imports_cache</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1150
1151
1152</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/peparsey/pebase.rb', line 1150</span>

<span class='kw'>def</span> <span class='id identifier rubyid__imports_cache'>_imports_cache</span>
  <span class='ivar'>@_imports_cache</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="_imports_cached=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="_imports_cached-instance_method">
  
    - (<tt>Object</tt>) <strong>_imports_cached</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute _imports_cached</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1150
1151
1152</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/peparsey/pebase.rb', line 1150</span>

<span class='kw'>def</span> <span class='id identifier rubyid__imports_cached'>_imports_cached</span>
  <span class='ivar'>@_imports_cached</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="_isource=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="_isource-instance_method">
  
    - (<tt>Object</tt>) <strong>_isource</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>instance stuff</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1144
1145
1146</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/peparsey/pebase.rb', line 1144</span>

<span class='kw'>def</span> <span class='id identifier rubyid__isource'>_isource</span>
  <span class='ivar'>@_isource</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="_optional_header=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="_optional_header-instance_method">
  
    - (<tt>Object</tt>) <strong>_optional_header</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute _optional_header</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1145
1146
1147</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/peparsey/pebase.rb', line 1145</span>

<span class='kw'>def</span> <span class='id identifier rubyid__optional_header'>_optional_header</span>
  <span class='ivar'>@_optional_header</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="_relocations_cache=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="_relocations_cache-instance_method">
  
    - (<tt>Object</tt>) <strong>_relocations_cache</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute _relocations_cache</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1152
1153
1154</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/peparsey/pebase.rb', line 1152</span>

<span class='kw'>def</span> <span class='id identifier rubyid__relocations_cache'>_relocations_cache</span>
  <span class='ivar'>@_relocations_cache</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="_relocations_cached=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="_relocations_cached-instance_method">
  
    - (<tt>Object</tt>) <strong>_relocations_cached</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute _relocations_cached</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1152
1153
1154</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/peparsey/pebase.rb', line 1152</span>

<span class='kw'>def</span> <span class='id identifier rubyid__relocations_cached'>_relocations_cached</span>
  <span class='ivar'>@_relocations_cached</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="_resources_cache=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="_resources_cache-instance_method">
  
    - (<tt>Object</tt>) <strong>_resources_cache</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute _resources_cache</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1153
1154
1155</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/peparsey/pebase.rb', line 1153</span>

<span class='kw'>def</span> <span class='id identifier rubyid__resources_cache'>_resources_cache</span>
  <span class='ivar'>@_resources_cache</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="_resources_cached=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="_resources_cached-instance_method">
  
    - (<tt>Object</tt>) <strong>_resources_cached</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute _resources_cached</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1153
1154
1155</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/peparsey/pebase.rb', line 1153</span>

<span class='kw'>def</span> <span class='id identifier rubyid__resources_cached'>_resources_cached</span>
  <span class='ivar'>@_resources_cached</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="_section_headers=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="_section_headers-instance_method">
  
    - (<tt>Object</tt>) <strong>_section_headers</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute _section_headers</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1145
1146
1147</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/peparsey/pebase.rb', line 1145</span>

<span class='kw'>def</span> <span class='id identifier rubyid__section_headers'>_section_headers</span>
  <span class='ivar'>@_section_headers</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="_tls_header=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="_tls_header-instance_method">
  
    - (<tt>Object</tt>) <strong>_tls_header</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute _tls_header</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1145
1146
1147</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/peparsey/pebase.rb', line 1145</span>

<span class='kw'>def</span> <span class='id identifier rubyid__tls_header'>_tls_header</span>
  <span class='ivar'>@_tls_header</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="hdr=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="hdr-instance_method">
  
    - (<tt>Object</tt>) <strong>hdr</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute hdr</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1155
1156
1157</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/peparsey/pebase.rb', line 1155</span>

<span class='kw'>def</span> <span class='id identifier rubyid_hdr'>hdr</span>
  <span class='ivar'>@hdr</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="header_section=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="header_section-instance_method">
  
    - (<tt>Object</tt>) <strong>header_section</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute header_section</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1148
1149
1150</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/peparsey/pebase.rb', line 1148</span>

<span class='kw'>def</span> <span class='id identifier rubyid_header_section'>header_section</span>
  <span class='ivar'>@header_section</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="image_base=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="image_base-instance_method">
  
    - (<tt>Object</tt>) <strong>image_base</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute image_base</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1148
1149
1150</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/peparsey/pebase.rb', line 1148</span>

<span class='kw'>def</span> <span class='id identifier rubyid_image_base'>image_base</span>
  <span class='ivar'>@image_base</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="sections=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="sections-instance_method">
  
    - (<tt>Object</tt>) <strong>sections</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute sections</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1148
1149
1150</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/peparsey/pebase.rb', line 1148</span>

<span class='kw'>def</span> <span class='id identifier rubyid_sections'>sections</span>
  <span class='ivar'>@sections</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>


  <div id="class_method_details" class="method_details_list">
    <h2>Class Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="_align_offset-class_method">
  
    + (<tt>Object</tt>) <strong>_align_offset</strong>(offset, alignment) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Just a stupid routine to round an offset up to it&#39;s alignment.</p>

<p>For example, you&#39;re going to want this for FileAlignment and
SectionAlignment, etc…</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1134
1135
1136
1137
1138</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/peparsey/pebase.rb', line 1134</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid__align_offset'>_align_offset</span><span class='lparen'>(</span><span class='id identifier rubyid_offset'>offset</span><span class='comma'>,</span> <span class='id identifier rubyid_alignment'>alignment</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_offset'>offset</span> <span class='op'>+=</span> <span class='id identifier rubyid_alignment'>alignment</span> <span class='op'>-</span> <span class='int'>1</span>
  <span class='id identifier rubyid_offset'>offset</span> <span class='op'>-=</span> <span class='id identifier rubyid_offset'>offset</span> <span class='op'>%</span> <span class='id identifier rubyid_alignment'>alignment</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_offset'>offset</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="_parse_dos_header-class_method">
  
    + (<tt>Object</tt>) <strong>_parse_dos_header</strong>(rawdata) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


135
136
137</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/peparsey/pebase.rb', line 135</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid__parse_dos_header'>_parse_dos_header</span><span class='lparen'>(</span><span class='id identifier rubyid_rawdata'>rawdata</span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='const'>DosHeader</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_rawdata'>rawdata</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="_parse_file_header-class_method">
  
    + (<tt>Object</tt>) <strong>_parse_file_header</strong>(rawdata) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


213
214
215</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/peparsey/pebase.rb', line 213</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid__parse_file_header'>_parse_file_header</span><span class='lparen'>(</span><span class='id identifier rubyid_rawdata'>rawdata</span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='const'>FileHeader</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_rawdata'>rawdata</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="_parse_optional_header-class_method">
  
    + (<tt>Object</tt>) <strong>_parse_optional_header</strong>(rawdata) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


571
572
573
574
575
576
577
578
579
580
581
582
583
584
585
586
587
588
589</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/peparsey/pebase.rb', line 571</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid__parse_optional_header'>_parse_optional_header</span><span class='lparen'>(</span><span class='id identifier rubyid_rawdata'>rawdata</span><span class='rparen'>)</span>
  <span class='kw'>case</span> <span class='id identifier rubyid_rawdata'>rawdata</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span>
    <span class='comment'># no optional header
</span>    <span class='kw'>when</span> <span class='int'>0</span>
      <span class='kw'>return</span> <span class='kw'>nil</span>

    <span class='comment'># good, good
</span>    <span class='kw'>when</span> <span class='const'>IMAGE_SIZEOF_NT_OPTIONAL32_HEADER</span>
      <span class='kw'>return</span> <span class='const'>OptionalHeader32</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_rawdata'>rawdata</span><span class='rparen'>)</span>

    <span class='kw'>when</span> <span class='const'>IMAGE_SIZEOF_NT_OPTIONAL64_HEADER</span>
      <span class='kw'>return</span> <span class='const'>OptionalHeader64</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_rawdata'>rawdata</span><span class='rparen'>)</span>

    <span class='comment'># bad, bad
</span>    <span class='kw'>else</span>
      <span class='id identifier rubyid_raise'>raise</span> <span class='const'>OptionalHeaderError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>I don&#39;t know this header size, </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_rawdata'>rawdata</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_caller'>caller</span>
  <span class='kw'>end</span>

<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="_parse_section_headers-class_method">
  
    + (<tt>Object</tt>) <strong>_parse_section_headers</strong>(rawdata) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


643
644
645
646
647
648
649
650
651
652
653
654</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/peparsey/pebase.rb', line 643</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid__parse_section_headers'>_parse_section_headers</span><span class='lparen'>(</span><span class='id identifier rubyid_rawdata'>rawdata</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_section_headers'>section_headers</span> <span class='op'>=</span> <span class='lbracket'>[</span> <span class='rbracket'>]</span>
  <span class='id identifier rubyid_size'>size</span> <span class='op'>=</span> <span class='const'>IMAGE_SIZEOF_SECTION_HEADER</span>
  <span class='id identifier rubyid_numsections'>numsections</span> <span class='op'>=</span> <span class='id identifier rubyid_rawdata'>rawdata</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span> <span class='op'>/</span> <span class='id identifier rubyid_size'>size</span>

  <span class='id identifier rubyid_numsections'>numsections</span><span class='period'>.</span><span class='id identifier rubyid_times'>times</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_i'>i</span><span class='op'>|</span>
    <span class='id identifier rubyid_data'>data</span> <span class='op'>=</span> <span class='id identifier rubyid_rawdata'>rawdata</span><span class='lbracket'>[</span><span class='id identifier rubyid_i'>i</span> <span class='op'>*</span> <span class='id identifier rubyid_size'>size</span><span class='comma'>,</span> <span class='id identifier rubyid_size'>size</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_section_headers'>section_headers</span> <span class='op'>&lt;&lt;</span> <span class='const'>SectionHeader</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_data'>data</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='kw'>return</span> <span class='id identifier rubyid_section_headers'>section_headers</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="new_from_file-class_method">
  
    + (<tt>Object</tt>) <strong>new_from_file</strong>(filename, disk_backed = false) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1157
1158
1159
1160
1161
1162
1163
1164
1165
1166
1167
1168
1169</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/peparsey/pebase.rb', line 1157</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_new_from_file'>new_from_file</span><span class='lparen'>(</span><span class='id identifier rubyid_filename'>filename</span><span class='comma'>,</span> <span class='id identifier rubyid_disk_backed'>disk_backed</span> <span class='op'>=</span> <span class='kw'>false</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_file'>file</span> <span class='op'>=</span> <span class='op'>::</span><span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_filename'>filename</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_file'>file</span><span class='period'>.</span><span class='id identifier rubyid_binmode'>binmode</span> <span class='comment'># windows... :\
</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_disk_backed'>disk_backed</span>
    <span class='kw'>return</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='const'>ImageSource</span><span class='op'>::</span><span class='const'>Disk</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_file'>file</span><span class='rparen'>)</span><span class='rparen'>)</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_obj'>obj</span> <span class='op'>=</span> <span class='id identifier rubyid_new_from_string'>new_from_string</span><span class='lparen'>(</span><span class='id identifier rubyid_file'>file</span><span class='period'>.</span><span class='id identifier rubyid_read'>read</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_file'>file</span><span class='period'>.</span><span class='id identifier rubyid_close'>close</span>
    <span class='kw'>return</span> <span class='id identifier rubyid_obj'>obj</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="new_from_string-class_method">
  
    + (<tt>Object</tt>) <strong>new_from_string</strong>(data) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1171
1172
1173</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/peparsey/pebase.rb', line 1171</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_new_from_string'>new_from_string</span><span class='lparen'>(</span><span class='id identifier rubyid_data'>data</span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='const'>ImageSource</span><span class='op'>::</span><span class='const'>Memory</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_data'>data</span><span class='rparen'>)</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="_find_section_by_rva-instance_method">
  
    - (<tt>Object</tt>) <strong>_find_section_by_rva</strong>(rva) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Find a section by an RVA</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1235
1236
1237
1238
1239
1240
1241
1242
1243</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/peparsey/pebase.rb', line 1235</span>

<span class='kw'>def</span> <span class='id identifier rubyid__find_section_by_rva'>_find_section_by_rva</span><span class='lparen'>(</span><span class='id identifier rubyid_rva'>rva</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_all_sections'>all_sections</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_section'>section</span><span class='op'>|</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_section'>section</span><span class='period'>.</span><span class='id identifier rubyid_contains_rva?'>contains_rva?</span><span class='lparen'>(</span><span class='id identifier rubyid_rva'>rva</span><span class='rparen'>)</span>
      <span class='kw'>return</span> <span class='id identifier rubyid_section'>section</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='kw'>return</span> <span class='kw'>nil</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="_load_exception_directory-instance_method">
  
    - (<tt>Object</tt>) <strong>_load_exception_directory</strong> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1097
1098
1099
1100
1101
1102
1103
1104
1105
1106
1107
1108
1109
1110
1111
1112
1113
1114
1115
1116
1117
1118
1119
1120</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/peparsey/pebase.rb', line 1097</span>

<span class='kw'>def</span> <span class='id identifier rubyid__load_exception_directory'>_load_exception_directory</span>
  <span class='ivar'>@exception</span>   <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>

  <span class='id identifier rubyid_exception_entry'>exception_entry</span> <span class='op'>=</span> <span class='id identifier rubyid__optional_header'>_optional_header</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>DataDirectory</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='const'>IMAGE_DIRECTORY_ENTRY_EXCEPTION</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_rva'>rva</span>             <span class='op'>=</span> <span class='id identifier rubyid_exception_entry'>exception_entry</span><span class='period'>.</span><span class='id identifier rubyid_v'>v</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>VirtualAddress</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_size'>size</span>            <span class='op'>=</span> <span class='id identifier rubyid_exception_entry'>exception_entry</span><span class='period'>.</span><span class='id identifier rubyid_v'>v</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Size</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>

  <span class='kw'>return</span> <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_rva'>rva</span> <span class='op'>==</span> <span class='int'>0</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_data'>data</span> <span class='op'>=</span> <span class='id identifier rubyid__isource'>_isource</span><span class='period'>.</span><span class='id identifier rubyid_read'>read</span><span class='lparen'>(</span><span class='id identifier rubyid_rva_to_file_offset'>rva_to_file_offset</span><span class='lparen'>(</span><span class='id identifier rubyid_rva'>rva</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='id identifier rubyid_size'>size</span><span class='rparen'>)</span>

  <span class='kw'>case</span> <span class='id identifier rubyid_hdr'>hdr</span><span class='period'>.</span><span class='id identifier rubyid_file'>file</span><span class='period'>.</span><span class='const'>Machine</span>
    <span class='kw'>when</span> <span class='const'>IMAGE_FILE_MACHINE_AMD64</span>
      <span class='id identifier rubyid_count'>count</span> <span class='op'>=</span> <span class='id identifier rubyid_data'>data</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span> <span class='op'>/</span> <span class='const'>IMAGE_RUNTIME_FUNCTION_ENTRY_SZ</span>

      <span class='id identifier rubyid_count'>count</span><span class='period'>.</span><span class='id identifier rubyid_times'>times</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_current'>current</span><span class='op'>|</span>
        <span class='ivar'>@exception</span> <span class='op'>&lt;&lt;</span> <span class='const'>RuntimeFunctionEntry</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='kw'>self</span><span class='comma'>,</span>
          <span class='id identifier rubyid_data'>data</span><span class='period'>.</span><span class='id identifier rubyid_slice!'>slice!</span><span class='lparen'>(</span><span class='int'>0</span><span class='comma'>,</span> <span class='const'>IMAGE_RUNTIME_FUNCTION_ENTRY_SZ</span><span class='rparen'>)</span><span class='rparen'>)</span>
      <span class='rbrace'>}</span>
    <span class='kw'>else</span>
  <span class='kw'>end</span>

  <span class='kw'>return</span> <span class='ivar'>@exception</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="_load_exports-instance_method">
  
    - (<tt>Object</tt>) <strong>_load_exports</strong> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1379
1380
1381
1382
1383
1384
1385
1386
1387
1388
1389
1390
1391
1392
1393
1394
1395
1396
1397
1398
1399
1400
1401
1402
1403
1404
1405
1406
1407
1408
1409
1410
1411
1412
1413
1414
1415
1416
1417
1418
1419
1420
1421
1422
1423
1424
1425
1426
1427
1428
1429
1430
1431
1432
1433
1434
1435
1436
1437
1438
1439
1440
1441
1442</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/peparsey/pebase.rb', line 1379</span>

<span class='kw'>def</span> <span class='id identifier rubyid__load_exports'>_load_exports</span>

  <span class='comment'>#
</span>  <span class='comment'># Get the data directory entry, size, etc
</span>  <span class='comment'>#
</span>  <span class='id identifier rubyid_exports_entry'>exports_entry</span> <span class='op'>=</span> <span class='id identifier rubyid__optional_header'>_optional_header</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>DataDirectory</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_rva'>rva</span>           <span class='op'>=</span> <span class='id identifier rubyid_exports_entry'>exports_entry</span><span class='period'>.</span><span class='id identifier rubyid_v'>v</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>VirtualAddress</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_size'>size</span>          <span class='op'>=</span> <span class='id identifier rubyid_exports_entry'>exports_entry</span><span class='period'>.</span><span class='id identifier rubyid_v'>v</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Size</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>

  <span class='kw'>return</span> <span class='kw'>nil</span> <span class='kw'>if</span> <span class='id identifier rubyid_size'>size</span> <span class='op'>==</span> <span class='int'>0</span>

  <span class='comment'>#
</span>  <span class='comment'># Ok, so we have the data directory, now lets parse it
</span>  <span class='comment'>#
</span>
  <span class='id identifier rubyid_directory'>directory</span> <span class='op'>=</span> <span class='const'>IMAGE_EXPORT_DESCRIPTOR</span><span class='period'>.</span><span class='id identifier rubyid_make_struct'>make_struct</span>
  <span class='id identifier rubyid_directory'>directory</span><span class='period'>.</span><span class='id identifier rubyid_from_s'>from_s</span><span class='lparen'>(</span><span class='id identifier rubyid__isource'>_isource</span><span class='period'>.</span><span class='id identifier rubyid_read'>read</span><span class='lparen'>(</span><span class='id identifier rubyid_rva_to_file_offset'>rva_to_file_offset</span><span class='lparen'>(</span><span class='id identifier rubyid_rva'>rva</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='const'>IMAGE_EXPORT_DESCRIPTOR_SIZE</span><span class='rparen'>)</span><span class='rparen'>)</span>

  <span class='comment'>#
</span>  <span class='comment'># We can have nameless exports, so we need to do the whole
</span>  <span class='comment'># NumberOfFunctions NumberOfNames foo
</span>  <span class='comment'>#
</span>  <span class='id identifier rubyid_num_functions'>num_functions</span> <span class='op'>=</span> <span class='id identifier rubyid_directory'>directory</span><span class='period'>.</span><span class='id identifier rubyid_v'>v</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>NumberOfFunctions</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_num_names'>num_names</span>     <span class='op'>=</span> <span class='id identifier rubyid_directory'>directory</span><span class='period'>.</span><span class='id identifier rubyid_v'>v</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>NumberOfNames</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>

  <span class='id identifier rubyid_dllname_rva'>dllname_rva</span>   <span class='op'>=</span> <span class='id identifier rubyid_directory'>directory</span><span class='period'>.</span><span class='id identifier rubyid_v'>v</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Name</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_dllname'>dllname</span>       <span class='op'>=</span> <span class='id identifier rubyid__isource'>_isource</span><span class='period'>.</span><span class='id identifier rubyid_read_asciiz'>read_asciiz</span><span class='lparen'>(</span><span class='id identifier rubyid_rva_to_file_offset'>rva_to_file_offset</span><span class='lparen'>(</span><span class='id identifier rubyid_dllname_rva'>dllname_rva</span><span class='rparen'>)</span><span class='rparen'>)</span>

  <span class='comment'># FIXME Base, etc
</span>  <span class='id identifier rubyid_fun_off'>fun_off</span>       <span class='op'>=</span> <span class='id identifier rubyid_rva_to_file_offset'>rva_to_file_offset</span><span class='lparen'>(</span><span class='id identifier rubyid_directory'>directory</span><span class='period'>.</span><span class='id identifier rubyid_v'>v</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>AddressOfFunctions</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_name_off'>name_off</span>      <span class='op'>=</span> <span class='id identifier rubyid_rva_to_file_offset'>rva_to_file_offset</span><span class='lparen'>(</span><span class='id identifier rubyid_directory'>directory</span><span class='period'>.</span><span class='id identifier rubyid_v'>v</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>AddressOfNames</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_ord_off'>ord_off</span>       <span class='op'>=</span> <span class='id identifier rubyid_rva_to_file_offset'>rva_to_file_offset</span><span class='lparen'>(</span><span class='id identifier rubyid_directory'>directory</span><span class='period'>.</span><span class='id identifier rubyid_v'>v</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>AddressOfNameOrdinals</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_base'>base</span>          <span class='op'>=</span> <span class='id identifier rubyid_directory'>directory</span><span class='period'>.</span><span class='id identifier rubyid_v'>v</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Base</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>

  <span class='comment'># Allocate the list of names
</span>  <span class='id identifier rubyid_names'>names</span> <span class='op'>=</span> <span class='const'>Array</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_num_functions'>num_functions</span><span class='rparen'>)</span>

  <span class='comment'>#
</span>  <span class='comment'># Iterate the names and name/ordinal list, getting the names
</span>  <span class='comment'># and storing them in the name list...
</span>  <span class='comment'>#
</span>  <span class='id identifier rubyid_num_names'>num_names</span><span class='period'>.</span><span class='id identifier rubyid_times'>times</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_i'>i</span><span class='op'>|</span>
    <span class='id identifier rubyid_name_rva'>name_rva</span> <span class='op'>=</span> <span class='id identifier rubyid__isource'>_isource</span><span class='period'>.</span><span class='id identifier rubyid_read'>read</span><span class='lparen'>(</span><span class='id identifier rubyid_name_off'>name_off</span> <span class='op'>+</span> <span class='lparen'>(</span><span class='id identifier rubyid_i'>i</span> <span class='op'>*</span> <span class='int'>4</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='int'>4</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_unpack'>unpack</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>V</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_ordinal'>ordinal</span>  <span class='op'>=</span> <span class='id identifier rubyid__isource'>_isource</span><span class='period'>.</span><span class='id identifier rubyid_read'>read</span><span class='lparen'>(</span><span class='id identifier rubyid_ord_off'>ord_off</span> <span class='op'>+</span> <span class='lparen'>(</span><span class='id identifier rubyid_i'>i</span> <span class='op'>*</span> <span class='int'>2</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='int'>2</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_unpack'>unpack</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>v</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_name'>name</span>     <span class='op'>=</span> <span class='id identifier rubyid__isource'>_isource</span><span class='period'>.</span><span class='id identifier rubyid_read_asciiz'>read_asciiz</span><span class='lparen'>(</span><span class='id identifier rubyid_rva_to_file_offset'>rva_to_file_offset</span><span class='lparen'>(</span><span class='id identifier rubyid_name_rva'>name_rva</span><span class='rparen'>)</span><span class='rparen'>)</span>

    <span class='comment'># store the exported name in the name list
</span>    <span class='id identifier rubyid_names'>names</span><span class='lbracket'>[</span><span class='id identifier rubyid_ordinal'>ordinal</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_name'>name</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_exports'>exports</span> <span class='op'>=</span> <span class='const'>ExportDirectory</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_dllname'>dllname</span><span class='comma'>,</span> <span class='lbracket'>[</span> <span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_base'>base</span><span class='rparen'>)</span>

  <span class='comment'>#
</span>  <span class='comment'># Now just iterate the functions (rvas) list..
</span>  <span class='comment'>#
</span>  <span class='id identifier rubyid_num_functions'>num_functions</span><span class='period'>.</span><span class='id identifier rubyid_times'>times</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_i'>i</span><span class='op'>|</span>
    <span class='id identifier rubyid_rva'>rva</span>      <span class='op'>=</span> <span class='id identifier rubyid__isource'>_isource</span><span class='period'>.</span><span class='id identifier rubyid_read'>read</span><span class='lparen'>(</span><span class='id identifier rubyid_fun_off'>fun_off</span> <span class='op'>+</span> <span class='lparen'>(</span><span class='id identifier rubyid_i'>i</span> <span class='op'>*</span> <span class='int'>4</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='int'>4</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_unpack'>unpack</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>V</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span>

    <span class='comment'># ExportEntry.new(name, ordinal, rva)
</span>    <span class='id identifier rubyid_exports'>exports</span><span class='period'>.</span><span class='id identifier rubyid_entries'>entries</span> <span class='op'>&lt;&lt;</span> <span class='const'>ExportEntry</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_names'>names</span><span class='lbracket'>[</span><span class='id identifier rubyid_i'>i</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_i'>i</span> <span class='op'>+</span> <span class='id identifier rubyid_base'>base</span><span class='comma'>,</span> <span class='id identifier rubyid_rva'>rva</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='kw'>return</span> <span class='id identifier rubyid_exports'>exports</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="_load_imports-instance_method">
  
    - (<tt>Object</tt>) <strong>_load_imports</strong> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1308
1309
1310
1311
1312
1313
1314
1315
1316
1317
1318
1319
1320
1321
1322
1323
1324
1325
1326
1327
1328
1329
1330
1331
1332
1333
1334
1335
1336
1337
1338
1339
1340
1341
1342
1343
1344
1345
1346
1347
1348
1349
1350
1351
1352
1353
1354
1355
1356
1357
1358
1359
1360
1361
1362
1363
1364</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/peparsey/pebase.rb', line 1308</span>

<span class='kw'>def</span> <span class='id identifier rubyid__load_imports'>_load_imports</span>
  <span class='comment'>#
</span>  <span class='comment'># Get the data directory entry, size, etc
</span>  <span class='comment'>#
</span>  <span class='id identifier rubyid_imports_entry'>imports_entry</span> <span class='op'>=</span> <span class='id identifier rubyid__optional_header'>_optional_header</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>DataDirectory</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='int'>1</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_rva'>rva</span>           <span class='op'>=</span> <span class='id identifier rubyid_imports_entry'>imports_entry</span><span class='period'>.</span><span class='id identifier rubyid_v'>v</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>VirtualAddress</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_size'>size</span>          <span class='op'>=</span> <span class='id identifier rubyid_imports_entry'>imports_entry</span><span class='period'>.</span><span class='id identifier rubyid_v'>v</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Size</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>

  <span class='kw'>return</span> <span class='kw'>nil</span> <span class='kw'>if</span> <span class='id identifier rubyid_size'>size</span> <span class='op'>==</span> <span class='int'>0</span>

  <span class='comment'>#
</span>  <span class='comment'># Ok, so we have the data directory, now lets parse it
</span>  <span class='comment'>#
</span>
  <span class='id identifier rubyid_imports'>imports</span> <span class='op'>=</span> <span class='lbracket'>[</span> <span class='rbracket'>]</span>

  <span class='id identifier rubyid_descriptors_data'>descriptors_data</span> <span class='op'>=</span> <span class='id identifier rubyid__isource'>_isource</span><span class='period'>.</span><span class='id identifier rubyid_read'>read</span><span class='lparen'>(</span><span class='id identifier rubyid_rva_to_file_offset'>rva_to_file_offset</span><span class='lparen'>(</span><span class='id identifier rubyid_rva'>rva</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='id identifier rubyid_size'>size</span><span class='rparen'>)</span>

  <span class='kw'>while</span> <span class='id identifier rubyid_descriptors_data'>descriptors_data</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span> <span class='op'>&gt;=</span> <span class='const'>IMAGE_IMPORT_DESCRIPTOR_SIZE</span>
    <span class='id identifier rubyid_descriptor'>descriptor</span> <span class='op'>=</span> <span class='const'>IMAGE_IMPORT_DESCRIPTOR</span><span class='period'>.</span><span class='id identifier rubyid_make_struct'>make_struct</span>
    <span class='id identifier rubyid_descriptor'>descriptor</span><span class='period'>.</span><span class='id identifier rubyid_from_s'>from_s</span><span class='lparen'>(</span><span class='id identifier rubyid_descriptors_data'>descriptors_data</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_descriptors_data'>descriptors_data</span> <span class='op'>=</span> <span class='id identifier rubyid_descriptor'>descriptor</span><span class='period'>.</span><span class='id identifier rubyid_leftover'>leftover</span>

    <span class='id identifier rubyid_othunk'>othunk</span> <span class='op'>=</span> <span class='id identifier rubyid_descriptor'>descriptor</span><span class='period'>.</span><span class='id identifier rubyid_v'>v</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>OriginalFirstThunk</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_fthunk'>fthunk</span> <span class='op'>=</span> <span class='id identifier rubyid_descriptor'>descriptor</span><span class='period'>.</span><span class='id identifier rubyid_v'>v</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>FirstThunk</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>

    <span class='kw'>break</span> <span class='kw'>if</span> <span class='id identifier rubyid_fthunk'>fthunk</span> <span class='op'>==</span> <span class='int'>0</span>

    <span class='id identifier rubyid_dllname'>dllname</span> <span class='op'>=</span> <span class='id identifier rubyid__isource'>_isource</span><span class='period'>.</span><span class='id identifier rubyid_read_asciiz'>read_asciiz</span><span class='lparen'>(</span><span class='id identifier rubyid_rva_to_file_offset'>rva_to_file_offset</span><span class='lparen'>(</span><span class='id identifier rubyid_descriptor'>descriptor</span><span class='period'>.</span><span class='id identifier rubyid_v'>v</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Name</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='rparen'>)</span><span class='rparen'>)</span>

    <span class='id identifier rubyid_import'>import</span> <span class='op'>=</span> <span class='const'>ImportDescriptor</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_dllname'>dllname</span><span class='comma'>,</span> <span class='lbracket'>[</span> <span class='rbracket'>]</span><span class='rparen'>)</span>

    <span class='comment'># we prefer the Characteristics/OriginalFirstThunk...
</span>    <span class='id identifier rubyid_thunk_off'>thunk_off</span> <span class='op'>=</span> <span class='id identifier rubyid_rva_to_file_offset'>rva_to_file_offset</span><span class='lparen'>(</span><span class='id identifier rubyid_othunk'>othunk</span> <span class='op'>==</span> <span class='int'>0</span> <span class='op'>?</span> <span class='id identifier rubyid_fthunk'>fthunk</span> <span class='op'>:</span> <span class='id identifier rubyid_othunk'>othunk</span><span class='rparen'>)</span>

    <span class='kw'>while</span> <span class='lparen'>(</span><span class='id identifier rubyid_orgrva'>orgrva</span> <span class='op'>=</span> <span class='id identifier rubyid__isource'>_isource</span><span class='period'>.</span><span class='id identifier rubyid_read'>read</span><span class='lparen'>(</span><span class='id identifier rubyid_thunk_off'>thunk_off</span><span class='comma'>,</span> <span class='int'>4</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_unpack'>unpack</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>V</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span><span class='rparen'>)</span> <span class='op'>!=</span> <span class='int'>0</span>
      <span class='id identifier rubyid_hint'>hint</span> <span class='op'>=</span> <span class='kw'>nil</span>
      <span class='id identifier rubyid_name'>name</span> <span class='op'>=</span> <span class='kw'>nil</span>

      <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_orgrva'>orgrva</span> <span class='op'>&amp;</span> <span class='const'>IMAGE_ORDINAL_FLAG32</span><span class='rparen'>)</span> <span class='op'>!=</span> <span class='int'>0</span>
        <span class='id identifier rubyid_hint'>hint</span> <span class='op'>=</span> <span class='id identifier rubyid_orgrva'>orgrva</span> <span class='op'>&amp;</span> <span class='int'>0xffff</span>
      <span class='kw'>else</span>
        <span class='id identifier rubyid_foff'>foff</span> <span class='op'>=</span> <span class='id identifier rubyid_rva_to_file_offset'>rva_to_file_offset</span><span class='lparen'>(</span><span class='id identifier rubyid_orgrva'>orgrva</span><span class='rparen'>)</span>
        <span class='id identifier rubyid_hint'>hint</span> <span class='op'>=</span> <span class='id identifier rubyid__isource'>_isource</span><span class='period'>.</span><span class='id identifier rubyid_read'>read</span><span class='lparen'>(</span><span class='id identifier rubyid_foff'>foff</span><span class='comma'>,</span> <span class='int'>2</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_unpack'>unpack</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>v</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span>
        <span class='id identifier rubyid_name'>name</span> <span class='op'>=</span> <span class='id identifier rubyid__isource'>_isource</span><span class='period'>.</span><span class='id identifier rubyid_read_asciiz'>read_asciiz</span><span class='lparen'>(</span><span class='id identifier rubyid_foff'>foff</span> <span class='op'>+</span> <span class='int'>2</span><span class='rparen'>)</span>
      <span class='kw'>end</span>

      <span class='id identifier rubyid_import'>import</span><span class='period'>.</span><span class='id identifier rubyid_entries'>entries</span> <span class='op'>&lt;&lt;</span> <span class='const'>ImportEntry</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_hint'>hint</span><span class='rparen'>)</span>

      <span class='id identifier rubyid_thunk_off'>thunk_off</span> <span class='op'>+=</span> <span class='int'>4</span>
    <span class='kw'>end</span>

    <span class='id identifier rubyid_imports'>imports</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_import'>import</span>
  <span class='kw'>end</span>

  <span class='kw'>return</span> <span class='id identifier rubyid_imports'>imports</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="_load_relocations-instance_method">
  
    - (<tt>Object</tt>) <strong>_load_relocations</strong> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1455
1456
1457
1458
1459
1460
1461
1462
1463
1464
1465
1466
1467
1468
1469
1470
1471
1472
1473
1474
1475
1476
1477
1478
1479
1480
1481
1482
1483
1484
1485
1486
1487
1488
1489
1490
1491
1492
1493
1494
1495
1496
1497
1498
1499
1500
1501
1502</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/peparsey/pebase.rb', line 1455</span>

<span class='kw'>def</span> <span class='id identifier rubyid__load_relocations'>_load_relocations</span>

  <span class='comment'>#
</span>  <span class='comment'># Get the data directory entry, size, etc
</span>  <span class='comment'>#
</span>  <span class='id identifier rubyid_exports_entry'>exports_entry</span> <span class='op'>=</span> <span class='id identifier rubyid__optional_header'>_optional_header</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>DataDirectory</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='int'>5</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_rva'>rva</span>           <span class='op'>=</span> <span class='id identifier rubyid_exports_entry'>exports_entry</span><span class='period'>.</span><span class='id identifier rubyid_v'>v</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>VirtualAddress</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_size'>size</span>          <span class='op'>=</span> <span class='id identifier rubyid_exports_entry'>exports_entry</span><span class='period'>.</span><span class='id identifier rubyid_v'>v</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Size</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>

  <span class='kw'>return</span> <span class='kw'>nil</span> <span class='kw'>if</span> <span class='id identifier rubyid_size'>size</span> <span class='op'>==</span> <span class='int'>0</span>

  <span class='comment'>#
</span>  <span class='comment'># Ok, so we have the data directory, now lets parse it
</span>  <span class='comment'>#
</span>
  <span class='id identifier rubyid_dirdata'>dirdata</span> <span class='op'>=</span> <span class='id identifier rubyid__isource'>_isource</span><span class='period'>.</span><span class='id identifier rubyid_read'>read</span><span class='lparen'>(</span><span class='id identifier rubyid_rva_to_file_offset'>rva_to_file_offset</span><span class='lparen'>(</span><span class='id identifier rubyid_rva'>rva</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='id identifier rubyid_size'>size</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_relocdirs'>relocdirs</span> <span class='op'>=</span> <span class='lbracket'>[</span> <span class='rbracket'>]</span>

  <span class='kw'>while</span> <span class='id identifier rubyid_dirdata'>dirdata</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span> <span class='op'>&gt;=</span> <span class='const'>IMAGE_SIZEOF_BASE_RELOCATION</span>
    <span class='id identifier rubyid_header'>header</span> <span class='op'>=</span> <span class='const'>IMAGE_BASE_RELOCATION</span><span class='period'>.</span><span class='id identifier rubyid_make_struct'>make_struct</span>
    <span class='id identifier rubyid_header'>header</span><span class='period'>.</span><span class='id identifier rubyid_from_s'>from_s</span><span class='lparen'>(</span><span class='id identifier rubyid_dirdata'>dirdata</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_dirdata'>dirdata</span> <span class='op'>=</span> <span class='id identifier rubyid_header'>header</span><span class='period'>.</span><span class='id identifier rubyid_leftover'>leftover</span>

    <span class='id identifier rubyid_numrelocs'>numrelocs</span> <span class='op'>=</span> <span class='lparen'>(</span><span class='id identifier rubyid_header'>header</span><span class='period'>.</span><span class='id identifier rubyid_v'>v</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>SizeOfBlock</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>-</span> <span class='const'>IMAGE_SIZEOF_BASE_RELOCATION</span><span class='rparen'>)</span> <span class='op'>/</span> <span class='int'>2</span>

    <span class='id identifier rubyid_relocbase'>relocbase</span> <span class='op'>=</span> <span class='id identifier rubyid_header'>header</span><span class='period'>.</span><span class='id identifier rubyid_v'>v</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>VirtualAddress</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>

    <span class='id identifier rubyid_relocdir'>relocdir</span> <span class='op'>=</span> <span class='const'>RelocationDirectory</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_relocbase'>relocbase</span><span class='comma'>,</span> <span class='lbracket'>[</span> <span class='rbracket'>]</span><span class='rparen'>)</span>

    <span class='id identifier rubyid_numrelocs'>numrelocs</span><span class='period'>.</span><span class='id identifier rubyid_times'>times</span> <span class='kw'>do</span>
      <span class='id identifier rubyid_reloc'>reloc</span> <span class='op'>=</span> <span class='const'>IMAGE_BASE_RELOCATION_TYPE_OFFSET</span><span class='period'>.</span><span class='id identifier rubyid_make_struct'>make_struct</span>
      <span class='id identifier rubyid_reloc'>reloc</span><span class='period'>.</span><span class='id identifier rubyid_from_s'>from_s</span><span class='lparen'>(</span><span class='id identifier rubyid_dirdata'>dirdata</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_dirdata'>dirdata</span> <span class='op'>=</span> <span class='id identifier rubyid_reloc'>reloc</span><span class='period'>.</span><span class='id identifier rubyid_leftover'>leftover</span>

      <span class='id identifier rubyid_typeoffset'>typeoffset</span> <span class='op'>=</span> <span class='id identifier rubyid_reloc'>reloc</span><span class='period'>.</span><span class='id identifier rubyid_v'>v</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>TypeOffset</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>

      <span class='id identifier rubyid_relocrva'>relocrva</span>  <span class='op'>=</span> <span class='id identifier rubyid_relocbase'>relocbase</span> <span class='op'>+</span> <span class='lparen'>(</span><span class='id identifier rubyid_typeoffset'>typeoffset</span> <span class='op'>&amp;</span> <span class='int'>0xfff</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_reloctype'>reloctype</span> <span class='op'>=</span> <span class='lparen'>(</span><span class='id identifier rubyid_typeoffset'>typeoffset</span> <span class='op'>&gt;&gt;</span> <span class='int'>12</span><span class='rparen'>)</span> <span class='op'>&amp;</span> <span class='int'>0xf</span>

      <span class='id identifier rubyid_relocdir'>relocdir</span><span class='period'>.</span><span class='id identifier rubyid_entries'>entries</span> <span class='op'>&lt;&lt;</span> <span class='const'>RelocationEntry</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_relocrva'>relocrva</span><span class='comma'>,</span> <span class='id identifier rubyid_reloctype'>reloctype</span><span class='rparen'>)</span>
    <span class='kw'>end</span>

    <span class='id identifier rubyid_relocdirs'>relocdirs</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_relocdir'>relocdir</span>
  <span class='kw'>end</span>

  <span class='kw'>return</span> <span class='id identifier rubyid_relocdirs'>relocdirs</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="_load_resources-instance_method">
  
    - (<tt>Object</tt>) <strong>_load_resources</strong> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1517
1518
1519
1520
1521
1522
1523
1524
1525
1526
1527
1528
1529
1530
1531
1532
1533
1534</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/peparsey/pebase.rb', line 1517</span>

<span class='kw'>def</span> <span class='id identifier rubyid__load_resources'>_load_resources</span>
  <span class='comment'>#
</span>  <span class='comment'># Get the data directory entry, size, etc
</span>  <span class='comment'>#
</span>  <span class='id identifier rubyid_rsrc_entry'>rsrc_entry</span> <span class='op'>=</span> <span class='id identifier rubyid__optional_header'>_optional_header</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>DataDirectory</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='const'>IMAGE_DIRECTORY_ENTRY_RESOURCE</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_rva'>rva</span>        <span class='op'>=</span> <span class='id identifier rubyid_rsrc_entry'>rsrc_entry</span><span class='period'>.</span><span class='id identifier rubyid_v'>v</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>VirtualAddress</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_size'>size</span>       <span class='op'>=</span> <span class='id identifier rubyid_rsrc_entry'>rsrc_entry</span><span class='period'>.</span><span class='id identifier rubyid_v'>v</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Size</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>

  <span class='kw'>return</span> <span class='kw'>nil</span> <span class='kw'>if</span> <span class='id identifier rubyid_size'>size</span> <span class='op'>==</span> <span class='int'>0</span>

  <span class='comment'>#
</span>  <span class='comment'># Ok, so we have the data directory, now lets parse it
</span>  <span class='comment'>#
</span>  <span class='id identifier rubyid_data'>data</span> <span class='op'>=</span> <span class='id identifier rubyid__isource'>_isource</span><span class='period'>.</span><span class='id identifier rubyid_read'>read</span><span class='lparen'>(</span><span class='id identifier rubyid_rva_to_file_offset'>rva_to_file_offset</span><span class='lparen'>(</span><span class='id identifier rubyid_rva'>rva</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='id identifier rubyid_size'>size</span><span class='rparen'>)</span>

  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid__resources_cache'>_resources_cache</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
  <span class='id identifier rubyid__parse_resource_directory'>_parse_resource_directory</span><span class='lparen'>(</span><span class='id identifier rubyid_data'>data</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="_parse_config_header-instance_method">
  
    - (<tt>Object</tt>) <strong>_parse_config_header</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>– doesn&#39;t seem to be used – not compatible with 64-bit def
self._parse_config_header(rawdata) header =
IMAGE_LOAD_CONFIG_DIRECTORY32.make_struct header.from_s(rawdata)
ConfigHeader.new(header) end ++</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


832
833
834
835
836
837
838
839
840
841
842
843
844
845
846
847
848
849
850
851
852
853
854</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/peparsey/pebase.rb', line 832</span>

<span class='kw'>def</span> <span class='id identifier rubyid__parse_config_header'>_parse_config_header</span>

  <span class='comment'>#
</span>  <span class='comment'># Get the data directory entry, size, etc
</span>  <span class='comment'>#
</span>  <span class='id identifier rubyid_exports_entry'>exports_entry</span> <span class='op'>=</span> <span class='id identifier rubyid__optional_header'>_optional_header</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>DataDirectory</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='const'>IMAGE_DIRECTORY_ENTRY_LOAD_CONFIG</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_rva'>rva</span>           <span class='op'>=</span> <span class='id identifier rubyid_exports_entry'>exports_entry</span><span class='period'>.</span><span class='id identifier rubyid_v'>v</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>VirtualAddress</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_size'>size</span>          <span class='op'>=</span> <span class='id identifier rubyid_exports_entry'>exports_entry</span><span class='period'>.</span><span class='id identifier rubyid_v'>v</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Size</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>

  <span class='kw'>return</span> <span class='kw'>nil</span> <span class='kw'>if</span> <span class='id identifier rubyid_size'>size</span> <span class='op'>==</span> <span class='int'>0</span>

  <span class='comment'>#
</span>  <span class='comment'># Ok, so we have the data directory, now lets parse it
</span>  <span class='comment'>#
</span>
  <span class='id identifier rubyid_dirdata'>dirdata</span> <span class='op'>=</span> <span class='id identifier rubyid__isource'>_isource</span><span class='period'>.</span><span class='id identifier rubyid_read'>read</span><span class='lparen'>(</span><span class='id identifier rubyid_rva_to_file_offset'>rva_to_file_offset</span><span class='lparen'>(</span><span class='id identifier rubyid_rva'>rva</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='id identifier rubyid_size'>size</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_klass'>klass</span>   <span class='op'>=</span> <span class='lparen'>(</span><span class='id identifier rubyid_ptr_64?'>ptr_64?</span><span class='rparen'>)</span> <span class='op'>?</span> <span class='const'>IMAGE_LOAD_CONFIG_DIRECTORY64</span> <span class='op'>:</span> <span class='const'>IMAGE_LOAD_CONFIG_DIRECTORY32</span>
  <span class='id identifier rubyid_header'>header</span>  <span class='op'>=</span> <span class='id identifier rubyid_klass'>klass</span><span class='period'>.</span><span class='id identifier rubyid_make_struct'>make_struct</span>

  <span class='id identifier rubyid_header'>header</span><span class='period'>.</span><span class='id identifier rubyid_from_s'>from_s</span><span class='lparen'>(</span><span class='id identifier rubyid_dirdata'>dirdata</span><span class='rparen'>)</span>

  <span class='ivar'>@config</span> <span class='op'>=</span> <span class='const'>ConfigHeader</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_header'>header</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="_parse_resource_directory-instance_method">
  
    - (<tt>Object</tt>) <strong>_parse_resource_directory</strong>(data, rname = 0, rvalue = 0x80000000, path = &#39;0&#39;, pname = nil) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1536
1537
1538
1539
1540
1541
1542
1543
1544
1545
1546
1547
1548
1549
1550
1551
1552
1553
1554
1555
1556
1557
1558
1559
1560
1561
1562
1563
1564
1565
1566
1567
1568
1569
1570
1571
1572
1573
1574</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/peparsey/pebase.rb', line 1536</span>

<span class='kw'>def</span> <span class='id identifier rubyid__parse_resource_directory'>_parse_resource_directory</span><span class='lparen'>(</span><span class='id identifier rubyid_data'>data</span><span class='comma'>,</span> <span class='id identifier rubyid_rname'>rname</span><span class='op'>=</span><span class='int'>0</span><span class='comma'>,</span> <span class='id identifier rubyid_rvalue'>rvalue</span><span class='op'>=</span><span class='int'>0x80000000</span><span class='comma'>,</span> <span class='id identifier rubyid_path'>path</span><span class='op'>=</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>0</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_pname'>pname</span><span class='op'>=</span><span class='kw'>nil</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_pname'>pname</span> <span class='op'>=</span> <span class='id identifier rubyid__parse_resource_name'>_parse_resource_name</span><span class='lparen'>(</span><span class='id identifier rubyid_data'>data</span><span class='comma'>,</span> <span class='id identifier rubyid_rname'>rname</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_path'>path</span><span class='period'>.</span><span class='id identifier rubyid_scan'>scan</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span> <span class='op'>==</span> <span class='int'>1</span><span class='rparen'>)</span>
    <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_pname'>pname</span> <span class='op'>!~</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^\d+</span><span class='regexp_end'>/</span></span><span class='rparen'>)</span>
      <span class='id identifier rubyid_path'>path</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>/</span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span> <span class='id identifier rubyid_pname'>pname</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_path'>path</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>/</span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span> <span class='id identifier rubyid__resource_lookup'>_resource_lookup</span><span class='lparen'>(</span> <span class='lparen'>(</span><span class='id identifier rubyid_rname'>rname</span> <span class='op'>&amp;</span> <span class='op'>~</span><span class='int'>0x80000000</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>


  <span class='id identifier rubyid_rvalue'>rvalue</span> <span class='op'>&amp;=</span> <span class='op'>~</span><span class='int'>0x80000000</span>
  <span class='id identifier rubyid_vals'>vals</span>  <span class='op'>=</span> <span class='id identifier rubyid_data'>data</span><span class='lbracket'>[</span><span class='id identifier rubyid_rvalue'>rvalue</span><span class='comma'>,</span> <span class='int'>16</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_unpack'>unpack</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>VVvvvv</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>

  <span class='id identifier rubyid_chars'>chars</span> <span class='op'>=</span> <span class='id identifier rubyid_vals'>vals</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_tdate'>tdate</span> <span class='op'>=</span> <span class='id identifier rubyid_vals'>vals</span><span class='lbracket'>[</span><span class='int'>1</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_vers'>vers</span>  <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_vals'>vals</span><span class='lbracket'>[</span><span class='int'>2</span><span class='rbracket'>]</span><span class='embexpr_end'>}</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_vals'>vals</span><span class='lbracket'>[</span><span class='int'>3</span><span class='rbracket'>]</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='id identifier rubyid_count'>count</span> <span class='op'>=</span> <span class='id identifier rubyid_vals'>vals</span><span class='lbracket'>[</span><span class='int'>4</span><span class='rbracket'>]</span> <span class='op'>+</span> <span class='id identifier rubyid_vals'>vals</span><span class='lbracket'>[</span><span class='int'>5</span><span class='rbracket'>]</span>

  <span class='int'>0</span><span class='period'>.</span><span class='id identifier rubyid_upto'>upto</span><span class='lparen'>(</span><span class='id identifier rubyid_count'>count</span><span class='op'>-</span><span class='int'>1</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_i'>i</span><span class='op'>|</span>

    <span class='id identifier rubyid_ename'>ename</span><span class='comma'>,</span> <span class='id identifier rubyid_evalue'>evalue</span> <span class='op'>=</span> <span class='id identifier rubyid_data'>data</span><span class='lbracket'>[</span><span class='id identifier rubyid_rvalue'>rvalue</span> <span class='op'>+</span> <span class='int'>16</span> <span class='op'>+</span> <span class='lparen'>(</span> <span class='id identifier rubyid_i'>i</span> <span class='op'>*</span> <span class='int'>8</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='int'>8</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_unpack'>unpack</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>VV</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
    <span class='id identifier rubyid_epath'>epath</span> <span class='op'>=</span> <span class='id identifier rubyid_path'>path</span> <span class='op'>+</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/</span><span class='tstring_end'>&#39;</span></span> <span class='op'>+</span> <span class='id identifier rubyid_i'>i</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span>

    <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_ename'>ename</span> <span class='op'>&amp;</span> <span class='int'>0x80000000</span> <span class='op'>!=</span> <span class='int'>0</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_pname'>pname</span> <span class='op'>=</span> <span class='id identifier rubyid__parse_resource_name'>_parse_resource_name</span><span class='lparen'>(</span><span class='id identifier rubyid_data'>data</span><span class='comma'>,</span> <span class='id identifier rubyid_ename'>ename</span><span class='rparen'>)</span>
    <span class='kw'>end</span>

    <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_evalue'>evalue</span> <span class='op'>&amp;</span> <span class='int'>0x80000000</span> <span class='op'>!=</span> <span class='int'>0</span><span class='rparen'>)</span>
      <span class='comment'># This is a subdirectory
</span>      <span class='id identifier rubyid__parse_resource_directory'>_parse_resource_directory</span><span class='lparen'>(</span><span class='id identifier rubyid_data'>data</span><span class='comma'>,</span> <span class='id identifier rubyid_ename'>ename</span><span class='comma'>,</span> <span class='id identifier rubyid_evalue'>evalue</span><span class='comma'>,</span> <span class='id identifier rubyid_epath'>epath</span><span class='comma'>,</span> <span class='id identifier rubyid_pname'>pname</span><span class='rparen'>)</span>
    <span class='kw'>else</span>
      <span class='comment'># This is an entry
</span>      <span class='id identifier rubyid__parse_resource_entry'>_parse_resource_entry</span><span class='lparen'>(</span><span class='id identifier rubyid_data'>data</span><span class='comma'>,</span> <span class='id identifier rubyid_ename'>ename</span><span class='comma'>,</span> <span class='id identifier rubyid_evalue'>evalue</span><span class='comma'>,</span> <span class='id identifier rubyid_epath'>epath</span><span class='comma'>,</span> <span class='id identifier rubyid_pname'>pname</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="_parse_resource_entry-instance_method">
  
    - (<tt>Object</tt>) <strong>_parse_resource_entry</strong>(data, rname, rvalue, path, pname) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1608
1609
1610
1611
1612
1613
1614
1615
1616
1617
1618
1619
1620
1621
1622
1623</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/peparsey/pebase.rb', line 1608</span>

<span class='kw'>def</span> <span class='id identifier rubyid__parse_resource_entry'>_parse_resource_entry</span><span class='lparen'>(</span><span class='id identifier rubyid_data'>data</span><span class='comma'>,</span> <span class='id identifier rubyid_rname'>rname</span><span class='comma'>,</span> <span class='id identifier rubyid_rvalue'>rvalue</span><span class='comma'>,</span> <span class='id identifier rubyid_path'>path</span><span class='comma'>,</span> <span class='id identifier rubyid_pname'>pname</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_rva'>rva</span><span class='comma'>,</span> <span class='id identifier rubyid_size'>size</span><span class='comma'>,</span> <span class='id identifier rubyid_code'>code</span> <span class='op'>=</span> <span class='id identifier rubyid_data'>data</span><span class='lbracket'>[</span><span class='id identifier rubyid_rvalue'>rvalue</span><span class='comma'>,</span> <span class='int'>12</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_unpack'>unpack</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>VVV</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
  <span class='id identifier rubyid_lang'>lang</span> <span class='op'>=</span> <span class='id identifier rubyid__parse_resource_name'>_parse_resource_name</span><span class='lparen'>(</span><span class='id identifier rubyid_data'>data</span><span class='comma'>,</span> <span class='id identifier rubyid_rname'>rname</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_ent'>ent</span> <span class='op'>=</span> <span class='const'>ResourceEntry</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span>
    <span class='kw'>self</span><span class='comma'>,</span>
    <span class='id identifier rubyid_path'>path</span><span class='comma'>,</span>
    <span class='id identifier rubyid_lang'>lang</span><span class='comma'>,</span>
    <span class='id identifier rubyid_code'>code</span><span class='comma'>,</span>
    <span class='id identifier rubyid_rva'>rva</span><span class='comma'>,</span>
    <span class='id identifier rubyid_size'>size</span><span class='comma'>,</span>
    <span class='id identifier rubyid_pname'>pname</span>
  <span class='rparen'>)</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid__resources_cache'>_resources_cache</span><span class='lbracket'>[</span><span class='id identifier rubyid_path'>path</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_ent'>ent</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="_parse_resource_name-instance_method">
  
    - (<tt>Object</tt>) <strong>_parse_resource_name</strong>(data, rname) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1625
1626
1627
1628
1629
1630
1631
1632
1633
1634</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/peparsey/pebase.rb', line 1625</span>

<span class='kw'>def</span> <span class='id identifier rubyid__parse_resource_name'>_parse_resource_name</span><span class='lparen'>(</span><span class='id identifier rubyid_data'>data</span><span class='comma'>,</span> <span class='id identifier rubyid_rname'>rname</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_rname'>rname</span> <span class='op'>&amp;</span> <span class='int'>0x80000000</span> <span class='op'>!=</span> <span class='int'>0</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_rname'>rname</span> <span class='op'>&amp;=</span> <span class='op'>~</span><span class='int'>0x80000000</span>
    <span class='id identifier rubyid_unistr'>unistr</span> <span class='op'>=</span> <span class='id identifier rubyid_data'>data</span><span class='lbracket'>[</span><span class='id identifier rubyid_rname'>rname</span><span class='op'>+</span><span class='int'>2</span><span class='comma'>,</span> <span class='int'>2</span> <span class='op'>*</span> <span class='id identifier rubyid_data'>data</span><span class='lbracket'>[</span><span class='id identifier rubyid_rname'>rname</span><span class='comma'>,</span><span class='int'>2</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_unpack'>unpack</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>v</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span> <span class='rbracket'>]</span>
    <span class='id identifier rubyid_unistr'>unistr</span><span class='comma'>,</span> <span class='id identifier rubyid_trash'>trash</span> <span class='op'>=</span> <span class='id identifier rubyid_unistr'>unistr</span><span class='period'>.</span><span class='id identifier rubyid_split'>split</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>\x00\x00</span><span class='regexp_end'>/n</span></span><span class='comma'>,</span> <span class='int'>2</span><span class='rparen'>)</span>
    <span class='kw'>return</span> <span class='id identifier rubyid_unistr'>unistr</span> <span class='op'>?</span> <span class='id identifier rubyid_unistr'>unistr</span><span class='period'>.</span><span class='id identifier rubyid_gsub'>gsub</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>\x00</span><span class='regexp_end'>/n</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='op'>:</span> <span class='kw'>nil</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_rname'>rname</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="_parse_tls_header-instance_method">
  
    - (<tt>Object</tt>) <strong>_parse_tls_header</strong> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


963
964
965
966
967
968
969
970
971
972
973
974
975
976
977
978
979
980
981
982
983
984
985</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/peparsey/pebase.rb', line 963</span>

<span class='kw'>def</span> <span class='id identifier rubyid__parse_tls_header'>_parse_tls_header</span>

  <span class='comment'>#
</span>  <span class='comment'># Get the data directory entry, size, etc
</span>  <span class='comment'>#
</span>  <span class='id identifier rubyid_exports_entry'>exports_entry</span> <span class='op'>=</span> <span class='id identifier rubyid__optional_header'>_optional_header</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>DataDirectory</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='const'>IMAGE_DIRECTORY_ENTRY_TLS</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_rva'>rva</span>           <span class='op'>=</span> <span class='id identifier rubyid_exports_entry'>exports_entry</span><span class='period'>.</span><span class='id identifier rubyid_v'>v</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>VirtualAddress</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_size'>size</span>          <span class='op'>=</span> <span class='id identifier rubyid_exports_entry'>exports_entry</span><span class='period'>.</span><span class='id identifier rubyid_v'>v</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Size</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>

  <span class='kw'>return</span> <span class='kw'>nil</span> <span class='kw'>if</span> <span class='id identifier rubyid_size'>size</span> <span class='op'>==</span> <span class='int'>0</span>

  <span class='comment'>#
</span>  <span class='comment'># Ok, so we have the data directory, now lets parse it
</span>  <span class='comment'>#
</span>
  <span class='id identifier rubyid_dirdata'>dirdata</span> <span class='op'>=</span> <span class='id identifier rubyid__isource'>_isource</span><span class='period'>.</span><span class='id identifier rubyid_read'>read</span><span class='lparen'>(</span><span class='id identifier rubyid_rva_to_file_offset'>rva_to_file_offset</span><span class='lparen'>(</span><span class='id identifier rubyid_rva'>rva</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='id identifier rubyid_size'>size</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_klass'>klass</span>   <span class='op'>=</span> <span class='lparen'>(</span><span class='id identifier rubyid_ptr_64?'>ptr_64?</span><span class='rparen'>)</span> <span class='op'>?</span> <span class='const'>IMAGE_LOAD_TLS_DIRECTORY64</span> <span class='op'>:</span> <span class='const'>IMAGE_LOAD_TLS_DIRECTORY32</span>
  <span class='id identifier rubyid_header'>header</span>  <span class='op'>=</span> <span class='id identifier rubyid_klass'>klass</span><span class='period'>.</span><span class='id identifier rubyid_make_struct'>make_struct</span>

  <span class='id identifier rubyid_header'>header</span><span class='period'>.</span><span class='id identifier rubyid_from_s'>from_s</span><span class='lparen'>(</span><span class='id identifier rubyid_dirdata'>dirdata</span><span class='rparen'>)</span>

  <span class='ivar'>@tls</span> <span class='op'>=</span> <span class='const'>TLSHeader</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_header'>header</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="_resource_lookup-instance_method">
  
    - (<tt>Object</tt>) <strong>_resource_lookup</strong>(i) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1576
1577
1578
1579
1580
1581
1582
1583
1584
1585
1586
1587
1588
1589
1590
1591
1592
1593
1594
1595
1596
1597
1598
1599
1600
1601
1602
1603
1604
1605
1606</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/peparsey/pebase.rb', line 1576</span>

<span class='kw'>def</span> <span class='id identifier rubyid__resource_lookup'>_resource_lookup</span><span class='lparen'>(</span><span class='id identifier rubyid_i'>i</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_tbl'>tbl</span> <span class='op'>=</span> <span class='lbrace'>{</span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>1</span><span class='tstring_end'>&#39;</span></span>      <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>RT_CURSOR</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>2</span><span class='tstring_end'>&#39;</span></span>      <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>RT_BITMAP</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>3</span><span class='tstring_end'>&#39;</span></span>      <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>RT_ICON</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>4</span><span class='tstring_end'>&#39;</span></span>      <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>RT_MENU</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>5</span><span class='tstring_end'>&#39;</span></span>      <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>RT_DIALOG</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>6</span><span class='tstring_end'>&#39;</span></span>      <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>RT_STRING</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>7</span><span class='tstring_end'>&#39;</span></span>      <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>RT_FONTDIR</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>8</span><span class='tstring_end'>&#39;</span></span>      <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>RT_FONT</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>9</span><span class='tstring_end'>&#39;</span></span>      <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>RT_ACCELERATORS</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>10</span><span class='tstring_end'>&#39;</span></span>     <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>RT_RCDATA</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>11</span><span class='tstring_end'>&#39;</span></span>     <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>RT_MESSAGETABLE</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>12</span><span class='tstring_end'>&#39;</span></span>     <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>RT_GROUP_CURSOR</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>14</span><span class='tstring_end'>&#39;</span></span>     <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>RT_GROUP_ICON</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>16</span><span class='tstring_end'>&#39;</span></span>     <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>RT_VERSION</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>17</span><span class='tstring_end'>&#39;</span></span>     <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>RT_DLGINCLUDE</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>19</span><span class='tstring_end'>&#39;</span></span>     <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>RT_PLUGPLAY</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>20</span><span class='tstring_end'>&#39;</span></span>     <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>RT_VXD</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>21</span><span class='tstring_end'>&#39;</span></span>     <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>RT_ANICURSOR</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>22</span><span class='tstring_end'>&#39;</span></span>     <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>RT_ANIICON</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>23</span><span class='tstring_end'>&#39;</span></span>     <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>RT_HTML</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>24</span><span class='tstring_end'>&#39;</span></span>     <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>RT_MANIFEST</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>32767</span><span class='tstring_end'>&#39;</span></span>  <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>RT_ERROR</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>8192</span><span class='tstring_end'>&#39;</span></span>   <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>RT_NEWRESOURCE</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>8194</span><span class='tstring_end'>&#39;</span></span>   <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>RT_NEWBITMAP</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>8196</span><span class='tstring_end'>&#39;</span></span>   <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>RT_NEWMENU</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>8197</span><span class='tstring_end'>&#39;</span></span>   <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>RT_NEWDIALOG</span><span class='tstring_end'>&#39;</span></span>
  <span class='rbrace'>}</span>
  <span class='id identifier rubyid_tbl'>tbl</span><span class='lbracket'>[</span><span class='id identifier rubyid_i'>i</span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='id identifier rubyid_i'>i</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="close-instance_method">
  
    - (<tt>Object</tt>) <strong>close</strong> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1175
1176
1177</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/peparsey/pebase.rb', line 1175</span>

<span class='kw'>def</span> <span class='id identifier rubyid_close'>close</span>
  <span class='id identifier rubyid__isource'>_isource</span><span class='period'>.</span><span class='id identifier rubyid_close'>close</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="config-instance_method">
  
    - (<tt>Object</tt>) <strong>config</strong> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


857
858
859
860</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/peparsey/pebase.rb', line 857</span>

<span class='kw'>def</span> <span class='id identifier rubyid_config'>config</span>
  <span class='id identifier rubyid__parse_config_header'>_parse_config_header</span> <span class='kw'>if</span> <span class='ivar'>@config</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
  <span class='ivar'>@config</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="exception-instance_method">
  
    - (<tt>Object</tt>) <strong>exception</strong> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1123
1124
1125
1126</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/peparsey/pebase.rb', line 1123</span>

<span class='kw'>def</span> <span class='id identifier rubyid_exception'>exception</span>
  <span class='id identifier rubyid__load_exception_directory'>_load_exception_directory</span> <span class='kw'>if</span> <span class='ivar'>@exception</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
  <span class='ivar'>@exception</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="exports-instance_method">
  
    - (<tt>Object</tt>) <strong>exports</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>We lazily parse the exports, and then cache it</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1371
1372
1373
1374
1375
1376
1377</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/peparsey/pebase.rb', line 1371</span>

<span class='kw'>def</span> <span class='id identifier rubyid_exports'>exports</span>
  <span class='kw'>if</span> <span class='op'>!</span><span class='id identifier rubyid__exports_cached'>_exports_cached</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid__exports_cache'>_exports_cache</span>  <span class='op'>=</span> <span class='id identifier rubyid__load_exports'>_load_exports</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid__exports_cached'>_exports_cached</span> <span class='op'>=</span> <span class='kw'>true</span>
  <span class='kw'>end</span>
  <span class='kw'>return</span> <span class='id identifier rubyid__exports_cache'>_exports_cache</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="file_offset_to_rva-instance_method">
  
    - (<tt>Object</tt>) <strong>file_offset_to_rva</strong>(foffset) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  
<p class="tag_title">Raises:</p>
<ul class="raise">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="PeParseyError.html" title="Rex::PeParsey::PeParseyError (class)">PeParseyError</a></span></tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1206
1207
1208
1209
1210
1211
1212
1213
1214
1215
1216
1217
1218</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/peparsey/pebase.rb', line 1206</span>

<span class='kw'>def</span> <span class='id identifier rubyid_file_offset_to_rva'>file_offset_to_rva</span><span class='lparen'>(</span><span class='id identifier rubyid_foffset'>foffset</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_foffset'>foffset</span> <span class='op'>&lt;</span> <span class='int'>0</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'>PeParseyError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Offset should not be less than 0. The value is: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_foffset'>foffset</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_caller'>caller</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_all_sections'>all_sections</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_section'>section</span><span class='op'>|</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_section'>section</span><span class='period'>.</span><span class='id identifier rubyid_contains_file_offset?'>contains_file_offset?</span><span class='lparen'>(</span><span class='id identifier rubyid_foffset'>foffset</span><span class='rparen'>)</span>
      <span class='kw'>return</span> <span class='id identifier rubyid_section'>section</span><span class='period'>.</span><span class='id identifier rubyid_file_offset_to_rva'>file_offset_to_rva</span><span class='lparen'>(</span><span class='id identifier rubyid_foffset'>foffset</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_raise'>raise</span> <span class='const'>PeParseyError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>No section contains file offset </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_foffset'>foffset</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_caller'>caller</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="file_offset_to_vma-instance_method">
  
    - (<tt>Object</tt>) <strong>file_offset_to_vma</strong>(foffset) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1220
1221
1222</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/peparsey/pebase.rb', line 1220</span>

<span class='kw'>def</span> <span class='id identifier rubyid_file_offset_to_vma'>file_offset_to_vma</span><span class='lparen'>(</span><span class='id identifier rubyid_foffset'>foffset</span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_rva_to_vma'>rva_to_vma</span><span class='lparen'>(</span><span class='id identifier rubyid_file_offset_to_rva'>file_offset_to_rva</span><span class='lparen'>(</span><span class='id identifier rubyid_foffset'>foffset</span><span class='rparen'>)</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="find_section_by_rva-instance_method">
  
    - (<tt>Object</tt>) <strong>find_section_by_rva</strong>(rva) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1244
1245
1246
1247
1248
1249
1250
1251
1252</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/peparsey/pebase.rb', line 1244</span>

<span class='kw'>def</span> <span class='id identifier rubyid_find_section_by_rva'>find_section_by_rva</span><span class='lparen'>(</span><span class='id identifier rubyid_rva'>rva</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_section'>section</span> <span class='op'>=</span> <span class='id identifier rubyid__find_section_by_rva'>_find_section_by_rva</span><span class='lparen'>(</span><span class='id identifier rubyid_rva'>rva</span><span class='rparen'>)</span>

  <span class='kw'>if</span> <span class='op'>!</span><span class='id identifier rubyid_section'>section</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'>PeParseyError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Cannot find rva! </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_rva'>rva</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_caller'>caller</span>
  <span class='kw'>end</span>

  <span class='kw'>return</span> <span class='id identifier rubyid_section'>section</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="find_section_by_vma-instance_method">
  
    - (<tt>Object</tt>) <strong>find_section_by_vma</strong>(vma) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Find a section by a VMA</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1257
1258
1259</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/peparsey/pebase.rb', line 1257</span>

<span class='kw'>def</span> <span class='id identifier rubyid_find_section_by_vma'>find_section_by_vma</span><span class='lparen'>(</span><span class='id identifier rubyid_vma'>vma</span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_find_section_by_rva'>find_section_by_rva</span><span class='lparen'>(</span><span class='id identifier rubyid_vma_to_rva'>vma_to_rva</span><span class='lparen'>(</span><span class='id identifier rubyid_vma'>vma</span><span class='rparen'>)</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="imports-instance_method">
  
    - (<tt>Object</tt>) <strong>imports</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>We lazily parse the imports, and then cache it</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1300
1301
1302
1303
1304
1305
1306</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/peparsey/pebase.rb', line 1300</span>

<span class='kw'>def</span> <span class='id identifier rubyid_imports'>imports</span>
  <span class='kw'>if</span> <span class='op'>!</span><span class='id identifier rubyid__imports_cached'>_imports_cached</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid__imports_cache'>_imports_cache</span>  <span class='op'>=</span> <span class='id identifier rubyid__load_imports'>_load_imports</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid__imports_cached'>_imports_cached</span> <span class='op'>=</span> <span class='kw'>true</span>
  <span class='kw'>end</span>
  <span class='kw'>return</span> <span class='id identifier rubyid__imports_cache'>_imports_cache</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="read_asciiz_rva-instance_method">
  
    - (<tt>Object</tt>) <strong>read_asciiz_rva</strong>(rva) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1283
1284
1285</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/peparsey/pebase.rb', line 1283</span>

<span class='kw'>def</span> <span class='id identifier rubyid_read_asciiz_rva'>read_asciiz_rva</span><span class='lparen'>(</span><span class='id identifier rubyid_rva'>rva</span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_find_section_by_rva'>find_section_by_rva</span><span class='lparen'>(</span><span class='id identifier rubyid_rva'>rva</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_read_asciiz_rva'>read_asciiz_rva</span><span class='lparen'>(</span><span class='id identifier rubyid_rva'>rva</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="read_asciiz_vma-instance_method">
  
    - (<tt>Object</tt>) <strong>read_asciiz_vma</strong>(vma) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1287
1288
1289</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/peparsey/pebase.rb', line 1287</span>

<span class='kw'>def</span> <span class='id identifier rubyid_read_asciiz_vma'>read_asciiz_vma</span><span class='lparen'>(</span><span class='id identifier rubyid_vma'>vma</span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_read_asciiz_rva'>read_asciiz_rva</span><span class='lparen'>(</span><span class='id identifier rubyid_vma_to_rva'>vma_to_rva</span><span class='lparen'>(</span><span class='id identifier rubyid_vma'>vma</span><span class='rparen'>)</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="read_rva-instance_method">
  
    - (<tt>Object</tt>) <strong>read_rva</strong>(rva, length) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Some convenient methods to read a vma/rva without having the section…
(inefficent though I suppose…)</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1275
1276
1277</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/peparsey/pebase.rb', line 1275</span>

<span class='kw'>def</span> <span class='id identifier rubyid_read_rva'>read_rva</span><span class='lparen'>(</span><span class='id identifier rubyid_rva'>rva</span><span class='comma'>,</span> <span class='id identifier rubyid_length'>length</span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_find_section_by_rva'>find_section_by_rva</span><span class='lparen'>(</span><span class='id identifier rubyid_rva'>rva</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_read_rva'>read_rva</span><span class='lparen'>(</span><span class='id identifier rubyid_rva'>rva</span><span class='comma'>,</span> <span class='id identifier rubyid_length'>length</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="read_vma-instance_method">
  
    - (<tt>Object</tt>) <strong>read_vma</strong>(vma, length) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1279
1280
1281</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/peparsey/pebase.rb', line 1279</span>

<span class='kw'>def</span> <span class='id identifier rubyid_read_vma'>read_vma</span><span class='lparen'>(</span><span class='id identifier rubyid_vma'>vma</span><span class='comma'>,</span> <span class='id identifier rubyid_length'>length</span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_read_rva'>read_rva</span><span class='lparen'>(</span><span class='id identifier rubyid_vma_to_rva'>vma_to_rva</span><span class='lparen'>(</span><span class='id identifier rubyid_vma'>vma</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='id identifier rubyid_length'>length</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="relocations-instance_method">
  
    - (<tt>Object</tt>) <strong>relocations</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Base relocations in the hizzy</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1447
1448
1449
1450
1451
1452
1453</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/peparsey/pebase.rb', line 1447</span>

<span class='kw'>def</span> <span class='id identifier rubyid_relocations'>relocations</span>
  <span class='kw'>if</span> <span class='op'>!</span><span class='id identifier rubyid__relocations_cached'>_relocations_cached</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid__relocations_cache'>_relocations_cache</span>  <span class='op'>=</span> <span class='id identifier rubyid__load_relocations'>_load_relocations</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid__relocations_cached'>_relocations_cached</span> <span class='op'>=</span> <span class='kw'>true</span>
  <span class='kw'>end</span>
  <span class='kw'>return</span> <span class='id identifier rubyid__relocations_cache'>_relocations_cache</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="resources-instance_method">
  
    - (<tt>Object</tt>) <strong>resources</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>We lazily parse the resources, and then cache them</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1508
1509
1510
1511
1512
1513
1514
1515</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/peparsey/pebase.rb', line 1508</span>

<span class='kw'>def</span> <span class='id identifier rubyid_resources'>resources</span>
  <span class='kw'>if</span> <span class='op'>!</span><span class='id identifier rubyid__resources_cached'>_resources_cached</span>
    <span class='id identifier rubyid__load_resources'>_load_resources</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid__resources_cached'>_resources_cached</span> <span class='op'>=</span> <span class='kw'>true</span>
  <span class='kw'>end</span>

  <span class='kw'>return</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid__resources_cache'>_resources_cache</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="rva_to_file_offset-instance_method">
  
    - (<tt>Object</tt>) <strong>rva_to_file_offset</strong>(rva) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  
<p class="tag_title">Raises:</p>
<ul class="raise">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="PeParseyError.html" title="Rex::PeParsey::PeParseyError (class)">PeParseyError</a></span></tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1193
1194
1195
1196
1197
1198
1199
1200</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/peparsey/pebase.rb', line 1193</span>

<span class='kw'>def</span> <span class='id identifier rubyid_rva_to_file_offset'>rva_to_file_offset</span><span class='lparen'>(</span><span class='id identifier rubyid_rva'>rva</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_all_sections'>all_sections</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_section'>section</span><span class='op'>|</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_section'>section</span><span class='period'>.</span><span class='id identifier rubyid_contains_rva?'>contains_rva?</span><span class='lparen'>(</span><span class='id identifier rubyid_rva'>rva</span><span class='rparen'>)</span>
      <span class='kw'>return</span> <span class='id identifier rubyid_section'>section</span><span class='period'>.</span><span class='id identifier rubyid_rva_to_file_offset'>rva_to_file_offset</span><span class='lparen'>(</span><span class='id identifier rubyid_rva'>rva</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_raise'>raise</span> <span class='const'>PeParseyError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>No section contains RVA</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_caller'>caller</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="rva_to_vma-instance_method">
  
    - (<tt>Object</tt>) <strong>rva_to_vma</strong>(rva) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Random rva, vma, file offset, section offset, etc conversion routines…</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1185
1186
1187</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/peparsey/pebase.rb', line 1185</span>

<span class='kw'>def</span> <span class='id identifier rubyid_rva_to_vma'>rva_to_vma</span><span class='lparen'>(</span><span class='id identifier rubyid_rva'>rva</span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_rva'>rva</span> <span class='op'>+</span> <span class='id identifier rubyid_image_base'>image_base</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="tls-instance_method">
  
    - (<tt>Object</tt>) <strong>tls</strong> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


988
989
990
991</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/peparsey/pebase.rb', line 988</span>

<span class='kw'>def</span> <span class='id identifier rubyid_tls'>tls</span>
  <span class='id identifier rubyid__parse_config_header'>_parse_config_header</span> <span class='kw'>if</span> <span class='ivar'>@tls</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
  <span class='ivar'>@tls</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="update_checksum-instance_method">
  
    - (<tt>Object</tt>) <strong>update_checksum</strong> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1636
1637
1638
1639
1640
1641
1642
1643
1644
1645
1646
1647
1648
1649
1650
1651
1652
1653
1654
1655
1656
1657
1658
1659
1660</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/peparsey/pebase.rb', line 1636</span>

<span class='kw'>def</span> <span class='id identifier rubyid_update_checksum'>update_checksum</span>
  <span class='id identifier rubyid_off'>off</span> <span class='op'>=</span> <span class='id identifier rubyid__dos_header'>_dos_header</span><span class='period'>.</span><span class='id identifier rubyid_e_lfanew'>e_lfanew</span> <span class='op'>+</span> <span class='const'>IMAGE_FILE_HEADER_SIZE</span> <span class='op'>+</span> <span class='int'>0x40</span>
  <span class='id identifier rubyid__isource'>_isource</span><span class='period'>.</span><span class='id identifier rubyid_rawdata'>rawdata</span><span class='lbracket'>[</span><span class='id identifier rubyid_off'>off</span><span class='comma'>,</span> <span class='int'>4</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_pack'>pack</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>V</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>

  <span class='id identifier rubyid_rem'>rem</span> <span class='op'>=</span> <span class='id identifier rubyid__isource'>_isource</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span> <span class='op'>%</span> <span class='int'>4</span>
  <span class='id identifier rubyid_sum_me'>sum_me</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span>
  <span class='id identifier rubyid_sum_me'>sum_me</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid__isource'>_isource</span><span class='period'>.</span><span class='id identifier rubyid_rawdata'>rawdata</span>
  <span class='id identifier rubyid_sum_me'>sum_me</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\x00</span><span class='tstring_end'>&quot;</span></span> <span class='op'>*</span> <span class='lparen'>(</span><span class='int'>4</span> <span class='op'>-</span> <span class='id identifier rubyid_rem'>rem</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_rem'>rem</span> <span class='op'>&gt;</span> <span class='int'>0</span>

  <span class='id identifier rubyid_cksum'>cksum</span> <span class='op'>=</span> <span class='int'>0</span>
  <span class='id identifier rubyid_sum_me'>sum_me</span><span class='period'>.</span><span class='id identifier rubyid_unpack'>unpack</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>V*</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_el'>el</span><span class='op'>|</span>
    <span class='id identifier rubyid_cksum'>cksum</span> <span class='op'>=</span> <span class='lparen'>(</span><span class='id identifier rubyid_cksum'>cksum</span> <span class='op'>&amp;</span> <span class='int'>0xffffffff</span><span class='rparen'>)</span> <span class='op'>+</span> <span class='lparen'>(</span><span class='id identifier rubyid_cksum'>cksum</span> <span class='op'>&gt;&gt;</span> <span class='int'>32</span><span class='rparen'>)</span> <span class='op'>+</span> <span class='id identifier rubyid_el'>el</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_cksum'>cksum</span> <span class='op'>&gt;</span> <span class='int'>2</span><span class='op'>**</span><span class='int'>32</span>
      <span class='id identifier rubyid_cksum'>cksum</span> <span class='op'>=</span> <span class='lparen'>(</span><span class='id identifier rubyid_cksum'>cksum</span> <span class='op'>&amp;</span> <span class='int'>0xffffffff</span><span class='rparen'>)</span> <span class='op'>+</span> <span class='lparen'>(</span><span class='id identifier rubyid_cksum'>cksum</span> <span class='op'>&gt;&gt;</span> <span class='int'>32</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='rbrace'>}</span>

  <span class='id identifier rubyid_cksum'>cksum</span> <span class='op'>=</span> <span class='lparen'>(</span><span class='id identifier rubyid_cksum'>cksum</span> <span class='op'>&amp;</span> <span class='int'>0xffff</span><span class='rparen'>)</span> <span class='op'>+</span> <span class='lparen'>(</span><span class='id identifier rubyid_cksum'>cksum</span> <span class='op'>&gt;&gt;</span> <span class='int'>16</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_cksum'>cksum</span> <span class='op'>+=</span> <span class='lparen'>(</span><span class='id identifier rubyid_cksum'>cksum</span> <span class='op'>&gt;&gt;</span> <span class='int'>16</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_cksum'>cksum</span> <span class='op'>&amp;=</span> <span class='int'>0xffff</span>

  <span class='id identifier rubyid_cksum'>cksum</span> <span class='op'>+=</span> <span class='id identifier rubyid__isource'>_isource</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span>

  <span class='id identifier rubyid__isource'>_isource</span><span class='period'>.</span><span class='id identifier rubyid_rawdata'>rawdata</span><span class='lbracket'>[</span><span class='id identifier rubyid_off'>off</span><span class='comma'>,</span> <span class='int'>4</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='id identifier rubyid_cksum'>cksum</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_pack'>pack</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>V</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="valid_rva?-instance_method">
  
    - (<tt>Boolean</tt>) <strong>valid_rva?</strong>(rva) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1261
1262
1263</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/peparsey/pebase.rb', line 1261</span>

<span class='kw'>def</span> <span class='id identifier rubyid_valid_rva?'>valid_rva?</span><span class='lparen'>(</span><span class='id identifier rubyid_rva'>rva</span><span class='rparen'>)</span>
  <span class='id identifier rubyid__find_section_by_rva'>_find_section_by_rva</span><span class='lparen'>(</span><span class='id identifier rubyid_rva'>rva</span><span class='rparen'>)</span> <span class='op'>!=</span> <span class='kw'>nil</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="valid_vma?-instance_method">
  
    - (<tt>Boolean</tt>) <strong>valid_vma?</strong>(vma) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1264
1265
1266</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/peparsey/pebase.rb', line 1264</span>

<span class='kw'>def</span> <span class='id identifier rubyid_valid_vma?'>valid_vma?</span><span class='lparen'>(</span><span class='id identifier rubyid_vma'>vma</span><span class='rparen'>)</span>
  <span class='id identifier rubyid__find_section_by_rva'>_find_section_by_rva</span><span class='lparen'>(</span><span class='id identifier rubyid_vma_to_rva'>vma_to_rva</span><span class='lparen'>(</span><span class='id identifier rubyid_vma'>vma</span><span class='rparen'>)</span><span class='rparen'>)</span> <span class='op'>!=</span> <span class='kw'>nil</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="vma_to_file_offset-instance_method">
  
    - (<tt>Object</tt>) <strong>vma_to_file_offset</strong>(vma) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1202
1203
1204</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/peparsey/pebase.rb', line 1202</span>

<span class='kw'>def</span> <span class='id identifier rubyid_vma_to_file_offset'>vma_to_file_offset</span><span class='lparen'>(</span><span class='id identifier rubyid_vma'>vma</span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_rva_to_file_offset'>rva_to_file_offset</span><span class='lparen'>(</span><span class='id identifier rubyid_vma_to_rva'>vma_to_rva</span><span class='lparen'>(</span><span class='id identifier rubyid_vma'>vma</span><span class='rparen'>)</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="vma_to_rva-instance_method">
  
    - (<tt>Object</tt>) <strong>vma_to_rva</strong>(vma) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1189
1190
1191</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/peparsey/pebase.rb', line 1189</span>

<span class='kw'>def</span> <span class='id identifier rubyid_vma_to_rva'>vma_to_rva</span><span class='lparen'>(</span><span class='id identifier rubyid_vma'>vma</span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_vma'>vma</span> <span class='op'>-</span> <span class='id identifier rubyid_image_base'>image_base</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

    <div id="footer">
  Generated on Tue Jan 19 22:37:01 2016 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.8.7.6 (ruby-2.1.7).
</div>

  </body>
</html>