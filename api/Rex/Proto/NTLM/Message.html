<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>
  Class: Rex::Proto::NTLM::Message
  
    &mdash; Documentation by YARD 0.8.7.6
  
</title>

  <link rel="stylesheet" href="../../../css/style.css" type="text/css" charset="utf-8" />

  <link rel="stylesheet" href="../../../css/common.css" type="text/css" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  hasFrames = window.top.frames.main ? true : false;
  relpath = '../../../';
  framesUrl = "../../../frames.html#!Rex/Proto/NTLM/Message.html";
</script>


  <script type="text/javascript" charset="utf-8" src="../../../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../../../js/app.js"></script>


  </head>
  <body>
    <div id="header">
      <div id="menu">
  
    <a href="../../../_index.html">Index (M)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../../../Rex.html" title="Rex (module)">Rex</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../../Proto.html" title="Rex::Proto (module)">Proto</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../NTLM.html" title="Rex::Proto::NTLM (module)">NTLM</a></span></span>
     &raquo; 
    <span class="title">Message</span>
  

  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../../../class_list.html">
      Class List
    </a>
  
    <a class="full_list_link" id="method_list_link"
        href="../../../method_list.html">
      Method List
    </a>
  
    <a class="full_list_link" id="file_list_link"
        href="../../../file_list.html">
      File List
    </a>
  
</div>
      <div class="clear"></div>
    </div>

    <iframe id="search_frame"></iframe>

    <div id="content"><h1>Class: Rex::Proto::NTLM::Message
  
  
  
</h1>

<dl class="box">
  
    <dt class="r1">Inherits:</dt>
    <dd class="r1">
      <span class="inheritName"><span class='object_link'><a href="Base/FieldSet.html" title="Rex::Proto::NTLM::Base::FieldSet (class)">Base::FieldSet</a></span></span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next"><span class='object_link'><a href="Base/FieldSet.html" title="Rex::Proto::NTLM::Base::FieldSet (class)">Base::FieldSet</a></span></li>
          
            <li class="next">Rex::Proto::NTLM::Message</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
      </dd>
    
  
  
    
  
    
  
  
  
    <dt class="r2 last">Defined in:</dt>
    <dd class="r2 last">lib/rex/proto/ntlm/message.rb</dd>
  
</dl>
<div class="clear"></div>


  <h2>Constant Summary</h2>
  
    <dl class="constants">
      
        <dt id="BASE-constant" class="">BASE =
          
        </dt>
        <dd><pre class="code"><span class='const'>Rex</span><span class='op'>::</span><span class='const'>Proto</span><span class='op'>::</span><span class='const'>NTLM</span><span class='op'>::</span><span class='const'>Base</span></pre></dd>
      
        <dt id="CONST-constant" class="">CONST =
          
        </dt>
        <dd><pre class="code"><span class='const'>Rex</span><span class='op'>::</span><span class='const'>Proto</span><span class='op'>::</span><span class='const'>NTLM</span><span class='op'>::</span><span class='const'>Constants</span></pre></dd>
      
        <dt id="CRYPT-constant" class="">CRYPT =
          
        </dt>
        <dd><pre class="code"><span class='const'>Rex</span><span class='op'>::</span><span class='const'>Proto</span><span class='op'>::</span><span class='const'>NTLM</span><span class='op'>::</span><span class='const'>Crypt</span></pre></dd>
      
    </dl>
  







  
    <h2>
      Class Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#decode64-class_method" title="decode64 (class method)">+ (Object) <strong>decode64</strong>(str) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#downgrade_type_message-class_method" title="downgrade_type_message (class method)">+ (Object) <strong>downgrade_type_message</strong>(message) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Downgrading Type messages to LMv1/NTLMv1 and removing signing.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#parse-class_method" title="parse (class method)">+ (Object) <strong>parse</strong>(str) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#process_type1_message-class_method" title="process_type1_message (class method)">+ (Object) <strong>process_type1_message</strong>(message, nonce = &quot;\x11\x22\x33\x44\x55\x66\x77\x88&quot;, win_domain = &#39;DOMAIN&#39;, win_name = &#39;SERVER&#39;, dns_name = &#39;server&#39;, dns_domain = &#39;example.com&#39;, downgrade = true) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Process Type 1 NTLM Messages, return a Base64 Type 2 Message.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#process_type3_message-class_method" title="process_type3_message (class method)">+ (Object) <strong>process_type3_message</strong>(message) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Process Type 3 NTLM Message (in Base64).</p>
</div></span>
  
</li>

      
    </ul>
  
    <h2>
      Instance Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#data_size-instance_method" title="#data_size (instance method)">- (Object) <strong>data_size</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#decode64-instance_method" title="#decode64 (instance method)">- (Object) <strong>decode64</strong>(str) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#dump_flags-instance_method" title="#dump_flags (instance method)">- (Object) <strong>dump_flags</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#encode64-instance_method" title="#encode64 (instance method)">- (Object) <strong>encode64</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#has_flag%3F-instance_method" title="#has_flag? (instance method)">- (Boolean) <strong>has_flag?</strong>(flag) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>self.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#head_size-instance_method" title="#head_size (instance method)">- (Object) <strong>head_size</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#serialize-instance_method" title="#serialize (instance method)">- (Object) <strong>serialize</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#set_flag-instance_method" title="#set_flag (instance method)">- (Object) <strong>set_flag</strong>(flag) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#size-instance_method" title="#size (instance method)">- (Object) <strong>size</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
    </ul>
  


  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods inherited from <span class='object_link'><a href="Base/FieldSet.html" title="Rex::Proto::NTLM::Base::FieldSet (class)">Base::FieldSet</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="Base/FieldSet.html#%5B%5D-instance_method" title="Rex::Proto::NTLM::Base::FieldSet#[] (method)">#[]</a></span>, <span class='object_link'><a href="Base/FieldSet.html#%5B%5D%3D-instance_method" title="Rex::Proto::NTLM::Base::FieldSet#[]= (method)">#[]=</a></span>, <span class='object_link'><a href="Base/FieldSet.html#define-class_method" title="Rex::Proto::NTLM::Base::FieldSet.define (method)">define</a></span>, <span class='object_link'><a href="Base/FieldSet.html#disable-instance_method" title="Rex::Proto::NTLM::Base::FieldSet#disable (method)">#disable</a></span>, <span class='object_link'><a href="Base/FieldSet.html#enable-instance_method" title="Rex::Proto::NTLM::Base::FieldSet#enable (method)">#enable</a></span>, <span class='object_link'><a href="Base/FieldSet.html#initialize-instance_method" title="Rex::Proto::NTLM::Base::FieldSet#initialize (method)">#initialize</a></span>, <span class='object_link'><a href="Base/FieldSet.html#int16LE-class_method" title="Rex::Proto::NTLM::Base::FieldSet.int16LE (method)">int16LE</a></span>, <span class='object_link'><a href="Base/FieldSet.html#int32LE-class_method" title="Rex::Proto::NTLM::Base::FieldSet.int32LE (method)">int32LE</a></span>, <span class='object_link'><a href="Base/FieldSet.html#int64LE-class_method" title="Rex::Proto::NTLM::Base::FieldSet.int64LE (method)">int64LE</a></span>, <span class='object_link'><a href="Base/FieldSet.html#names-class_method" title="Rex::Proto::NTLM::Base::FieldSet.names (method)">names</a></span>, <span class='object_link'><a href="Base/FieldSet.html#opts-class_method" title="Rex::Proto::NTLM::Base::FieldSet.opts (method)">opts</a></span>, <span class='object_link'><a href="Base/FieldSet.html#parse-instance_method" title="Rex::Proto::NTLM::Base::FieldSet#parse (method)">#parse</a></span>, <span class='object_link'><a href="Base/FieldSet.html#prototypes-class_method" title="Rex::Proto::NTLM::Base::FieldSet.prototypes (method)">prototypes</a></span>, <span class='object_link'><a href="Base/FieldSet.html#security_buffer-class_method" title="Rex::Proto::NTLM::Base::FieldSet.security_buffer (method)">security_buffer</a></span>, <span class='object_link'><a href="Base/FieldSet.html#string-class_method" title="Rex::Proto::NTLM::Base::FieldSet.string (method)">string</a></span>, <span class='object_link'><a href="Base/FieldSet.html#types-class_method" title="Rex::Proto::NTLM::Base::FieldSet.types (method)">types</a></span></p>
<div id="constructor_details" class="method_details_list">
  <h2>Constructor Details</h2>
  
    <p class="notice">This class inherits a constructor from <span class='object_link'><a href="Base/FieldSet.html#initialize-instance_method" title="Rex::Proto::NTLM::Base::FieldSet#initialize (method)">Rex::Proto::NTLM::Base::FieldSet</a></span></p>
  
</div>


  <div id="class_method_details" class="method_details_list">
    <h2>Class Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="decode64-class_method">
  
    + (<tt>Object</tt>) <strong>decode64</strong>(str) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


78
79
80</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/proto/ntlm/message.rb', line 78</span>

<span class='kw'>def</span> <span class='id identifier rubyid_decode64'>decode64</span><span class='lparen'>(</span><span class='id identifier rubyid_str'>str</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_parse'>parse</span><span class='lparen'>(</span><span class='const'>Rex</span><span class='op'>::</span><span class='const'>Text</span><span class='op'>::</span><span class='id identifier rubyid_decode_base64'>decode_base64</span><span class='lparen'>(</span><span class='id identifier rubyid_str'>str</span><span class='rparen'>)</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="downgrade_type_message-class_method">
  
    + (<tt>Object</tt>) <strong>downgrade_type_message</strong>(message) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Downgrading Type messages to LMv1/NTLMv1 and removing signing</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


490
491
492
493
494
495
496
497
498
499
500
501
502
503
504
505
506
507
508
509
510
511
512
513
514
515
516
517
518
519
520
521
522
523
524
525
526
527
528
529</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/proto/ntlm/message.rb', line 490</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_downgrade_type_message'>downgrade_type_message</span><span class='lparen'>(</span><span class='id identifier rubyid_message'>message</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_decode'>decode</span> <span class='op'>=</span> <span class='const'>Rex</span><span class='op'>::</span><span class='const'>Text</span><span class='period'>.</span><span class='id identifier rubyid_decode_base64'>decode_base64</span><span class='lparen'>(</span><span class='id identifier rubyid_message'>message</span><span class='period'>.</span><span class='id identifier rubyid_strip'>strip</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_type'>type</span> <span class='op'>=</span> <span class='id identifier rubyid_decode'>decode</span><span class='lbracket'>[</span><span class='int'>8</span><span class='comma'>,</span><span class='int'>1</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_unpack'>unpack</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>C</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>

  <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_type'>type</span> <span class='op'>&gt;</span> <span class='int'>0</span> <span class='kw'>and</span> <span class='id identifier rubyid_type'>type</span> <span class='op'>&lt;</span> <span class='int'>4</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_reqflags'>reqflags</span> <span class='op'>=</span> <span class='id identifier rubyid_decode'>decode</span><span class='lbracket'>[</span><span class='int'>12</span><span class='op'>..</span><span class='int'>15</span><span class='rbracket'>]</span> <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_type'>type</span> <span class='op'>==</span> <span class='int'>1</span> <span class='kw'>or</span> <span class='id identifier rubyid_type'>type</span> <span class='op'>==</span> <span class='int'>3</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_reqflags'>reqflags</span> <span class='op'>=</span> <span class='id identifier rubyid_decode'>decode</span><span class='lbracket'>[</span><span class='int'>20</span><span class='op'>..</span><span class='int'>23</span><span class='rbracket'>]</span> <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_type'>type</span> <span class='op'>==</span> <span class='int'>2</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_reqflags'>reqflags</span> <span class='op'>=</span> <span class='id identifier rubyid_reqflags'>reqflags</span><span class='period'>.</span><span class='id identifier rubyid_unpack'>unpack</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>V</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>

    <span class='comment'># Remove NEGOTIATE_NTLMV2_KEY and NEGOTIATE_ALWAYS_SIGN, this lowers the negotiation
</span>    <span class='comment'># down to LMv1/NTLMv1.
</span>    <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_reqflags'>reqflags</span> <span class='op'>&amp;</span> <span class='const'>CONST</span><span class='op'>::</span><span class='const'>NEGOTIATE_NTLM2_KEY</span><span class='rparen'>)</span> <span class='op'>==</span> <span class='const'>CONST</span><span class='op'>::</span><span class='const'>NEGOTIATE_NTLM2_KEY</span>
      <span class='id identifier rubyid_reqflags'>reqflags</span> <span class='op'>=</span> <span class='id identifier rubyid_reqflags'>reqflags</span> <span class='op'>-</span> <span class='const'>CONST</span><span class='op'>::</span><span class='const'>NEGOTIATE_NTLM2_KEY</span>
    <span class='kw'>end</span>
    <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_reqflags'>reqflags</span> <span class='op'>&amp;</span> <span class='const'>CONST</span><span class='op'>::</span><span class='const'>NEGOTIATE_ALWAYS_SIGN</span><span class='rparen'>)</span> <span class='op'>==</span> <span class='const'>CONST</span><span class='op'>::</span><span class='const'>NEGOTIATE_ALWAYS_SIGN</span>
      <span class='id identifier rubyid_reqflags'>reqflags</span> <span class='op'>=</span> <span class='id identifier rubyid_reqflags'>reqflags</span> <span class='op'>-</span> <span class='const'>CONST</span><span class='op'>::</span><span class='const'>NEGOTIATE_ALWAYS_SIGN</span>
    <span class='kw'>end</span>

    <span class='comment'># Return the flags back to the decode so we can base64 it again
</span>    <span class='id identifier rubyid_flags'>flags</span> <span class='op'>=</span> <span class='id identifier rubyid_reqflags'>reqflags</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='lparen'>(</span><span class='int'>16</span><span class='rparen'>)</span>
    <span class='int'>0</span><span class='period'>.</span><span class='id identifier rubyid_upto'>upto</span><span class='lparen'>(</span><span class='int'>8</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_idx'>idx</span><span class='op'>|</span>
      <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_idx'>idx</span> <span class='op'>&gt;</span> <span class='id identifier rubyid_flags'>flags</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span><span class='rparen'>)</span>
        <span class='id identifier rubyid_flags'>flags</span><span class='period'>.</span><span class='id identifier rubyid_insert'>insert</span><span class='lparen'>(</span><span class='int'>0</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>0</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>

    <span class='id identifier rubyid_idx'>idx</span> <span class='op'>=</span> <span class='int'>0</span>
    <span class='int'>0</span><span class='period'>.</span><span class='id identifier rubyid_upto'>upto</span><span class='lparen'>(</span><span class='int'>3</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_cnt'>cnt</span><span class='op'>|</span>
      <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_type'>type</span> <span class='op'>==</span> <span class='int'>2</span><span class='rparen'>)</span>
        <span class='id identifier rubyid_decode'>decode</span><span class='lbracket'>[</span><span class='int'>23</span><span class='op'>-</span><span class='id identifier rubyid_cnt'>cnt</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='id identifier rubyid_flags'>flags</span><span class='lbracket'>[</span><span class='id identifier rubyid_idx'>idx</span><span class='comma'>,</span><span class='int'>1</span><span class='rbracket'>]</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_pack'>pack</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>C</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
      <span class='kw'>else</span>
        <span class='id identifier rubyid_decode'>decode</span><span class='lbracket'>[</span><span class='int'>15</span><span class='op'>-</span><span class='id identifier rubyid_cnt'>cnt</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='id identifier rubyid_flags'>flags</span><span class='lbracket'>[</span><span class='id identifier rubyid_idx'>idx</span><span class='comma'>,</span><span class='int'>1</span><span class='rbracket'>]</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_pack'>pack</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>C</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
      <span class='kw'>end</span>
      <span class='id identifier rubyid_idx'>idx</span> <span class='op'>+=</span> <span class='int'>2</span>
    <span class='kw'>end</span>

  <span class='kw'>end</span>
  <span class='kw'>return</span> <span class='const'>Rex</span><span class='op'>::</span><span class='const'>Text</span><span class='period'>.</span><span class='id identifier rubyid_encode_base64'>encode_base64</span><span class='lparen'>(</span><span class='id identifier rubyid_decode'>decode</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_delete'>delete</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\n</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='comment'># base64 encode and remove the returns
</span><span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="parse-class_method">
  
    + (<tt>Object</tt>) <strong>parse</strong>(str) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


62
63
64
65
66
67
68
69
70
71
72
73
74
75
76</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/proto/ntlm/message.rb', line 62</span>

<span class='kw'>def</span> <span class='id identifier rubyid_parse'>parse</span><span class='lparen'>(</span><span class='id identifier rubyid_str'>str</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_m'>m</span> <span class='op'>=</span> <span class='const'>Type0</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
  <span class='id identifier rubyid_m'>m</span><span class='period'>.</span><span class='id identifier rubyid_parse'>parse</span><span class='lparen'>(</span><span class='id identifier rubyid_str'>str</span><span class='rparen'>)</span>
  <span class='kw'>case</span> <span class='id identifier rubyid_m'>m</span><span class='period'>.</span><span class='id identifier rubyid_type'>type</span>
  <span class='kw'>when</span> <span class='int'>1</span>
    <span class='id identifier rubyid_t'>t</span> <span class='op'>=</span> <span class='const'>Type1</span><span class='period'>.</span><span class='id identifier rubyid_parse'>parse</span><span class='lparen'>(</span><span class='id identifier rubyid_str'>str</span><span class='rparen'>)</span>
  <span class='kw'>when</span> <span class='int'>2</span>
    <span class='id identifier rubyid_t'>t</span> <span class='op'>=</span> <span class='const'>Type2</span><span class='period'>.</span><span class='id identifier rubyid_parse'>parse</span><span class='lparen'>(</span><span class='id identifier rubyid_str'>str</span><span class='rparen'>)</span>
  <span class='kw'>when</span> <span class='int'>3</span>
    <span class='id identifier rubyid_t'>t</span> <span class='op'>=</span> <span class='const'>Type3</span><span class='period'>.</span><span class='id identifier rubyid_parse'>parse</span><span class='lparen'>(</span><span class='id identifier rubyid_str'>str</span><span class='rparen'>)</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>unknown type: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_m'>m</span><span class='period'>.</span><span class='id identifier rubyid_type'>type</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_t'>t</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="process_type1_message-class_method">
  
    + (<tt>Object</tt>) <strong>process_type1_message</strong>(message, nonce = &quot;\x11\x22\x33\x44\x55\x66\x77\x88&quot;, win_domain = &#39;DOMAIN&#39;, win_name = &#39;SERVER&#39;, dns_name = &#39;server&#39;, dns_domain = &#39;example.com&#39;, downgrade = true) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Process Type 1 NTLM Messages, return a Base64 Type 2 Message</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


400
401
402
403
404
405
406
407
408
409
410
411
412
413
414
415
416
417
418
419
420
421
422
423
424
425
426
427
428
429
430
431
432
433
434
435
436
437
438
439
440
441
442
443
444
445
446
447
448
449
450
451
452
453
454
455
456
457
458
459
460
461
462
463
464
465
466
467
468
469
470
471
472
473
474
475
476
477
478
479
480
481
482
483
484
485</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/proto/ntlm/message.rb', line 400</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_process_type1_message'>process_type1_message</span><span class='lparen'>(</span><span class='id identifier rubyid_message'>message</span><span class='comma'>,</span> <span class='id identifier rubyid_nonce'>nonce</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\x11\x22\x33\x44\x55\x66\x77\x88</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_win_domain'>win_domain</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>DOMAIN</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
        <span class='id identifier rubyid_win_name'>win_name</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>SERVER</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_dns_name'>dns_name</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>server</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_dns_domain'>dns_domain</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>example.com</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_downgrade'>downgrade</span> <span class='op'>=</span> <span class='kw'>true</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_dns_name'>dns_name</span> <span class='op'>=</span> <span class='const'>Rex</span><span class='op'>::</span><span class='const'>Text</span><span class='period'>.</span><span class='id identifier rubyid_to_unicode'>to_unicode</span><span class='lparen'>(</span><span class='id identifier rubyid_dns_name'>dns_name</span> <span class='op'>+</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>.</span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span> <span class='id identifier rubyid_dns_domain'>dns_domain</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_win_domain'>win_domain</span> <span class='op'>=</span> <span class='const'>Rex</span><span class='op'>::</span><span class='const'>Text</span><span class='period'>.</span><span class='id identifier rubyid_to_unicode'>to_unicode</span><span class='lparen'>(</span><span class='id identifier rubyid_win_domain'>win_domain</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_dns_domain'>dns_domain</span> <span class='op'>=</span> <span class='const'>Rex</span><span class='op'>::</span><span class='const'>Text</span><span class='period'>.</span><span class='id identifier rubyid_to_unicode'>to_unicode</span><span class='lparen'>(</span><span class='id identifier rubyid_dns_domain'>dns_domain</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_win_name'>win_name</span> <span class='op'>=</span> <span class='const'>Rex</span><span class='op'>::</span><span class='const'>Text</span><span class='period'>.</span><span class='id identifier rubyid_to_unicode'>to_unicode</span><span class='lparen'>(</span><span class='id identifier rubyid_win_name'>win_name</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_decode'>decode</span> <span class='op'>=</span> <span class='const'>Rex</span><span class='op'>::</span><span class='const'>Text</span><span class='period'>.</span><span class='id identifier rubyid_decode_base64'>decode_base64</span><span class='lparen'>(</span><span class='id identifier rubyid_message'>message</span><span class='period'>.</span><span class='id identifier rubyid_strip'>strip</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_type'>type</span> <span class='op'>=</span> <span class='id identifier rubyid_decode'>decode</span><span class='lbracket'>[</span><span class='int'>8</span><span class='comma'>,</span><span class='int'>1</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_unpack'>unpack</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>C</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>

  <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_type'>type</span> <span class='op'>==</span> <span class='int'>1</span><span class='rparen'>)</span>
    <span class='comment'># A type 1 message has been received, lets build a type 2 message response
</span>
    <span class='id identifier rubyid_reqflags'>reqflags</span> <span class='op'>=</span> <span class='id identifier rubyid_decode'>decode</span><span class='lbracket'>[</span><span class='int'>12</span><span class='comma'>,</span><span class='int'>4</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_reqflags'>reqflags</span> <span class='op'>=</span> <span class='id identifier rubyid_reqflags'>reqflags</span><span class='period'>.</span><span class='id identifier rubyid_unpack'>unpack</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>V</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>

    <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_reqflags'>reqflags</span> <span class='op'>&amp;</span> <span class='const'>CONST</span><span class='op'>::</span><span class='const'>REQUEST_TARGET</span><span class='rparen'>)</span> <span class='op'>==</span> <span class='const'>CONST</span><span class='op'>::</span><span class='const'>REQUEST_TARGET</span>

      <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_downgrade'>downgrade</span><span class='rparen'>)</span>
        <span class='comment'># At this time NTLMv2 and signing requirements are not supported
</span>        <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_reqflags'>reqflags</span> <span class='op'>&amp;</span> <span class='const'>CONST</span><span class='op'>::</span><span class='const'>NEGOTIATE_NTLM2_KEY</span><span class='rparen'>)</span> <span class='op'>==</span> <span class='const'>CONST</span><span class='op'>::</span><span class='const'>NEGOTIATE_NTLM2_KEY</span>
          <span class='id identifier rubyid_reqflags'>reqflags</span> <span class='op'>=</span> <span class='id identifier rubyid_reqflags'>reqflags</span> <span class='op'>-</span> <span class='const'>CONST</span><span class='op'>::</span><span class='const'>NEGOTIATE_NTLM2_KEY</span>
        <span class='kw'>end</span>
        <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_reqflags'>reqflags</span> <span class='op'>&amp;</span> <span class='const'>CONST</span><span class='op'>::</span><span class='const'>NEGOTIATE_ALWAYS_SIGN</span><span class='rparen'>)</span> <span class='op'>==</span> <span class='const'>CONST</span><span class='op'>::</span><span class='const'>NEGOTIATE_ALWAYS_SIGN</span>
          <span class='id identifier rubyid_reqflags'>reqflags</span> <span class='op'>=</span> <span class='id identifier rubyid_reqflags'>reqflags</span> <span class='op'>-</span> <span class='const'>CONST</span><span class='op'>::</span><span class='const'>NEGOTIATE_ALWAYS_SIGN</span>
        <span class='kw'>end</span>
      <span class='kw'>end</span>

      <span class='id identifier rubyid_flags'>flags</span> <span class='op'>=</span> <span class='id identifier rubyid_reqflags'>reqflags</span> <span class='op'>+</span> <span class='const'>CONST</span><span class='op'>::</span><span class='const'>TARGET_TYPE_DOMAIN</span> <span class='op'>+</span> <span class='const'>CONST</span><span class='op'>::</span><span class='const'>TARGET_TYPE_SERVER</span>
      <span class='id identifier rubyid_tid'>tid</span> <span class='op'>=</span> <span class='kw'>true</span>

      <span class='id identifier rubyid_tidoffset'>tidoffset</span> <span class='op'>=</span> <span class='int'>48</span> <span class='op'>+</span> <span class='id identifier rubyid_win_domain'>win_domain</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span>
      <span class='id identifier rubyid_tidbuff'>tidbuff</span> <span class='op'>=</span>
        <span class='lbracket'>[</span><span class='int'>2</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_pack'>pack</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>v</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='op'>+</span>				<span class='comment'># tid type, win domain
</span>        <span class='lbracket'>[</span><span class='id identifier rubyid_win_domain'>win_domain</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_pack'>pack</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>v</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='op'>+</span>
        <span class='id identifier rubyid_win_domain'>win_domain</span> <span class='op'>+</span>
        <span class='lbracket'>[</span><span class='int'>1</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_pack'>pack</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>v</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='op'>+</span>				<span class='comment'># tid type, server name
</span>        <span class='lbracket'>[</span><span class='id identifier rubyid_win_name'>win_name</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_pack'>pack</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>v</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='op'>+</span>
        <span class='id identifier rubyid_win_name'>win_name</span> <span class='op'>+</span>
        <span class='lbracket'>[</span><span class='int'>4</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_pack'>pack</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>v</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>	<span class='op'>+</span>			 <span class='comment'># tid type, domain name
</span>        <span class='lbracket'>[</span><span class='id identifier rubyid_dns_domain'>dns_domain</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_pack'>pack</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>v</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='op'>+</span>
        <span class='id identifier rubyid_dns_domain'>dns_domain</span> <span class='op'>+</span>
        <span class='lbracket'>[</span><span class='int'>3</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_pack'>pack</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>v</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>	<span class='op'>+</span>			<span class='comment'># tid type, dns_name
</span>        <span class='lbracket'>[</span><span class='id identifier rubyid_dns_name'>dns_name</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_pack'>pack</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>v</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='op'>+</span>
        <span class='id identifier rubyid_dns_name'>dns_name</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_flags'>flags</span> <span class='op'>=</span> <span class='const'>CONST</span><span class='op'>::</span><span class='const'>NEGOTIATE_UNICODE</span> <span class='op'>+</span> <span class='const'>CONST</span><span class='op'>::</span><span class='const'>NEGOTIATE_NTLM</span>
      <span class='id identifier rubyid_tid'>tid</span> <span class='op'>=</span> <span class='kw'>false</span>
    <span class='kw'>end</span>

    <span class='id identifier rubyid_type2msg'>type2msg</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>NTLMSSP\0</span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span> <span class='comment'># protocol, 8 bytes
</span>         <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\x02\x00\x00\x00</span><span class='tstring_end'>&quot;</span></span>		<span class='comment'># type, 4 bytes
</span>
    <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_tid'>tid</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_type2msg'>type2msg</span> <span class='op'>+=</span>	<span class='comment'># Target security info, 8 bytes. Filled if REQUEST_TARGET
</span>      <span class='lbracket'>[</span><span class='id identifier rubyid_win_domain'>win_domain</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_pack'>pack</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>v</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='op'>+</span>	 <span class='comment'># Length, 2 bytes
</span>      <span class='lbracket'>[</span><span class='id identifier rubyid_win_domain'>win_domain</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_pack'>pack</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>v</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>	 <span class='comment'># Allocated space, 2 bytes
</span>    <span class='kw'>end</span>

    <span class='id identifier rubyid_type2msg'>type2msg</span> <span class='op'>+=</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\x30\x00\x00\x00</span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span> <span class='comment'>#		Offset, 4 bytes
</span>        <span class='lbracket'>[</span><span class='id identifier rubyid_flags'>flags</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_pack'>pack</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>V</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='op'>+</span>	<span class='comment'># flags, 4 bytes
</span>        <span class='id identifier rubyid_nonce'>nonce</span> <span class='op'>+</span>		<span class='comment'># the nonce, 8 bytes
</span>        <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\x00</span><span class='tstring_end'>&quot;</span></span> <span class='op'>*</span> <span class='int'>8</span>		<span class='comment'># Context (all 0s), 8 bytes
</span>
    <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_tid'>tid</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_type2msg'>type2msg</span> <span class='op'>+=</span>		<span class='comment'># Target information security buffer. Filled if REQUEST_TARGET
</span>        <span class='lbracket'>[</span><span class='id identifier rubyid_tidbuff'>tidbuff</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_pack'>pack</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>v</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='op'>+</span>	<span class='comment'># Length, 2 bytes
</span>        <span class='lbracket'>[</span><span class='id identifier rubyid_tidbuff'>tidbuff</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_pack'>pack</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>v</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='op'>+</span>	<span class='comment'># Allocated space, 2 bytes
</span>        <span class='lbracket'>[</span><span class='id identifier rubyid_tidoffset'>tidoffset</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_pack'>pack</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>V</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='op'>+</span>		<span class='comment'># Offset, 4 bytes (usually \x48 + length of win_domain)
</span>        <span class='id identifier rubyid_win_domain'>win_domain</span> <span class='op'>+</span>			<span class='comment'># Target name data (domain in unicode if REQUEST_UNICODE)
</span>                <span class='comment'># Target information data
</span>        <span class='id identifier rubyid_tidbuff'>tidbuff</span> <span class='op'>+</span>			<span class='comment'>#	Type, 2 bytes
</span>                <span class='comment'>#	Length, 2 bytes
</span>                <span class='comment'>#	Data (in unicode if REQUEST_UNICODE)
</span>        <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\x00\x00\x00\x00</span><span class='tstring_end'>&quot;</span></span>		<span class='comment'># Terminator, 4 bytes, all \x00
</span>    <span class='kw'>end</span>

    <span class='id identifier rubyid_type2msg'>type2msg</span> <span class='op'>=</span> <span class='const'>Rex</span><span class='op'>::</span><span class='const'>Text</span><span class='period'>.</span><span class='id identifier rubyid_encode_base64'>encode_base64</span><span class='lparen'>(</span><span class='id identifier rubyid_type2msg'>type2msg</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_delete'>delete</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\n</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='comment'># base64 encode and remove the returns
</span>  <span class='kw'>else</span>
    <span class='comment'># This is not a Type2 message
</span>    <span class='id identifier rubyid_type2msg'>type2msg</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>

  <span class='kw'>return</span> <span class='id identifier rubyid_type2msg'>type2msg</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="process_type3_message-class_method">
  
    + (<tt>Object</tt>) <strong>process_type3_message</strong>(message) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Process Type 3 NTLM Message (in Base64)</p>

<p>from <a
href="http://www.innovation.ch/personal/ronald/ntlm.html">www.innovation.ch/personal/ronald/ntlm.html</a></p>

<p>struct { 	byte  <a href="8">protocol</a>;  // &#39;N&#39;, &#39;T&#39;,
&#39;L&#39;, &#39;M&#39;, &#39;S&#39;, &#39;S&#39;, &#39;P&#39;,
&#39;0&#39; 	byte  type;         // 0x03 	byte  <a href="3">zero</a>;</p>

<p>short lm_resp_len;  // LanManager response length (always 0x18) 	short
lm_resp_len;  // LanManager response length (always 0x18) 	short
lm_resp_off;  // LanManager response offset 	byte  <a href="2">zero</a>;</p>

<p>short nt_resp_len;  // NT response length (always 0x18) 	short
nt_resp_len;  // NT response length (always 0x18) 	short nt_resp_off;  //
NT response offset 	byte  <a href="2">zero</a>;</p>

<p>short dom_len;      // domain string length 	short dom_len;      // domain
string length 	short dom_off;      // domain string offset (always 0x40)
	byte  <a href="2">zero</a>;</p>

<p>short user_len;     // username string length 	short user_len;     //
username string length 	short user_off;     // username string offset 	byte
<a href="2">zero</a>;</p>

<p>short host_len;     // host string length 	short host_len;     // host
string length 	short host_off;     // host string offset 	byte  <a
href="6">zero</a>;</p>

<p>short msg_len;      // message length 	byte  <a href="2">zero</a>;</p>

<p>short flags;        // 0x8201 	byte  <a href="2">zero</a>;</p>

<p>byte  <a href="*">dom</a>;       // domain string (unicode UTF-16LE) 	byte
<a href="*">user</a>;      // username string (unicode UTF-16LE) 	byte  <a
href="*">host</a>;      // host string (unicode UTF-16LE) 	byte  <a
href="*">lm_resp</a>;   // LanManager response 	byte  <a
href="*">nt_resp</a>;   // NT response } type_3_message</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


365
366
367
368
369
370
371
372
373
374
375
376
377
378
379
380
381
382
383
384
385
386
387
388
389
390
391
392
393</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/proto/ntlm/message.rb', line 365</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_process_type3_message'>process_type3_message</span><span class='lparen'>(</span><span class='id identifier rubyid_message'>message</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_decode'>decode</span> <span class='op'>=</span> <span class='const'>Rex</span><span class='op'>::</span><span class='const'>Text</span><span class='period'>.</span><span class='id identifier rubyid_decode_base64'>decode_base64</span><span class='lparen'>(</span><span class='id identifier rubyid_message'>message</span><span class='period'>.</span><span class='id identifier rubyid_strip'>strip</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_type'>type</span> <span class='op'>=</span> <span class='id identifier rubyid_decode'>decode</span><span class='lbracket'>[</span><span class='int'>8</span><span class='comma'>,</span><span class='int'>1</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_unpack'>unpack</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>C</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>
  <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_type'>type</span> <span class='op'>==</span> <span class='int'>3</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_lm_len'>lm_len</span> <span class='op'>=</span> <span class='id identifier rubyid_decode'>decode</span><span class='lbracket'>[</span><span class='int'>12</span><span class='comma'>,</span><span class='int'>2</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_unpack'>unpack</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>v</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>
    <span class='id identifier rubyid_lm_offset'>lm_offset</span> <span class='op'>=</span> <span class='id identifier rubyid_decode'>decode</span><span class='lbracket'>[</span><span class='int'>16</span><span class='comma'>,</span><span class='int'>2</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_unpack'>unpack</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>v</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>
    <span class='id identifier rubyid_lm'>lm</span> <span class='op'>=</span> <span class='id identifier rubyid_decode'>decode</span><span class='lbracket'>[</span><span class='id identifier rubyid_lm_offset'>lm_offset</span><span class='comma'>,</span> <span class='id identifier rubyid_lm_len'>lm_len</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_unpack'>unpack</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>H*</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>

    <span class='id identifier rubyid_nt_len'>nt_len</span> <span class='op'>=</span> <span class='id identifier rubyid_decode'>decode</span><span class='lbracket'>[</span><span class='int'>20</span><span class='comma'>,</span><span class='int'>2</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_unpack'>unpack</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>v</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>
    <span class='id identifier rubyid_nt_offset'>nt_offset</span> <span class='op'>=</span> <span class='id identifier rubyid_decode'>decode</span><span class='lbracket'>[</span><span class='int'>24</span><span class='comma'>,</span><span class='int'>2</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_unpack'>unpack</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>v</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>
    <span class='id identifier rubyid_nt'>nt</span> <span class='op'>=</span> <span class='id identifier rubyid_decode'>decode</span><span class='lbracket'>[</span><span class='id identifier rubyid_nt_offset'>nt_offset</span><span class='comma'>,</span> <span class='id identifier rubyid_nt_len'>nt_len</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_unpack'>unpack</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>H*</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>

    <span class='id identifier rubyid_dom_len'>dom_len</span> <span class='op'>=</span> <span class='id identifier rubyid_decode'>decode</span><span class='lbracket'>[</span><span class='int'>28</span><span class='comma'>,</span><span class='int'>2</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_unpack'>unpack</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>v</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>
    <span class='id identifier rubyid_dom_offset'>dom_offset</span> <span class='op'>=</span> <span class='id identifier rubyid_decode'>decode</span><span class='lbracket'>[</span><span class='int'>32</span><span class='comma'>,</span><span class='int'>2</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_unpack'>unpack</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>v</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>
    <span class='id identifier rubyid_domain'>domain</span> <span class='op'>=</span> <span class='id identifier rubyid_decode'>decode</span><span class='lbracket'>[</span><span class='id identifier rubyid_dom_offset'>dom_offset</span><span class='comma'>,</span> <span class='id identifier rubyid_dom_len'>dom_len</span><span class='rbracket'>]</span>

    <span class='id identifier rubyid_user_len'>user_len</span> <span class='op'>=</span> <span class='id identifier rubyid_decode'>decode</span><span class='lbracket'>[</span><span class='int'>36</span><span class='comma'>,</span><span class='int'>2</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_unpack'>unpack</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>v</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>
    <span class='id identifier rubyid_user_offset'>user_offset</span> <span class='op'>=</span> <span class='id identifier rubyid_decode'>decode</span><span class='lbracket'>[</span><span class='int'>40</span><span class='comma'>,</span><span class='int'>2</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_unpack'>unpack</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>v</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>
    <span class='id identifier rubyid_user'>user</span> <span class='op'>=</span> <span class='id identifier rubyid_decode'>decode</span><span class='lbracket'>[</span><span class='id identifier rubyid_user_offset'>user_offset</span><span class='comma'>,</span> <span class='id identifier rubyid_user_len'>user_len</span><span class='rbracket'>]</span>

    <span class='id identifier rubyid_host_len'>host_len</span> <span class='op'>=</span> <span class='id identifier rubyid_decode'>decode</span><span class='lbracket'>[</span><span class='int'>44</span><span class='comma'>,</span><span class='int'>2</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_unpack'>unpack</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>v</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>
    <span class='id identifier rubyid_host_offset'>host_offset</span> <span class='op'>=</span> <span class='id identifier rubyid_decode'>decode</span><span class='lbracket'>[</span><span class='int'>48</span><span class='comma'>,</span><span class='int'>2</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_unpack'>unpack</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>v</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>
    <span class='id identifier rubyid_host'>host</span> <span class='op'>=</span> <span class='id identifier rubyid_decode'>decode</span><span class='lbracket'>[</span><span class='id identifier rubyid_host_offset'>host_offset</span><span class='comma'>,</span> <span class='id identifier rubyid_host_len'>host_len</span><span class='rbracket'>]</span>

    <span class='kw'>return</span> <span class='id identifier rubyid_domain'>domain</span><span class='comma'>,</span> <span class='id identifier rubyid_user'>user</span><span class='comma'>,</span> <span class='id identifier rubyid_host'>host</span><span class='comma'>,</span> <span class='id identifier rubyid_lm'>lm</span><span class='comma'>,</span> <span class='id identifier rubyid_nt'>nt</span>
  <span class='kw'>else</span>
    <span class='kw'>return</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="data_size-instance_method">
  
    - (<tt>Object</tt>) <strong>data_size</strong> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


110
111
112</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/proto/ntlm/message.rb', line 110</span>

<span class='kw'>def</span> <span class='id identifier rubyid_data_size'>data_size</span>
  <span class='id identifier rubyid_security_buffers'>security_buffers</span><span class='period'>.</span><span class='id identifier rubyid_inject'>inject</span><span class='lparen'>(</span><span class='int'>0</span><span class='rparen'>)</span><span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_sum'>sum</span><span class='comma'>,</span> <span class='id identifier rubyid_a'>a</span><span class='op'>|</span> <span class='id identifier rubyid_sum'>sum</span> <span class='op'>+=</span> <span class='id identifier rubyid_a'>a</span><span class='lbracket'>[</span><span class='int'>1</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_data_size'>data_size</span><span class='rbrace'>}</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="decode64-instance_method">
  
    - (<tt>Object</tt>) <strong>decode64</strong>(str) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


104
105
106</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/proto/ntlm/message.rb', line 104</span>

<span class='kw'>def</span> <span class='id identifier rubyid_decode64'>decode64</span><span class='lparen'>(</span><span class='id identifier rubyid_str'>str</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_parse'>parse</span><span class='lparen'>(</span><span class='const'>Rex</span><span class='op'>::</span><span class='const'>Text</span><span class='op'>::</span><span class='id identifier rubyid_decode_base64'>decode_base64</span><span class='lparen'>(</span><span class='id identifier rubyid_str'>str</span><span class='rparen'>)</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="dump_flags-instance_method">
  
    - (<tt>Object</tt>) <strong>dump_flags</strong> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


91
92
93</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/proto/ntlm/message.rb', line 91</span>

<span class='kw'>def</span> <span class='id identifier rubyid_dump_flags'>dump_flags</span>
  <span class='const'>CONST</span><span class='op'>::</span><span class='const'>FLAG_KEYS</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span><span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_k'>k</span><span class='op'>|</span> <span class='id identifier rubyid_print'>print</span><span class='lparen'>(</span><span class='id identifier rubyid_k'>k</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>=</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_flag?'>flag?</span><span class='lparen'>(</span><span class='id identifier rubyid_k'>k</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\n</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='rbrace'>}</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="encode64-instance_method">
  
    - (<tt>Object</tt>) <strong>encode64</strong> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


100
101
102</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/proto/ntlm/message.rb', line 100</span>

<span class='kw'>def</span> <span class='id identifier rubyid_encode64'>encode64</span>
  <span class='const'>Rex</span><span class='op'>::</span><span class='const'>Text</span><span class='op'>::</span><span class='id identifier rubyid_encode_base64'>encode_base64</span><span class='lparen'>(</span><span class='id identifier rubyid_serialize'>serialize</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="has_flag?-instance_method">
  
    - (<tt>Boolean</tt>) <strong>has_flag?</strong>(flag) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>self</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


83
84
85</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/proto/ntlm/message.rb', line 83</span>

<span class='kw'>def</span> <span class='id identifier rubyid_has_flag?'>has_flag?</span><span class='lparen'>(</span><span class='id identifier rubyid_flag'>flag</span><span class='rparen'>)</span>
  <span class='lparen'>(</span><span class='kw'>self</span><span class='lbracket'>[</span><span class='symbol'>:flag</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_value'>value</span> <span class='op'>&amp;</span> <span class='const'>CONST</span><span class='op'>::</span><span class='const'>FLAGS</span><span class='lbracket'>[</span><span class='id identifier rubyid_flag'>flag</span><span class='rbracket'>]</span><span class='rparen'>)</span> <span class='op'>==</span> <span class='const'>CONST</span><span class='op'>::</span><span class='const'>FLAGS</span><span class='lbracket'>[</span><span class='id identifier rubyid_flag'>flag</span><span class='rbracket'>]</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="head_size-instance_method">
  
    - (<tt>Object</tt>) <strong>head_size</strong> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


108</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/proto/ntlm/message.rb', line 108</span>

<span class='kw'>alias</span> <span class='id identifier rubyid_head_size'>head_size</span> <span class='id identifier rubyid_size'>size</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="serialize-instance_method">
  
    - (<tt>Object</tt>) <strong>serialize</strong> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


95
96
97
98</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/proto/ntlm/message.rb', line 95</span>

<span class='kw'>def</span> <span class='id identifier rubyid_serialize'>serialize</span>
  <span class='id identifier rubyid_deflag'>deflag</span>
  <span class='kw'>super</span> <span class='op'>+</span> <span class='id identifier rubyid_security_buffers'>security_buffers</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_n'>n</span><span class='comma'>,</span> <span class='id identifier rubyid_f'>f</span><span class='op'>|</span> <span class='id identifier rubyid_f'>f</span><span class='period'>.</span><span class='id identifier rubyid_value'>value</span><span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="set_flag-instance_method">
  
    - (<tt>Object</tt>) <strong>set_flag</strong>(flag) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


87
88
89</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/proto/ntlm/message.rb', line 87</span>

<span class='kw'>def</span> <span class='id identifier rubyid_set_flag'>set_flag</span><span class='lparen'>(</span><span class='id identifier rubyid_flag'>flag</span><span class='rparen'>)</span>
  <span class='kw'>self</span><span class='lbracket'>[</span><span class='symbol'>:flag</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_value'>value</span>  <span class='op'>|=</span> <span class='const'>CONST</span><span class='op'>::</span><span class='const'>FLAGS</span><span class='lbracket'>[</span><span class='id identifier rubyid_flag'>flag</span><span class='rbracket'>]</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="size-instance_method">
  
    - (<tt>Object</tt>) <strong>size</strong> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


114
115
116</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/proto/ntlm/message.rb', line 114</span>

<span class='kw'>def</span> <span class='id identifier rubyid_size'>size</span>
  <span class='id identifier rubyid_head_size'>head_size</span> <span class='op'>+</span> <span class='id identifier rubyid_data_size'>data_size</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

    <div id="footer">
  Generated on Tue Jan 19 22:37:21 2016 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.8.7.6 (ruby-2.1.7).
</div>

  </body>
</html>