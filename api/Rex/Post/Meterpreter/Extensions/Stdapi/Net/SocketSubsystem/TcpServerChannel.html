<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>
  Class: Rex::Post::Meterpreter::Extensions::Stdapi::Net::SocketSubsystem::TcpServerChannel
  
    &mdash; Documentation by YARD 0.8.7.6
  
</title>

  <link rel="stylesheet" href="../../../../../../../css/style.css" type="text/css" charset="utf-8" />

  <link rel="stylesheet" href="../../../../../../../css/common.css" type="text/css" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  hasFrames = window.top.frames.main ? true : false;
  relpath = '../../../../../../../';
  framesUrl = "../../../../../../../frames.html#!Rex/Post/Meterpreter/Extensions/Stdapi/Net/SocketSubsystem/TcpServerChannel.html";
</script>


  <script type="text/javascript" charset="utf-8" src="../../../../../../../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../../../../../../../js/app.js"></script>


  </head>
  <body>
    <div id="header">
      <div id="menu">
  
    <a href="../../../../../../../_index.html">Index (T)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../../../../../../../Rex.html" title="Rex (module)">Rex</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../../../../../../Post.html" title="Rex::Post (module)">Post</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../../../../../Meterpreter.html" title="Rex::Post::Meterpreter (module)">Meterpreter</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../../../../Extensions.html" title="Rex::Post::Meterpreter::Extensions (module)">Extensions</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../../../Stdapi.html" title="Rex::Post::Meterpreter::Extensions::Stdapi (module)">Stdapi</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../../Net.html" title="Rex::Post::Meterpreter::Extensions::Stdapi::Net (module)">Net</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../SocketSubsystem.html" title="Rex::Post::Meterpreter::Extensions::Stdapi::Net::SocketSubsystem (module)">SocketSubsystem</a></span></span>
     &raquo; 
    <span class="title">TcpServerChannel</span>
  

  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../../../../../../../class_list.html">
      Class List
    </a>
  
    <a class="full_list_link" id="method_list_link"
        href="../../../../../../../method_list.html">
      Method List
    </a>
  
    <a class="full_list_link" id="file_list_link"
        href="../../../../../../../file_list.html">
      File List
    </a>
  
</div>
      <div class="clear"></div>
    </div>

    <iframe id="search_frame"></iframe>

    <div id="content"><h1>Class: Rex::Post::Meterpreter::Extensions::Stdapi::Net::SocketSubsystem::TcpServerChannel
  
  
  
</h1>

<dl class="box">
  
    <dt class="r1">Inherits:</dt>
    <dd class="r1">
      <span class="inheritName"><span class='object_link'><a href="../../../../Channel.html" title="Rex::Post::Meterpreter::Channel (class)">Channel</a></span></span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next"><span class='object_link'><a href="../../../../Channel.html" title="Rex::Post::Meterpreter::Channel (class)">Channel</a></span></li>
          
            <li class="next">Rex::Post::Meterpreter::Extensions::Stdapi::Net::SocketSubsystem::TcpServerChannel</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
      </dd>
    
  
  
    
  
    
  
  
  
    <dt class="r2 last">Defined in:</dt>
    <dd class="r2 last">lib/rex/post/meterpreter/extensions/stdapi/net/socket_subsystem/tcp_server_channel.rb</dd>
  
</dl>
<div class="clear"></div>


  <h2>Constant Summary</h2>
  
    <dl class="constants">
      
        <dt id="server_channels-classvariable" class="">@@server_channels =
          <div class="docstring">
  <div class="discussion">
    
<p>This is a class variable to store all pending client tcp connections which
have not been passed off via a call to the respective server tcp channels
accept method. The dictionary key is the tcp server channel instance and
the values held are an array of pending tcp client channels connected to
the tcp server channel.</p>


  </div>
</div>
<div class="tags">
  

</div>
        </dt>
        <dd><pre class="code"><span class='lbrace'>{</span><span class='rbrace'>}</span></pre></dd>
      
    </dl>
  






  <h2>Instance Attribute Summary</h2>
  
  <h3 class="inherited">Attributes inherited from <span class='object_link'><a href="../../../../Channel.html" title="Rex::Post::Meterpreter::Channel (class)">Channel</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="../../../../Channel.html#cid-instance_method" title="Rex::Post::Meterpreter::Channel#cid (method)">#cid</a></span>, <span class='object_link'><a href="../../../../Channel.html#client-instance_method" title="Rex::Post::Meterpreter::Channel#client (method)">#client</a></span>, <span class='object_link'><a href="../../../../Channel.html#cls-instance_method" title="Rex::Post::Meterpreter::Channel#cls (method)">#cls</a></span>, <span class='object_link'><a href="../../../../Channel.html#flags-instance_method" title="Rex::Post::Meterpreter::Channel#flags (method)">#flags</a></span>, <span class='object_link'><a href="../../../../Channel.html#params-instance_method" title="Rex::Post::Meterpreter::Channel#params (method)">#params</a></span>, <span class='object_link'><a href="../../../../Channel.html#type-instance_method" title="Rex::Post::Meterpreter::Channel#type (method)">#type</a></span></p>


  
    <h2>
      Class Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#cls-class_method" title="cls (class method)">+ (Object) <strong>cls</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#open-class_method" title="open (class method)">+ (Channel) <strong>open</strong>(client, params) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Open a new tcp server channel on the remote end.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#request_handler-class_method" title="request_handler (class method)">+ (Object) <strong>request_handler</strong>(client, packet) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>This is the request handler which is registered to the respective
meterpreter instance via
Rex::Post::Meterpreter::Extensions::Stdapi::Net::Socket.</p>
</div></span>
  
</li>

      
    </ul>
  
    <h2>
      Instance Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="protected ">
  <span class="summary_signature">
    
      <a href="#_accept-instance_method" title="#_accept (instance method)">- (Object) <strong>_accept</strong>(nonblock = false) </a>
    

    
  </span>
  
  
  
  <span class="note title protected">protected</span>
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#accept-instance_method" title="#accept (instance method)">- (Object) <strong>accept</strong>(opts = {}) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Accept a new tcp client connection form this tcp server channel.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#accept_nonblock-instance_method" title="#accept_nonblock (instance method)">- (Object) <strong>accept_nonblock</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Accept a new tcp client connection form this tcp server channel.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#initialize-instance_method" title="#initialize (instance method)">- (TcpServerChannel) <strong>initialize</strong>(client, cid, type, flags) </a>
    

    
  </span>
  
  
    <span class="note title constructor">constructor</span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Simply initilize this instance.</p>
</div></span>
  
</li>

      
    </ul>
  


  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods inherited from <span class='object_link'><a href="../../../../Channel.html" title="Rex::Post::Meterpreter::Channel (class)">Channel</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="../../../../Channel.html#_close-instance_method" title="Rex::Post::Meterpreter::Channel#_close (method)">#_close</a></span>, <span class='object_link'><a href="../../../../Channel.html#_close-class_method" title="Rex::Post::Meterpreter::Channel._close (method)">_close</a></span>, <span class='object_link'><a href="../../../../Channel.html#_read-instance_method" title="Rex::Post::Meterpreter::Channel#_read (method)">#_read</a></span>, <span class='object_link'><a href="../../../../Channel.html#_write-instance_method" title="Rex::Post::Meterpreter::Channel#_write (method)">#_write</a></span>, <span class='object_link'><a href="../../../../Channel.html#cleanup-instance_method" title="Rex::Post::Meterpreter::Channel#cleanup (method)">#cleanup</a></span>, <span class='object_link'><a href="../../../../Channel.html#close-instance_method" title="Rex::Post::Meterpreter::Channel#close (method)">#close</a></span>, <span class='object_link'><a href="../../../../Channel.html#close_read-instance_method" title="Rex::Post::Meterpreter::Channel#close_read (method)">#close_read</a></span>, <span class='object_link'><a href="../../../../Channel.html#close_write-instance_method" title="Rex::Post::Meterpreter::Channel#close_write (method)">#close_write</a></span>, <span class='object_link'><a href="../../../../Channel.html#create-class_method" title="Rex::Post::Meterpreter::Channel.create (method)">create</a></span>, <span class='object_link'><a href="../../../../Channel.html#dio_close_handler-instance_method" title="Rex::Post::Meterpreter::Channel#dio_close_handler (method)">#dio_close_handler</a></span>, <span class='object_link'><a href="../../../../Channel.html#dio_handler-instance_method" title="Rex::Post::Meterpreter::Channel#dio_handler (method)">#dio_handler</a></span>, <span class='object_link'><a href="../../../../Channel.html#dio_map-instance_method" title="Rex::Post::Meterpreter::Channel#dio_map (method)">#dio_map</a></span>, <span class='object_link'><a href="../../../../Channel.html#dio_read_handler-instance_method" title="Rex::Post::Meterpreter::Channel#dio_read_handler (method)">#dio_read_handler</a></span>, <span class='object_link'><a href="../../../../Channel.html#dio_write_handler-instance_method" title="Rex::Post::Meterpreter::Channel#dio_write_handler (method)">#dio_write_handler</a></span>, <span class='object_link'><a href="../../../../Channel.html#finalize-class_method" title="Rex::Post::Meterpreter::Channel.finalize (method)">finalize</a></span>, <span class='object_link'><a href="../../../../Channel.html#flag%3F-instance_method" title="Rex::Post::Meterpreter::Channel#flag? (method)">#flag?</a></span>, <span class='object_link'><a href="../../../../Channel.html#interactive-instance_method" title="Rex::Post::Meterpreter::Channel#interactive (method)">#interactive</a></span>, <span class='object_link'><a href="../../../../Channel.html#read-instance_method" title="Rex::Post::Meterpreter::Channel#read (method)">#read</a></span>, <span class='object_link'><a href="../../../../Channel.html#synchronous%3F-instance_method" title="Rex::Post::Meterpreter::Channel#synchronous? (method)">#synchronous?</a></span>, <span class='object_link'><a href="../../../../Channel.html#write-instance_method" title="Rex::Post::Meterpreter::Channel#write (method)">#write</a></span></p>

  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="../../../../InboundPacketHandler.html" title="Rex::Post::Meterpreter::InboundPacketHandler (module)">InboundPacketHandler</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="../../../../InboundPacketHandler.html#request_handler-instance_method" title="Rex::Post::Meterpreter::InboundPacketHandler#request_handler (method)">#request_handler</a></span>, <span class='object_link'><a href="../../../../InboundPacketHandler.html#response_handler-instance_method" title="Rex::Post::Meterpreter::InboundPacketHandler#response_handler (method)">#response_handler</a></span></p>
<div id="constructor_details" class="method_details_list">
  <h2>Constructor Details</h2>
  
    <div class="method_details first">
  <h3 class="signature first" id="initialize-instance_method">
  
    - (<tt><span class='object_link'><a href="" title="Rex::Post::Meterpreter::Extensions::Stdapi::Net::SocketSubsystem::TcpServerChannel (class)">TcpServerChannel</a></span></tt>) <strong>initialize</strong>(client, cid, type, flags) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Simply initilize this instance.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


98
99
100
101
102</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/post/meterpreter/extensions/stdapi/net/socket_subsystem/tcp_server_channel.rb', line 98</span>

<span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span><span class='lparen'>(</span><span class='id identifier rubyid_client'>client</span><span class='comma'>,</span> <span class='id identifier rubyid_cid'>cid</span><span class='comma'>,</span> <span class='id identifier rubyid_type'>type</span><span class='comma'>,</span> <span class='id identifier rubyid_flags'>flags</span><span class='rparen'>)</span>
  <span class='kw'>super</span><span class='lparen'>(</span><span class='id identifier rubyid_client'>client</span><span class='comma'>,</span> <span class='id identifier rubyid_cid'>cid</span><span class='comma'>,</span> <span class='id identifier rubyid_type'>type</span><span class='comma'>,</span> <span class='id identifier rubyid_flags'>flags</span><span class='rparen'>)</span>
  <span class='comment'># add this instance to the class variables dictionary of tcp server channels
</span>  <span class='cvar'>@@server_channels</span><span class='lbracket'>[</span><span class='kw'>self</span><span class='rbracket'>]</span> <span class='op'>||=</span> <span class='op'>::</span><span class='const'>Queue</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
  
</div>


  <div id="class_method_details" class="method_details_list">
    <h2>Class Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="cls-class_method">
  
    + (<tt>Object</tt>) <strong>cls</strong> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


71
72
73</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/post/meterpreter/extensions/stdapi/net/socket_subsystem/tcp_server_channel.rb', line 71</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_cls'>cls</span>
  <span class='const'>CHANNEL_CLASS_STREAM</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="open-class_method">
  
    + (<tt><span class='object_link'><a href="../../../../Channel.html" title="Rex::Post::Meterpreter::Channel (class)">Channel</a></span></tt>) <strong>open</strong>(client, params) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Open a new tcp server channel on the remote end.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../../../Channel.html" title="Rex::Post::Meterpreter::Channel (class)">Channel</a></span></tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


79
80
81
82
83
84
85
86
87
88
89
90
91
92
93</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/post/meterpreter/extensions/stdapi/net/socket_subsystem/tcp_server_channel.rb', line 79</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_open'>open</span><span class='lparen'>(</span><span class='id identifier rubyid_client'>client</span><span class='comma'>,</span> <span class='id identifier rubyid_params'>params</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_c'>c</span> <span class='op'>=</span> <span class='const'>Channel</span><span class='period'>.</span><span class='id identifier rubyid_create'>create</span><span class='lparen'>(</span><span class='id identifier rubyid_client'>client</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>stdapi_net_tcp_server</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='kw'>self</span><span class='comma'>,</span> <span class='const'>CHANNEL_FLAG_SYNCHRONOUS</span><span class='comma'>,</span>
    <span class='lbracket'>[</span>
      <span class='lbrace'>{</span>
      <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>type</span><span class='tstring_end'>&#39;</span></span>  <span class='op'>=&gt;</span> <span class='const'>TLV_TYPE_LOCAL_HOST</span><span class='comma'>,</span>
      <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>value</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_params'>params</span><span class='period'>.</span><span class='id identifier rubyid_localhost'>localhost</span>
      <span class='rbrace'>}</span><span class='comma'>,</span>
      <span class='lbrace'>{</span>
      <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>type</span><span class='tstring_end'>&#39;</span></span>  <span class='op'>=&gt;</span> <span class='const'>TLV_TYPE_LOCAL_PORT</span><span class='comma'>,</span>
      <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>value</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_params'>params</span><span class='period'>.</span><span class='id identifier rubyid_localport'>localport</span>
      <span class='rbrace'>}</span>
    <span class='rbracket'>]</span> <span class='rparen'>)</span>
  <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_params'>params</span> <span class='op'>=</span> <span class='id identifier rubyid_params'>params</span>
  <span class='id identifier rubyid_c'>c</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="request_handler-class_method">
  
    + (<tt>Object</tt>) <strong>request_handler</strong>(client, packet) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>This is the request handler which is registered to the respective
meterpreter instance via
Rex::Post::Meterpreter::Extensions::Stdapi::Net::Socket. All incoming
requests from the meterpreter for a &#39;tcp_channel_open&#39; will be
processed here. We create a new TcpClientChannel for each request received
and store it in the respective tcp server channels list of new pending
client channels. These new tcp client channels are passed off via a call
the the tcp server channels accept() method.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/post/meterpreter/extensions/stdapi/net/socket_subsystem/tcp_server_channel.rb', line 34</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_request_handler'>request_handler</span><span class='lparen'>(</span><span class='id identifier rubyid_client'>client</span><span class='comma'>,</span> <span class='id identifier rubyid_packet'>packet</span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='kw'>false</span> <span class='kw'>unless</span> <span class='id identifier rubyid_packet'>packet</span><span class='period'>.</span><span class='id identifier rubyid_method'>method</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>tcp_channel_open</span><span class='tstring_end'>&quot;</span></span>

  <span class='id identifier rubyid_cid'>cid</span>       <span class='op'>=</span> <span class='id identifier rubyid_packet'>packet</span><span class='period'>.</span><span class='id identifier rubyid_get_tlv_value'>get_tlv_value</span><span class='lparen'>(</span> <span class='const'>TLV_TYPE_CHANNEL_ID</span> <span class='rparen'>)</span>
  <span class='id identifier rubyid_pid'>pid</span>       <span class='op'>=</span> <span class='id identifier rubyid_packet'>packet</span><span class='period'>.</span><span class='id identifier rubyid_get_tlv_value'>get_tlv_value</span><span class='lparen'>(</span> <span class='const'>TLV_TYPE_CHANNEL_PARENTID</span> <span class='rparen'>)</span>
  <span class='id identifier rubyid_localhost'>localhost</span> <span class='op'>=</span> <span class='id identifier rubyid_packet'>packet</span><span class='period'>.</span><span class='id identifier rubyid_get_tlv_value'>get_tlv_value</span><span class='lparen'>(</span> <span class='const'>TLV_TYPE_LOCAL_HOST</span> <span class='rparen'>)</span>
  <span class='id identifier rubyid_localport'>localport</span> <span class='op'>=</span> <span class='id identifier rubyid_packet'>packet</span><span class='period'>.</span><span class='id identifier rubyid_get_tlv_value'>get_tlv_value</span><span class='lparen'>(</span> <span class='const'>TLV_TYPE_LOCAL_PORT</span> <span class='rparen'>)</span>
  <span class='id identifier rubyid_peerhost'>peerhost</span>  <span class='op'>=</span> <span class='id identifier rubyid_packet'>packet</span><span class='period'>.</span><span class='id identifier rubyid_get_tlv_value'>get_tlv_value</span><span class='lparen'>(</span> <span class='const'>TLV_TYPE_PEER_HOST</span> <span class='rparen'>)</span>
  <span class='id identifier rubyid_peerport'>peerport</span>  <span class='op'>=</span> <span class='id identifier rubyid_packet'>packet</span><span class='period'>.</span><span class='id identifier rubyid_get_tlv_value'>get_tlv_value</span><span class='lparen'>(</span> <span class='const'>TLV_TYPE_PEER_PORT</span> <span class='rparen'>)</span>

  <span class='kw'>return</span> <span class='kw'>false</span> <span class='kw'>if</span> <span class='id identifier rubyid_cid'>cid</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span> <span class='op'>||</span> <span class='id identifier rubyid_pid'>pid</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>

  <span class='id identifier rubyid_server_channel'>server_channel</span> <span class='op'>=</span> <span class='id identifier rubyid_client'>client</span><span class='period'>.</span><span class='id identifier rubyid_find_channel'>find_channel</span><span class='lparen'>(</span><span class='id identifier rubyid_pid'>pid</span><span class='rparen'>)</span>

  <span class='kw'>return</span> <span class='kw'>false</span> <span class='kw'>if</span> <span class='id identifier rubyid_server_channel'>server_channel</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>

  <span class='id identifier rubyid_params'>params</span> <span class='op'>=</span> <span class='const'>Rex</span><span class='op'>::</span><span class='const'>Socket</span><span class='op'>::</span><span class='const'>Parameters</span><span class='period'>.</span><span class='id identifier rubyid_from_hash'>from_hash</span><span class='lparen'>(</span>
    <span class='lbrace'>{</span>
      <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Proto</span><span class='tstring_end'>&#39;</span></span>     <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>tcp</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
      <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>LocalHost</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_localhost'>localhost</span><span class='comma'>,</span>
      <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>LocalPort</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_localport'>localport</span><span class='comma'>,</span>
      <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>PeerHost</span><span class='tstring_end'>&#39;</span></span>  <span class='op'>=&gt;</span> <span class='id identifier rubyid_peerhost'>peerhost</span><span class='comma'>,</span>
      <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>PeerPort</span><span class='tstring_end'>&#39;</span></span>  <span class='op'>=&gt;</span> <span class='id identifier rubyid_peerport'>peerport</span><span class='comma'>,</span>
      <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Comm</span><span class='tstring_end'>&#39;</span></span>      <span class='op'>=&gt;</span> <span class='id identifier rubyid_server_channel'>server_channel</span><span class='period'>.</span><span class='id identifier rubyid_client'>client</span>
    <span class='rbrace'>}</span>
  <span class='rparen'>)</span>

  <span class='id identifier rubyid_client_channel'>client_channel</span> <span class='op'>=</span> <span class='const'>TcpClientChannel</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_client'>client</span><span class='comma'>,</span> <span class='id identifier rubyid_cid'>cid</span><span class='comma'>,</span> <span class='const'>TcpClientChannel</span><span class='comma'>,</span> <span class='const'>CHANNEL_FLAG_SYNCHRONOUS</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_client_channel'>client_channel</span><span class='period'>.</span><span class='id identifier rubyid_params'>params</span> <span class='op'>=</span> <span class='id identifier rubyid_params'>params</span>

  <span class='cvar'>@@server_channels</span><span class='lbracket'>[</span><span class='id identifier rubyid_server_channel'>server_channel</span><span class='rbracket'>]</span> <span class='op'>||=</span> <span class='op'>::</span><span class='const'>Queue</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
  <span class='cvar'>@@server_channels</span><span class='lbracket'>[</span><span class='id identifier rubyid_server_channel'>server_channel</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_enq'>enq</span><span class='lparen'>(</span><span class='id identifier rubyid_client_channel'>client_channel</span><span class='rparen'>)</span>

  <span class='kw'>true</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="_accept-instance_method">
  
    - (<tt>Object</tt>) <strong>_accept</strong>(nonblock = false)  <span class="extras">(protected)</span>
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


135
136
137
138
139
140
141
142
143
144
145
146
147
148
149</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/post/meterpreter/extensions/stdapi/net/socket_subsystem/tcp_server_channel.rb', line 135</span>

<span class='kw'>def</span> <span class='id identifier rubyid__accept'>_accept</span><span class='lparen'>(</span><span class='id identifier rubyid_nonblock'>nonblock</span> <span class='op'>=</span> <span class='kw'>false</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='kw'>nil</span>

  <span class='id identifier rubyid_channel'>channel</span> <span class='op'>=</span> <span class='cvar'>@@server_channels</span><span class='lbracket'>[</span><span class='kw'>self</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_deq'>deq</span><span class='lparen'>(</span><span class='id identifier rubyid_nonblock'>nonblock</span><span class='rparen'>)</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_channel'>channel</span>
    <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='id identifier rubyid_channel'>channel</span><span class='period'>.</span><span class='id identifier rubyid_lsock'>lsock</span>
  <span class='kw'>end</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_result'>result</span> <span class='op'>!=</span> <span class='kw'>nil</span> <span class='op'>&amp;&amp;</span> <span class='op'>!</span><span class='id identifier rubyid_result'>result</span><span class='period'>.</span><span class='id identifier rubyid_kind_of?'>kind_of?</span><span class='lparen'>(</span><span class='const'>Rex</span><span class='op'>::</span><span class='const'>Socket</span><span class='op'>::</span><span class='const'>Tcp</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_result'>result</span><span class='period'>.</span><span class='id identifier rubyid_extend'>extend</span><span class='lparen'>(</span><span class='const'>Rex</span><span class='op'>::</span><span class='const'>Socket</span><span class='op'>::</span><span class='const'>Tcp</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_result'>result</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="accept-instance_method">
  
    - (<tt>Object</tt>) <strong>accept</strong>(opts = {}) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Accept a new tcp client connection form this tcp server channel. This
method will block indefinatly if no timeout is specified.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/post/meterpreter/extensions/stdapi/net/socket_subsystem/tcp_server_channel.rb', line 116</span>

<span class='kw'>def</span> <span class='id identifier rubyid_accept'>accept</span><span class='lparen'>(</span><span class='id identifier rubyid_opts'>opts</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_timeout'>timeout</span> <span class='op'>=</span> <span class='id identifier rubyid_opts'>opts</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Timeout</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
  <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_timeout'>timeout</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span> <span class='op'>||</span> <span class='id identifier rubyid_timeout'>timeout</span> <span class='op'>&lt;=</span> <span class='int'>0</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_timeout'>timeout</span> <span class='op'>=</span> <span class='int'>0</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='kw'>begin</span>
    <span class='op'>::</span><span class='const'>Timeout</span><span class='period'>.</span><span class='id identifier rubyid_timeout'>timeout</span><span class='lparen'>(</span><span class='id identifier rubyid_timeout'>timeout</span><span class='rparen'>)</span> <span class='lbrace'>{</span>
      <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='id identifier rubyid__accept'>_accept</span>
    <span class='rbrace'>}</span>
  <span class='kw'>rescue</span> <span class='const'>Timeout</span><span class='op'>::</span><span class='const'>Error</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_result'>result</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="accept_nonblock-instance_method">
  
    - (<tt>Object</tt>) <strong>accept_nonblock</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Accept a new tcp client connection form this tcp server channel. This
method does not block and returns nil if no new client connection is
available.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


108
109
110</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/post/meterpreter/extensions/stdapi/net/socket_subsystem/tcp_server_channel.rb', line 108</span>

<span class='kw'>def</span> <span class='id identifier rubyid_accept_nonblock'>accept_nonblock</span>
  <span class='id identifier rubyid__accept'>_accept</span><span class='lparen'>(</span><span class='kw'>true</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

    <div id="footer">
  Generated on Tue Jan 19 22:38:57 2016 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.8.7.6 (ruby-2.1.7).
</div>

  </body>
</html>