<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>
  Class: Msf::Exploit
  
    &mdash; Documentation by YARD 0.8.7.6
  
</title>

  <link rel="stylesheet" href="../css/style.css" type="text/css" charset="utf-8" />

  <link rel="stylesheet" href="../css/common.css" type="text/css" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  hasFrames = window.top.frames.main ? true : false;
  relpath = '../';
  framesUrl = "../frames.html#!Msf/Exploit.html";
</script>


  <script type="text/javascript" charset="utf-8" src="../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../js/app.js"></script>


  </head>
  <body>
    <div id="header">
      <div id="menu">
  
    <a href="../_index.html">Index (E)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../Msf.html" title="Msf (module)">Msf</a></span></span>
     &raquo; 
    <span class="title">Exploit</span>
  

  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../class_list.html">
      Class List
    </a>
  
    <a class="full_list_link" id="method_list_link"
        href="../method_list.html">
      Method List
    </a>
  
    <a class="full_list_link" id="file_list_link"
        href="../file_list.html">
      File List
    </a>
  
</div>
      <div class="clear"></div>
    </div>

    <iframe id="search_frame"></iframe>

    <div id="content"><h1>Class: Msf::Exploit
  
  
  
</h1>

<dl class="box">
  
    <dt class="r1">Inherits:</dt>
    <dd class="r1">
      <span class="inheritName"><span class='object_link'><a href="Module.html" title="Msf::Module (class)">Module</a></span></span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next"><span class='object_link'><a href="Module.html" title="Msf::Module (class)">Module</a></span></li>
          
            <li class="next">Msf::Exploit</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
      </dd>
    
  
  
    
  
    
  
  
  
    <dt class="r2 last">Defined in:</dt>
    <dd class="r2 last">lib/msf/core/exploit.rb<span class="defines">,<br />
  lib/msf/core/exploit/capture.rb,<br /> lib/msf/core/exploit/http/typo3.rb,<br /> lib/msf/core/exploit/http/jboss.rb,<br /> lib/msf/core/exploit/http/joomla.rb,<br /> lib/msf/core/exploit/java/rmi/util.rb,<br /> lib/msf/core/exploit/http/wordpress.rb,<br /> lib/msf/core/exploit/kerberos/client.rb,<br /> lib/msf/core/exploit/java/rmi/client.rb,<br /> lib/msf/core/exploit/java/rmi/builder.rb,<br /> lib/msf/core/exploit/format/webarchive.rb,<br /> lib/msf/core/exploit/kerberos/client/pac.rb,<br /> lib/msf/core/exploit/java/rmi/client/jmx.rb,<br /> lib/msf/core/exploit/kerberos/client/base.rb,<br /> lib/msf/core/exploit/java/rmi/client/registry.rb,<br /> lib/msf/core/exploit/java/rmi/client/jmx/server.rb,<br /> lib/msf/core/exploit/kerberos/client/as_request.rb,<br /> lib/msf/core/exploit/kerberos/client/tgs_request.rb,<br /> lib/msf/core/exploit/kerberos/client/as_response.rb,<br /> lib/msf/core/exploit/kerberos/client/tgs_response.rb,<br /> lib/msf/core/exploit/java/rmi/client/jmx/connection.rb,<br /> lib/msf/core/exploit/java/rmi/client/registry/parser.rb,<br /> lib/msf/core/exploit/java/rmi/client/registry/builder.rb,<br /> lib/msf/core/exploit/kerberos/client/cache_credential.rb,<br /> lib/msf/core/exploit/java/rmi/client/jmx/server/parser.rb,<br /> lib/msf/core/exploit/java/rmi/client/jmx/server/builder.rb,<br /> lib/msf/core/exploit/java/rmi/client/jmx/connection/builder.rb</span>
</dd>
  
</dl>
<div class="clear"></div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
<p>This module provides methods for sending and receiving raw packets. It
should be preferred over the soon-to-be deprecated Rex::Socket::Ip and
Msf::Exploit::Remote::Ip mixins.</p>

<p>Please see the pcaprub documentation for more information on how to use
capture objects.</p>


  </div>
</div>
<div class="tags">
  

</div><div id="subclasses">
  <h2>Direct Known Subclasses</h2>
  <p class="children"><span class='object_link'><a href="Exploit/Local.html" title="Msf::Exploit::Local (class)">Local</a></span>, <span class='object_link'><a href="Exploit/Remote.html" title="Msf::Exploit::Remote (class)">Remote</a></span></p>
</div>
<h2>Defined Under Namespace</h2>
<p class="children">
  
    
      <strong class="modules">Modules:</strong> <span class='object_link'><a href="Exploit/Android.html" title="Msf::Exploit::Android (module)">Android</a></span>, <span class='object_link'><a href="Exploit/Brute.html" title="Msf::Exploit::Brute (module)">Brute</a></span>, <span class='object_link'><a href="Exploit/BruteTargets.html" title="Msf::Exploit::BruteTargets (module)">BruteTargets</a></span>, <span class='object_link'><a href="Exploit/Capture.html" title="Msf::Exploit::Capture (module)">Capture</a></span>, <span class='object_link'><a href="Exploit/CheckCode.html" title="Msf::Exploit::CheckCode (module)">CheckCode</a></span>, <span class='object_link'><a href="Exploit/CmdStager.html" title="Msf::Exploit::CmdStager (module)">CmdStager</a></span>, <span class='object_link'><a href="Exploit/CompatDefaults.html" title="Msf::Exploit::CompatDefaults (module)">CompatDefaults</a></span>, <span class='object_link'><a href="Exploit/DECT_COA.html" title="Msf::Exploit::DECT_COA (module)">DECT_COA</a></span>, <span class='object_link'><a href="Exploit/DHCPServer.html" title="Msf::Exploit::DHCPServer (module)">DHCPServer</a></span>, <span class='object_link'><a href="Exploit/EXE.html" title="Msf::Exploit::EXE (module)">EXE</a></span>, <span class='object_link'><a href="Exploit/Egghunter.html" title="Msf::Exploit::Egghunter (module)">Egghunter</a></span>, <span class='object_link'><a href="Exploit/FILEFORMAT.html" title="Msf::Exploit::FILEFORMAT (module)">FILEFORMAT</a></span>, <span class='object_link'><a href="Exploit/FileDropper.html" title="Msf::Exploit::FileDropper (module)">FileDropper</a></span>, <span class='object_link'><a href="Exploit/Format.html" title="Msf::Exploit::Format (module)">Format</a></span>, <span class='object_link'><a href="Exploit/FormatString.html" title="Msf::Exploit::FormatString (module)">FormatString</a></span>, <span class='object_link'><a href="Exploit/JSObfu.html" title="Msf::Exploit::JSObfu (module)">JSObfu</a></span>, <span class='object_link'><a href="Exploit/Java.html" title="Msf::Exploit::Java (module)">Java</a></span>, <span class='object_link'><a href="Exploit/KernelMode.html" title="Msf::Exploit::KernelMode (module)">KernelMode</a></span>, <span class='object_link'><a href="Exploit/NTLM.html" title="Msf::Exploit::NTLM (module)">NTLM</a></span>, <span class='object_link'><a href="Exploit/ORACLE.html" title="Msf::Exploit::ORACLE (module)">ORACLE</a></span>, <span class='object_link'><a href="Exploit/Omelet.html" title="Msf::Exploit::Omelet (module)">Omelet</a></span>, <span class='object_link'><a href="Exploit/PDF.html" title="Msf::Exploit::PDF (module)">PDF</a></span>, <span class='object_link'><a href="Exploit/PDF_Parse.html" title="Msf::Exploit::PDF_Parse (module)">PDF_Parse</a></span>, <span class='object_link'><a href="Exploit/PhpEXE.html" title="Msf::Exploit::PhpEXE (module)">PhpEXE</a></span>, <span class='object_link'><a href="Exploit/Powershell.html" title="Msf::Exploit::Powershell (module)">Powershell</a></span>, <span class='object_link'><a href="Exploit/RIFF.html" title="Msf::Exploit::RIFF (module)">RIFF</a></span>, <span class='object_link'><a href="Exploit/RopDb.html" title="Msf::Exploit::RopDb (module)">RopDb</a></span>, <span class='object_link'><a href="Exploit/Seh.html" title="Msf::Exploit::Seh (module)">Seh</a></span>, <span class='object_link'><a href="Exploit/Stance.html" title="Msf::Exploit::Stance (module)">Stance</a></span>, <span class='object_link'><a href="Exploit/TFTPServer.html" title="Msf::Exploit::TFTPServer (module)">TFTPServer</a></span>, <span class='object_link'><a href="Exploit/Type.html" title="Msf::Exploit::Type (module)">Type</a></span>, <span class='object_link'><a href="Exploit/WbemExec.html" title="Msf::Exploit::WbemExec (module)">WbemExec</a></span>
    
  
    
      <strong class="classes">Classes:</strong> <span class='object_link'><a href="Exploit/Complete.html" title="Msf::Exploit::Complete (class)">Complete</a></span>, <span class='object_link'><a href="Exploit/Failed.html" title="Msf::Exploit::Failed (class)">Failed</a></span>, <span class='object_link'><a href="Exploit/Local.html" title="Msf::Exploit::Local (class)">Local</a></span>, <span class='object_link'><a href="Exploit/Remote.html" title="Msf::Exploit::Remote (class)">Remote</a></span>
    
  
</p>

  <h2>Constant Summary</h2>
  



  <h2>Constant Summary</h2>
  
  <h3 class="inherited">Constants inherited
     from <span class='object_link'><a href="Module.html" title="Msf::Module (class)">Module</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="Module.html#REPLICANT_EXTENSION_DS_KEY-constant" title="Msf::Module::REPLICANT_EXTENSION_DS_KEY (constant)">Module::REPLICANT_EXTENSION_DS_KEY</a></span></p>

  
  
  <h3 class="inherited">Constants included
     from <span class='object_link'><a href="Module/ModuleInfo.html" title="Msf::Module::ModuleInfo (module)">Module::ModuleInfo</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="Module/ModuleInfo.html#UpdateableOptions-constant" title="Msf::Module::ModuleInfo::UpdateableOptions (constant)">Module::ModuleInfo::UpdateableOptions</a></span></p>


  <h2>Instance Attribute Summary <small>(<a href="#" class="summary_toggle">collapse</a>)</small></h2>
  <ul class="summary">
    
      <li class="protected ">
  <span class="summary_signature">
    
      <a href="#active_timeout-instance_method" title="#active_timeout (instance method)">- (Object) <strong>active_timeout</strong> </a>
    

    
  </span>
  
  
  
    
    
  
  <span class="note title protected">protected</span>
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Maximum number of seconds for active handlers.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#default_target-instance_method" title="#default_target (instance method)">- (Object) <strong>default_target</strong> </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>The default target.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#fail_detail-instance_method" title="#fail_detail (instance method)">- (Object) <strong>fail_detail</strong> </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Detailed exception string indicating why the exploit was not successful.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#fail_reason-instance_method" title="#fail_reason (instance method)">- (Object) <strong>fail_reason</strong> </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>The reason why the exploit was not successful (one of
Msf::Module::Failure).</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#payload-instance_method" title="#payload (instance method)">- (Object) <strong>payload</strong> </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>The encoded payload instance.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#payload_info-instance_method" title="#payload_info (instance method)">- (Object) <strong>payload_info</strong> </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>The payload requirement hash.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#payload_instance-instance_method" title="#payload_instance (instance method)">- (Object) <strong>payload_instance</strong> </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>The active payload instance.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#session_count-instance_method" title="#session_count (instance method)">- (Object) <strong>session_count</strong> </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>The number of active sessions created by this instance.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#successful-instance_method" title="#successful (instance method)">- (Object) <strong>successful</strong> </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>The boolean indicating whether the exploit succeeded.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#targets-instance_method" title="#targets (instance method)">- (Object) <strong>targets</strong> </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>The list of targets.</p>
</div></span>
  
</li>

    
  </ul>



  
  
  <h3 class="inherited">Attributes inherited from <span class='object_link'><a href="Module.html" title="Msf::Module (class)">Module</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="Module.html#error-instance_method" title="Msf::Module#error (method)">#error</a></span>, <span class='object_link'><a href="Module.html#job_id-instance_method" title="Msf::Module#job_id (method)">#job_id</a></span>, <span class='object_link'><a href="Module.html#license-instance_method" title="Msf::Module#license (method)">#license</a></span>, <span class='object_link'><a href="Module.html#platform-instance_method" title="Msf::Module#platform (method)">#platform</a></span>, <span class='object_link'><a href="Module.html#privileged%3D-instance_method" title="Msf::Module#privileged= (method)">#privileged</a></span>, <span class='object_link'><a href="Module.html#references-instance_method" title="Msf::Module#references (method)">#references</a></span>, <span class='object_link'><a href="Module.html#user_data-instance_method" title="Msf::Module#user_data (method)">#user_data</a></span></p>

  
  
  <h3 class="inherited">Attributes included from <span class='object_link'><a href="Framework/Offspring.html" title="Msf::Framework::Offspring (module)">Framework::Offspring</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="Framework/Offspring.html#framework-instance_method" title="Msf::Framework::Offspring#framework (method)">#framework</a></span></p>

  
  
  <h3 class="inherited">Attributes included from <span class='object_link'><a href="Module/UUID.html" title="Msf::Module::UUID (module)">Module::UUID</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="Module/UUID.html#uuid-instance_method" title="Msf::Module::UUID#uuid (method)">#uuid</a></span></p>

  
  
  <h3 class="inherited">Attributes included from <span class='object_link'><a href="../Rex/Ui/Subscriber/Input.html" title="Rex::Ui::Subscriber::Input (module)">Rex::Ui::Subscriber::Input</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="../Rex/Ui/Subscriber/Input.html#user_input-instance_method" title="Rex::Ui::Subscriber::Input#user_input (method)">#user_input</a></span></p>

  
  
  <h3 class="inherited">Attributes included from <span class='object_link'><a href="../Rex/Ui/Subscriber/Output.html" title="Rex::Ui::Subscriber::Output (module)">Rex::Ui::Subscriber::Output</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="../Rex/Ui/Subscriber/Output.html#user_output-instance_method" title="Rex::Ui::Subscriber::Output#user_output (method)">#user_output</a></span></p>

  
  
  <h3 class="inherited">Attributes included from <span class='object_link'><a href="Module/Privileged.html" title="Msf::Module::Privileged (module)">Module::Privileged</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="Module/Privileged.html#priveli%3D-instance_method" title="Msf::Module::Privileged#priveli= (method)">#priveli</a></span>, <span class='object_link'><a href="Module/Privileged.html#privileged-instance_method" title="Msf::Module::Privileged#privileged (method)">#privileged</a></span></p>

  
  
  <h3 class="inherited">Attributes included from <span class='object_link'><a href="Module/Options.html" title="Msf::Module::Options (module)">Module::Options</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="Module/Options.html#options-instance_method" title="Msf::Module::Options#options (method)">#options</a></span></p>

  
  
  <h3 class="inherited">Attributes included from <span class='object_link'><a href="Module/ModuleStore.html" title="Msf::Module::ModuleStore (module)">Module::ModuleStore</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="Module/ModuleStore.html#module_store-instance_method" title="Msf::Module::ModuleStore#module_store (method)">#module_store</a></span></p>

  
  
  <h3 class="inherited">Attributes included from <span class='object_link'><a href="Module/ModuleInfo.html" title="Msf::Module::ModuleInfo (module)">Module::ModuleInfo</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="Module/ModuleInfo.html#module_info-instance_method" title="Msf::Module::ModuleInfo#module_info (method)">#module_info</a></span></p>

  
  
  <h3 class="inherited">Attributes included from <span class='object_link'><a href="Module/DataStore.html" title="Msf::Module::DataStore (module)">Module::DataStore</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="Module/DataStore.html#datastore-instance_method" title="Msf::Module::DataStore#datastore (method)">#datastore</a></span></p>

  
  
  <h3 class="inherited">Attributes included from <span class='object_link'><a href="Module/Author.html" title="Msf::Module::Author (module)">Module::Author</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="Module/Author.html#author-instance_method" title="Msf::Module::Author#author (method)">#author</a></span></p>

  
  
  <h3 class="inherited">Attributes included from <span class='object_link'><a href="Module/Arch.html" title="Msf::Module::Arch (module)">Module::Arch</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="Module/Arch.html#arch-instance_method" title="Msf::Module::Arch#arch (method)">#arch</a></span></p>


  
    <h2>
      Class Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#mixins-class_method" title="mixins (class method)">+ (Array) <strong>mixins</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns an array of all of the exploit mixins.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#type-class_method" title="type (class method)">+ (Object) <strong>type</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns MODULE_EXPLOIT to indicate that this is an exploit module.</p>
</div></span>
  
</li>

      
    </ul>
  
    <h2>
      Instance Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#add_handler-instance_method" title="#add_handler (instance method)">- (Object) <strong>add_handler</strong>(opts = {}) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Allows the payload handler to spawn a new monitor.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#aggressive%3F-instance_method" title="#aggressive? (instance method)">- (Boolean) <strong>aggressive?</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns true if the exploit has an aggressive stance.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#autofilter-instance_method" title="#autofilter (instance method)">- (Object) <strong>autofilter</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Performs last-minute sanity checking of auxiliary parameters.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#autofilter_ports-instance_method" title="#autofilter_ports (instance method)">- (Object) <strong>autofilter_ports</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Provides a list of ports that can be used for matching this module against
target systems.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#autofilter_services-instance_method" title="#autofilter_services (instance method)">- (Object) <strong>autofilter_services</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Provides a list of services that can be used for matching this module
against target systems.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#capabilities-instance_method" title="#capabilities (instance method)">- (Object) <strong>capabilities</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns a hash of the capabilities this exploit module has support for,
such as whether or not it supports check and exploit.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#cleanup-instance_method" title="#cleanup (instance method)">- (Object) <strong>cleanup</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Performs any cleanup that may be necessary, such as disconnecting
connections and any other such fun things.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#compatible_encoders-instance_method" title="#compatible_encoders (instance method)">- (Object) <strong>compatible_encoders</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns a list of compatible encoders based on architecture.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#compatible_payloads-instance_method" title="#compatible_payloads (instance method)">- (Object) <strong>compatible_payloads</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns a list of compatible payloads based on platform, architecture, and
size requirements.</p>
</div></span>
  
</li>

      
        <li class="protected ">
  <span class="summary_signature">
    
      <a href="#define_context_encoding_reqs-instance_method" title="#define_context_encoding_reqs (instance method)">- (Object) <strong>define_context_encoding_reqs</strong>(reqs) </a>
    

    
  </span>
  
  
  
  <span class="note title protected">protected</span>
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Gets the memory map file and other context information that is required
when wanting to support context keyed encoding.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#encode_begin-instance_method" title="#encode_begin (instance method)">- (Object) <strong>encode_begin</strong>(real_payload, reqs) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Called prior to encoding a payload.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#encode_end-instance_method" title="#encode_end (instance method)">- (Object) <strong>encode_end</strong>(real_payload, reqs, encoded) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Called after an encoded payload has been generated.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#encode_shellcode_stub-instance_method" title="#encode_shellcode_stub (instance method)">- (Object) <strong>encode_shellcode_stub</strong>(code, badchars = payload_badchars) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Allows arbitrary shellcode to be encoded from within an exploit.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#exploit-instance_method" title="#exploit (instance method)">- (Object) <strong>exploit</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Kicks off the actual exploit.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#exploit_type-instance_method" title="#exploit_type (instance method)">- (Object) <strong>exploit_type</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>If we don&#39;t know the exploit type, then I guess it&#39;s omnipresent!.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#fail_with-instance_method" title="#fail_with (instance method)">- (void) <strong>fail_with</strong>(reason, msg = nil) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Raises a Msf::Exploit::Failed exception.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#generate_payload-instance_method" title="#generate_payload (instance method)">- (Object) <strong>generate_payload</strong>(pinst = nil) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Generates the encoded version of the supplied payload using the payload
requirements specific to this exploit.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#generate_single_payload-instance_method" title="#generate_single_payload (instance method)">- (Object) <strong>generate_single_payload</strong>(pinst = nil, platform = nil, arch = nil, explicit_target = nil) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>This method generates a non-cached payload which is typically useful for
passive exploits that will have more than one client.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#handle_exception-instance_method" title="#handle_exception (instance method)">- (Object) <strong>handle_exception</strong>(e) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Handle the exception.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#handler-instance_method" title="#handler (instance method)">- (Object) <strong>handler</strong>(*args) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Passes the connection to the associated payload handler to see if the
exploit succeeded and a connection has been established.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#handler_enabled%3F-instance_method" title="#handler_enabled? (instance method)">- (Boolean) <strong>handler_enabled?</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Allow the user to disable the payload handler.</p>
</div></span>
  
</li>

      
        <li class="protected ">
  <span class="summary_signature">
    
      <a href="#init_compat-instance_method" title="#init_compat (instance method)">- (Object) <strong>init_compat</strong> </a>
    

    
  </span>
  
  
  
  <span class="note title protected">protected</span>
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Overrides the base class method and serves to initialize default
compatibilities for exploits.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#initialize-instance_method" title="#initialize (instance method)">- (Exploit) <strong>initialize</strong>(info = {}) </a>
    

    
  </span>
  
  
    <span class="note title constructor">constructor</span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Creates an instance of the exploit module.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#is_payload_compatible%3F-instance_method" title="#is_payload_compatible? (instance method)">- (TrueClass, FalseClass) <strong>is_payload_compatible?</strong>(payload_name) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns whether the requested payload is compatible with the module.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#make_nops-instance_method" title="#make_nops (instance method)">- (Object) <strong>make_nops</strong>(count) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Generates a nop sled of a supplied length and returns it to the caller.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#nop_generator-instance_method" title="#nop_generator (instance method)">- (Object) <strong>nop_generator</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the first compatible NOP generator for this exploit&#39;s payload
instance.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#nop_save_registers-instance_method" title="#nop_save_registers (instance method)">- (Object) <strong>nop_save_registers</strong>(explicit_target = nil) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the list of registers that the NOP generator should save, if any.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#on_new_session-instance_method" title="#on_new_session (instance method)">- (Object) <strong>on_new_session</strong>(session) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>This is called by the payload when a new session is created.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#passive%3F-instance_method" title="#passive? (instance method)">- (Boolean) <strong>passive?</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns if the exploit has a passive stance.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#pattern_create-instance_method" title="#pattern_create (instance method)">- (Object) <strong>pattern_create</strong>(length, sets = nil) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Generate a non-repeating static random string.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#payload_append-instance_method" title="#payload_append (instance method)">- (Object) <strong>payload_append</strong>(explicit_target = nil) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Return any text that should be appended to the payload.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#payload_append_encoder-instance_method" title="#payload_append_encoder (instance method)">- (Object) <strong>payload_append_encoder</strong>(explicit_target = nil) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Return any text that should be appended to the encoder of the payload.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#payload_badchars-instance_method" title="#payload_badchars (instance method)">- (Object) <strong>payload_badchars</strong>(explicit_target = nil) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the bad characters that cannot be in any payload used by this
exploit.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#payload_encoder_options-instance_method" title="#payload_encoder_options (instance method)">- (Object) <strong>payload_encoder_options</strong>(explicit_target = nil) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the payload encoder option hash that is used to initialize the
datastore of the encoder that is selected when generating an encoded
payload.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#payload_encoder_type-instance_method" title="#payload_encoder_type (instance method)">- (Object) <strong>payload_encoder_type</strong>(explicit_target = nil) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the payload encoder type that is associated with either the current
target of the exploit in general.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#payload_extended_options-instance_method" title="#payload_extended_options (instance method)">- (Object) <strong>payload_extended_options</strong>(explicit_target = nil) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the payload extended options hash which is used to provide a
location to store extended information that may be useful to a particular
type of payload or mixin.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#payload_max_nops-instance_method" title="#payload_max_nops (instance method)">- (Object) <strong>payload_max_nops</strong>(explicit_target = nil) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Maximum number of nops to use as a hint to the framework.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#payload_min_nops-instance_method" title="#payload_min_nops (instance method)">- (Object) <strong>payload_min_nops</strong>(explicit_target = nil) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Minimum number of nops to use as a hint to the framework.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#payload_prepend-instance_method" title="#payload_prepend (instance method)">- (Object) <strong>payload_prepend</strong>(explicit_target = nil) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Return any text that should be prepended to the payload.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#payload_prepend_encoder-instance_method" title="#payload_prepend_encoder (instance method)">- (Object) <strong>payload_prepend_encoder</strong>(explicit_target = nil) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Return any text that should be prepended to the encoder of the payload.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#payload_space-instance_method" title="#payload_space (instance method)">- (Object) <strong>payload_space</strong>(explicit_target = nil) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the maximum amount of room the exploit has for a payload.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#rand_char-instance_method" title="#rand_char (instance method)">- (Object) <strong>rand_char</strong>(bad = payload_badchars) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Generate a random character avoiding the exploit&#39;s bad characters.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#rand_text-instance_method" title="#rand_text (instance method)">- (Object) <strong>rand_text</strong>(length, bad = payload_badchars) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Generate random text characters avoiding the exploit&#39;s bad characters.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#rand_text_alpha-instance_method" title="#rand_text_alpha (instance method)">- (Object) <strong>rand_text_alpha</strong>(length, bad = payload_badchars) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Generate random alpha characters avoiding the exploit&#39;s bad characters.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#rand_text_alpha_lower-instance_method" title="#rand_text_alpha_lower (instance method)">- (Object) <strong>rand_text_alpha_lower</strong>(length, bad = payload_badchars) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Generate random alpha lower characters avoiding the exploit&#39;s bad
characters.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#rand_text_alpha_upper-instance_method" title="#rand_text_alpha_upper (instance method)">- (Object) <strong>rand_text_alpha_upper</strong>(length, bad = payload_badchars) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Generate random alpha upper characters avoiding the exploit&#39;s bad
characters.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#rand_text_alphanumeric-instance_method" title="#rand_text_alphanumeric (instance method)">- (Object) <strong>rand_text_alphanumeric</strong>(length, bad = payload_badchars) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Generate random alphanumeric characters avoiding the exploit&#39;s bad
characters.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#rand_text_english-instance_method" title="#rand_text_english (instance method)">- (Object) <strong>rand_text_english</strong>(length, bad = payload_badchars) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Generate random english-like avoiding the exploit&#39;s bad characters.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#rand_text_highascii-instance_method" title="#rand_text_highascii (instance method)">- (Object) <strong>rand_text_highascii</strong>(length, bad = payload_badchars) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Generate random high ascii characters avoiding the exploit&#39;s bad
characters.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#rand_text_numeric-instance_method" title="#rand_text_numeric (instance method)">- (Object) <strong>rand_text_numeric</strong>(length, bad = payload_badchars) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Generate random numeric characters avoiding the exploit&#39;s bad
characters.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#regenerate_payload-instance_method" title="#regenerate_payload (instance method)">- (Object) <strong>regenerate_payload</strong>(platform = nil, arch = nil, explicit_target = nil) </a>
    

    
      (also: #exploit_regenerate_payload)
    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Re-generates an encoded payload, typically called after something in the
datastore has changed.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#register_autofilter_ports-instance_method" title="#register_autofilter_ports (instance method)">- (Object) <strong>register_autofilter_ports</strong>(ports = []) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Adds a port into the list of ports.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#register_autofilter_services-instance_method" title="#register_autofilter_services (instance method)">- (Object) <strong>register_autofilter_services</strong>(services = []) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#report_failure-instance_method" title="#report_failure (instance method)">- (Object) <strong>report_failure</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#reset_session_counts-instance_method" title="#reset_session_counts (instance method)">- (Object) <strong>reset_session_counts</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Reset the session counter to zero (which occurs during set up of the
exploit prior to calling exploit).</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#session_created%3F-instance_method" title="#session_created? (instance method)">- (Boolean) <strong>session_created?</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>A boolean for whether a session has been created yet.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#setup-instance_method" title="#setup (instance method)">- (Object) <strong>setup</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Prepares the module for exploitation, initializes any state, and starts the
payload handler.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#setup_fail_detail_from_exception-instance_method" title="#setup_fail_detail_from_exception (instance method)">- (Object) <strong>setup_fail_detail_from_exception</strong>(e) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#stack_adjustment-instance_method" title="#stack_adjustment (instance method)">- (Object) <strong>stack_adjustment</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>This method returns the number of bytes that should be adjusted to the
stack pointer prior to executing any code.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#stance-instance_method" title="#stance (instance method)">- (Object) <strong>stance</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Generally, all exploits take an aggressive stance.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#supports_check%3F-instance_method" title="#supports_check? (instance method)">- (Boolean) <strong>supports_check?</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns true if the exploit module supports the check method.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#supports_exploit%3F-instance_method" title="#supports_exploit? (instance method)">- (Boolean) <strong>supports_exploit?</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns true if the exploit module supports the exploit method.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#target-instance_method" title="#target (instance method)">- (Object) <strong>target</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the active target for this exploit.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#target_arch-instance_method" title="#target_arch (instance method)">- (Object) <strong>target_arch</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the target&#39;s architecture, or the one assigned to the module
itself.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#target_index-instance_method" title="#target_index (instance method)">- (Object) <strong>target_index</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>The target index that has been selected.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#target_platform-instance_method" title="#target_platform (instance method)">- (Object) <strong>target_platform</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the target&#39;s platform, or the one assigned to the module
itself.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#type-instance_method" title="#type (instance method)">- (Object) <strong>type</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns MODULE_EXPLOIT to indicate that this is an exploit module.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#wfs_delay-instance_method" title="#wfs_delay (instance method)">- (Object) <strong>wfs_delay</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>The default “wait for session” delay is zero for all exploits.</p>
</div></span>
  
</li>

      
    </ul>
  


  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods inherited from <span class='object_link'><a href="Module.html" title="Msf::Module (class)">Module</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="Module.html#cached%3F-class_method" title="Msf::Module.cached? (method)">cached?</a></span>, <span class='object_link'><a href="Module.html#check-instance_method" title="Msf::Module#check (method)">#check</a></span>, <span class='object_link'><a href="Module.html#debugging%3F-instance_method" title="Msf::Module#debugging? (method)">#debugging?</a></span>, <span class='object_link'><a href="Module.html#derived_implementor%3F-instance_method" title="Msf::Module#derived_implementor? (method)">#derived_implementor?</a></span>, <span class='object_link'><a href="Module.html#file_path-instance_method" title="Msf::Module#file_path (method)">#file_path</a></span>, <span class='object_link'><a href="Module.html#framework-instance_method" title="Msf::Module#framework (method)">#framework</a></span>, <span class='object_link'><a href="Module.html#is_usable-class_method" title="Msf::Module.is_usable (method)">is_usable</a></span>, <span class='object_link'><a href="Module.html#orig_cls-instance_method" title="Msf::Module#orig_cls (method)">#orig_cls</a></span>, <span class='object_link'><a href="Module.html#owner-instance_method" title="Msf::Module#owner (method)">#owner</a></span>, <span class='object_link'><a href="Module.html#perform_extensions-instance_method" title="Msf::Module#perform_extensions (method)">#perform_extensions</a></span>, <span class='object_link'><a href="Module.html#platform%3F-instance_method" title="Msf::Module#platform? (method)">#platform?</a></span>, <span class='object_link'><a href="Module.html#platform_to_s-instance_method" title="Msf::Module#platform_to_s (method)">#platform_to_s</a></span>, <span class='object_link'><a href="Module.html#register_extensions-instance_method" title="Msf::Module#register_extensions (method)">#register_extensions</a></span>, <span class='object_link'><a href="Module.html#register_parent-instance_method" title="Msf::Module#register_parent (method)">#register_parent</a></span>, <span class='object_link'><a href="Module.html#replicant-instance_method" title="Msf::Module#replicant (method)">#replicant</a></span>, <span class='object_link'><a href="Module.html#set_defaults-instance_method" title="Msf::Module#set_defaults (method)">#set_defaults</a></span>, <span class='object_link'><a href="Module.html#workspace-instance_method" title="Msf::Module#workspace (method)">#workspace</a></span></p>

  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="Module/UUID.html" title="Msf::Module::UUID (module)">Module::UUID</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="Module/UUID.html#generate_uuid-instance_method" title="Msf::Module::UUID#generate_uuid (method)">#generate_uuid</a></span></p>

  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="Module/UI/Message.html" title="Msf::Module::UI::Message (module)">Module::UI::Message</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="Module/UI/Message.html#print_error-instance_method" title="Msf::Module::UI::Message#print_error (method)">#print_error</a></span>, <span class='object_link'><a href="Module/UI/Message.html#print_good-instance_method" title="Msf::Module::UI::Message#print_good (method)">#print_good</a></span>, <span class='object_link'><a href="Module/UI/Message.html#print_prefix-instance_method" title="Msf::Module::UI::Message#print_prefix (method)">#print_prefix</a></span>, <span class='object_link'><a href="Module/UI/Message.html#print_status-instance_method" title="Msf::Module::UI::Message#print_status (method)">#print_status</a></span>, <span class='object_link'><a href="Module/UI/Message.html#print_warning-instance_method" title="Msf::Module::UI::Message#print_warning (method)">#print_warning</a></span></p>

  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="Module/UI/Message/Verbose.html" title="Msf::Module::UI::Message::Verbose (module)">Module::UI::Message::Verbose</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="Module/UI/Message/Verbose.html#vprint_error-instance_method" title="Msf::Module::UI::Message::Verbose#vprint_error (method)">#vprint_error</a></span>, <span class='object_link'><a href="Module/UI/Message/Verbose.html#vprint_good-instance_method" title="Msf::Module::UI::Message::Verbose#vprint_good (method)">#vprint_good</a></span>, <span class='object_link'><a href="Module/UI/Message/Verbose.html#vprint_status-instance_method" title="Msf::Module::UI::Message::Verbose#vprint_status (method)">#vprint_status</a></span>, <span class='object_link'><a href="Module/UI/Message/Verbose.html#vprint_warning-instance_method" title="Msf::Module::UI::Message::Verbose#vprint_warning (method)">#vprint_warning</a></span></p>

  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="Module/UI/Line.html" title="Msf::Module::UI::Line (module)">Module::UI::Line</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="Module/UI/Line.html#print_line-instance_method" title="Msf::Module::UI::Line#print_line (method)">#print_line</a></span>, <span class='object_link'><a href="Module/UI/Line.html#print_line_prefix-instance_method" title="Msf::Module::UI::Line#print_line_prefix (method)">#print_line_prefix</a></span></p>

  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="Module/UI/Line/Verbose.html" title="Msf::Module::UI::Line::Verbose (module)">Module::UI::Line::Verbose</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="Module/UI/Line/Verbose.html#vprint_line-instance_method" title="Msf::Module::UI::Line::Verbose#vprint_line (method)">#vprint_line</a></span></p>

  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="../Rex/Ui/Subscriber.html" title="Rex::Ui::Subscriber (module)">Rex::Ui::Subscriber</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="../Rex/Ui/Subscriber.html#copy_ui-instance_method" title="Rex::Ui::Subscriber#copy_ui (method)">#copy_ui</a></span>, <span class='object_link'><a href="../Rex/Ui/Subscriber.html#init_ui-instance_method" title="Rex::Ui::Subscriber#init_ui (method)">#init_ui</a></span>, <span class='object_link'><a href="../Rex/Ui/Subscriber.html#reset_ui-instance_method" title="Rex::Ui::Subscriber#reset_ui (method)">#reset_ui</a></span></p>

  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="../Rex/Ui/Subscriber/Input.html" title="Rex::Ui::Subscriber::Input (module)">Rex::Ui::Subscriber::Input</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="../Rex/Ui/Subscriber/Input.html#gets-instance_method" title="Rex::Ui::Subscriber::Input#gets (method)">#gets</a></span></p>

  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="../Rex/Ui/Subscriber/Output.html" title="Rex::Ui::Subscriber::Output (module)">Rex::Ui::Subscriber::Output</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="../Rex/Ui/Subscriber/Output.html#flush-instance_method" title="Rex::Ui::Subscriber::Output#flush (method)">#flush</a></span>, <span class='object_link'><a href="../Rex/Ui/Subscriber/Output.html#print-instance_method" title="Rex::Ui::Subscriber::Output#print (method)">#print</a></span>, <span class='object_link'><a href="../Rex/Ui/Subscriber/Output.html#print_blank_line-instance_method" title="Rex::Ui::Subscriber::Output#print_blank_line (method)">#print_blank_line</a></span>, <span class='object_link'><a href="../Rex/Ui/Subscriber/Output.html#print_error-instance_method" title="Rex::Ui::Subscriber::Output#print_error (method)">#print_error</a></span>, <span class='object_link'><a href="../Rex/Ui/Subscriber/Output.html#print_good-instance_method" title="Rex::Ui::Subscriber::Output#print_good (method)">#print_good</a></span>, <span class='object_link'><a href="../Rex/Ui/Subscriber/Output.html#print_line-instance_method" title="Rex::Ui::Subscriber::Output#print_line (method)">#print_line</a></span>, <span class='object_link'><a href="../Rex/Ui/Subscriber/Output.html#print_status-instance_method" title="Rex::Ui::Subscriber::Output#print_status (method)">#print_status</a></span>, <span class='object_link'><a href="../Rex/Ui/Subscriber/Output.html#print_warning-instance_method" title="Rex::Ui::Subscriber::Output#print_warning (method)">#print_warning</a></span></p>

  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="Module/Type.html" title="Msf::Module::Type (module)">Module::Type</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="Module/Type.html#auxiliary%3F-instance_method" title="Msf::Module::Type#auxiliary? (method)">#auxiliary?</a></span>, <span class='object_link'><a href="Module/Type.html#encoder%3F-instance_method" title="Msf::Module::Type#encoder? (method)">#encoder?</a></span>, <span class='object_link'><a href="Module/Type.html#exploit%3F-instance_method" title="Msf::Module::Type#exploit? (method)">#exploit?</a></span>, <span class='object_link'><a href="Module/Type.html#nop%3F-instance_method" title="Msf::Module::Type#nop? (method)">#nop?</a></span>, <span class='object_link'><a href="Module/Type.html#payload%3F-instance_method" title="Msf::Module::Type#payload? (method)">#payload?</a></span>, <span class='object_link'><a href="Module/Type.html#post%3F-instance_method" title="Msf::Module::Type#post? (method)">#post?</a></span></p>

  
  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="Module/Search.html" title="Msf::Module::Search (module)">Module::Search</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="Module/Search.html#search_filter-instance_method" title="Msf::Module::Search#search_filter (method)">#search_filter</a></span></p>

  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="Module/Ranking.html" title="Msf::Module::Ranking (module)">Module::Ranking</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="Module/Ranking.html#rank-instance_method" title="Msf::Module::Ranking#rank (method)">#rank</a></span>, <span class='object_link'><a href="Module/Ranking.html#rank_to_h-instance_method" title="Msf::Module::Ranking#rank_to_h (method)">#rank_to_h</a></span>, <span class='object_link'><a href="Module/Ranking.html#rank_to_s-instance_method" title="Msf::Module::Ranking#rank_to_s (method)">#rank_to_s</a></span></p>

  
  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="Module/Privileged.html" title="Msf::Module::Privileged (module)">Module::Privileged</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="Module/Privileged.html#privileged%3F-instance_method" title="Msf::Module::Privileged#privileged? (method)">#privileged?</a></span></p>

  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="Module/Options.html" title="Msf::Module::Options (module)">Module::Options</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="Module/Options.html#deregister_options-instance_method" title="Msf::Module::Options#deregister_options (method)">#deregister_options</a></span>, <span class='object_link'><a href="Module/Options.html#register_advanced_options-instance_method" title="Msf::Module::Options#register_advanced_options (method)">#register_advanced_options</a></span>, <span class='object_link'><a href="Module/Options.html#register_evasion_options-instance_method" title="Msf::Module::Options#register_evasion_options (method)">#register_evasion_options</a></span>, <span class='object_link'><a href="Module/Options.html#register_options-instance_method" title="Msf::Module::Options#register_options (method)">#register_options</a></span>, <span class='object_link'><a href="Module/Options.html#validate-instance_method" title="Msf::Module::Options#validate (method)">#validate</a></span></p>

  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="Module/Network.html" title="Msf::Module::Network (module)">Module::Network</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="Module/Network.html#comm-instance_method" title="Msf::Module::Network#comm (method)">#comm</a></span>, <span class='object_link'><a href="Module/Network.html#support_ipv6%3F-instance_method" title="Msf::Module::Network#support_ipv6? (method)">#support_ipv6?</a></span>, <span class='object_link'><a href="Module/Network.html#target_host-instance_method" title="Msf::Module::Network#target_host (method)">#target_host</a></span>, <span class='object_link'><a href="Module/Network.html#target_port-instance_method" title="Msf::Module::Network#target_port (method)">#target_port</a></span></p>

  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="Module/ModuleStore.html" title="Msf::Module::ModuleStore (module)">Module::ModuleStore</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="Module/ModuleStore.html#%5B%5D-instance_method" title="Msf::Module::ModuleStore#[] (method)">#[]</a></span>, <span class='object_link'><a href="Module/ModuleStore.html#%5B%5D%3D-instance_method" title="Msf::Module::ModuleStore#[]= (method)">#[]=</a></span></p>

  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="Module/ModuleInfo.html" title="Msf::Module::ModuleInfo (module)">Module::ModuleInfo</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="Module/ModuleInfo.html#alias-instance_method" title="Msf::Module::ModuleInfo#alias (method)">#alias</a></span>, <span class='object_link'><a href="Module/ModuleInfo.html#description-instance_method" title="Msf::Module::ModuleInfo#description (method)">#description</a></span>, <span class='object_link'><a href="Module/ModuleInfo.html#disclosure_date-instance_method" title="Msf::Module::ModuleInfo#disclosure_date (method)">#disclosure_date</a></span>, <span class='object_link'><a href="Module/ModuleInfo.html#info_fixups-instance_method" title="Msf::Module::ModuleInfo#info_fixups (method)">#info_fixups</a></span>, <span class='object_link'><a href="Module/ModuleInfo.html#merge_check_key-instance_method" title="Msf::Module::ModuleInfo#merge_check_key (method)">#merge_check_key</a></span>, <span class='object_link'><a href="Module/ModuleInfo.html#merge_info-instance_method" title="Msf::Module::ModuleInfo#merge_info (method)">#merge_info</a></span>, <span class='object_link'><a href="Module/ModuleInfo.html#merge_info_advanced_options-instance_method" title="Msf::Module::ModuleInfo#merge_info_advanced_options (method)">#merge_info_advanced_options</a></span>, <span class='object_link'><a href="Module/ModuleInfo.html#merge_info_alias-instance_method" title="Msf::Module::ModuleInfo#merge_info_alias (method)">#merge_info_alias</a></span>, <span class='object_link'><a href="Module/ModuleInfo.html#merge_info_description-instance_method" title="Msf::Module::ModuleInfo#merge_info_description (method)">#merge_info_description</a></span>, <span class='object_link'><a href="Module/ModuleInfo.html#merge_info_evasion_options-instance_method" title="Msf::Module::ModuleInfo#merge_info_evasion_options (method)">#merge_info_evasion_options</a></span>, <span class='object_link'><a href="Module/ModuleInfo.html#merge_info_name-instance_method" title="Msf::Module::ModuleInfo#merge_info_name (method)">#merge_info_name</a></span>, <span class='object_link'><a href="Module/ModuleInfo.html#merge_info_options-instance_method" title="Msf::Module::ModuleInfo#merge_info_options (method)">#merge_info_options</a></span>, <span class='object_link'><a href="Module/ModuleInfo.html#merge_info_string-instance_method" title="Msf::Module::ModuleInfo#merge_info_string (method)">#merge_info_string</a></span>, <span class='object_link'><a href="Module/ModuleInfo.html#merge_info_version-instance_method" title="Msf::Module::ModuleInfo#merge_info_version (method)">#merge_info_version</a></span>, <span class='object_link'><a href="Module/ModuleInfo.html#name-instance_method" title="Msf::Module::ModuleInfo#name (method)">#name</a></span>, <span class='object_link'><a href="Module/ModuleInfo.html#update_info-instance_method" title="Msf::Module::ModuleInfo#update_info (method)">#update_info</a></span></p>

  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="Module/FullName.html" title="Msf::Module::FullName (module)">Module::FullName</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="Module/FullName.html#fullname-instance_method" title="Msf::Module::FullName#fullname (method)">#fullname</a></span>, <span class='object_link'><a href="Module/FullName.html#refname-instance_method" title="Msf::Module::FullName#refname (method)">#refname</a></span>, <span class='object_link'><a href="Module/FullName.html#shortname-instance_method" title="Msf::Module::FullName#shortname (method)">#shortname</a></span></p>

  
  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="Module/DataStore.html" title="Msf::Module::DataStore (module)">Module::DataStore</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="Module/DataStore.html#import_defaults-instance_method" title="Msf::Module::DataStore#import_defaults (method)">#import_defaults</a></span>, <span class='object_link'><a href="Module/DataStore.html#share_datastore-instance_method" title="Msf::Module::DataStore#share_datastore (method)">#share_datastore</a></span></p>

  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="Module/Compatibility.html" title="Msf::Module::Compatibility (module)">Module::Compatibility</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="Module/Compatibility.html#compat-instance_method" title="Msf::Module::Compatibility#compat (method)">#compat</a></span>, <span class='object_link'><a href="Module/Compatibility.html#compatible%3F-instance_method" title="Msf::Module::Compatibility#compatible? (method)">#compatible?</a></span></p>

  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="Module/Author.html" title="Msf::Module::Author (module)">Module::Author</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="Module/Author.html#author_to_s-instance_method" title="Msf::Module::Author#author_to_s (method)">#author_to_s</a></span>, <span class='object_link'><a href="Module/Author.html#each_author-instance_method" title="Msf::Module::Author#each_author (method)">#each_author</a></span></p>

  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="Module/Arch.html" title="Msf::Module::Arch (module)">Module::Arch</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="Module/Arch.html#arch%3F-instance_method" title="Msf::Module::Arch#arch? (method)">#arch?</a></span>, <span class='object_link'><a href="Module/Arch.html#arch_to_s-instance_method" title="Msf::Module::Arch#arch_to_s (method)">#arch_to_s</a></span>, <span class='object_link'><a href="Module/Arch.html#each_arch-instance_method" title="Msf::Module::Arch#each_arch (method)">#each_arch</a></span></p>
<div id="constructor_details" class="method_details_list">
  <h2>Constructor Details</h2>
  
    <div class="method_details first">
  <h3 class="signature first" id="initialize-instance_method">
  
    - (<tt><span class='object_link'><a href="" title="Msf::Exploit (class)">Exploit</a></span></tt>) <strong>initialize</strong>(info = {}) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Creates an instance of the exploit module.  Mad skillz.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/exploit.rb', line 269</span>

<span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span><span class='lparen'>(</span><span class='id identifier rubyid_info'>info</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span>

  <span class='comment'># Ghetto compat mirroring for payload compatibilities.  This mirrors
</span>  <span class='comment'>#
</span>  <span class='comment'># Payload =&gt; Compat =&gt; xyz
</span>  <span class='comment'>#
</span>  <span class='comment'># to
</span>  <span class='comment'>#
</span>  <span class='comment'># Compat =&gt; Payload =&gt; xyz
</span>  <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_info'>info</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Payload</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='kw'>and</span> <span class='id identifier rubyid_info'>info</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Payload</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Compat</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_info'>info</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Compat</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='const'>Hash</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_info'>info</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Compat</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>==</span> <span class='kw'>nil</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_info'>info</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Compat</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Payload</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='const'>Hash</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_info'>info</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Compat</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Payload</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>==</span> <span class='kw'>nil</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_info'>info</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Compat</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Payload</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_update'>update</span><span class='lparen'>(</span><span class='id identifier rubyid_info'>info</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Payload</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Compat</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='comment'># Call the parent constructor after making any necessary modifications
</span>  <span class='comment'># to the information hash.
</span>  <span class='kw'>super</span><span class='lparen'>(</span><span class='id identifier rubyid_info'>info</span><span class='rparen'>)</span>

  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_targets'>targets</span> <span class='op'>=</span> <span class='const'>Rex</span><span class='op'>::</span><span class='const'>Transformer</span><span class='period'>.</span><span class='id identifier rubyid_transform'>transform</span><span class='lparen'>(</span><span class='id identifier rubyid_info'>info</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Targets</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='const'>Array</span><span class='comma'>,</span>
      <span class='lbracket'>[</span> <span class='const'>Target</span> <span class='rbracket'>]</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Targets</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_default_target'>default_target</span> <span class='op'>=</span> <span class='id identifier rubyid_info'>info</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>DefaultTarget</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_payload_info'>payload_info</span> <span class='op'>=</span> <span class='id identifier rubyid_info'>info</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Payload</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_successful'>successful</span> <span class='op'>=</span> <span class='kw'>false</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_session_count'>session_count</span> <span class='op'>=</span> <span class='int'>0</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_active_timeout'>active_timeout</span> <span class='op'>=</span> <span class='int'>120</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_fail_reason'>fail_reason</span> <span class='op'>=</span> <span class='const'>Failure</span><span class='op'>::</span><span class='const'>None</span>

  <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_info'>info</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Payload</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='kw'>and</span> <span class='id identifier rubyid_info'>info</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Payload</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>ActiveTimeout</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='rparen'>)</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_active_timeout'>active_timeout</span> <span class='op'>=</span> <span class='id identifier rubyid_info'>info</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Payload</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>ActiveTimeout</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span>
  <span class='kw'>end</span>

  <span class='comment'># All exploits can increase the delay when waiting for a session.
</span>  <span class='comment'># However, this only applies to aggressive exploits.
</span>  <span class='kw'>if</span> <span class='id identifier rubyid_aggressive?'>aggressive?</span>
    <span class='id identifier rubyid_register_advanced_options'>register_advanced_options</span><span class='lparen'>(</span>
      <span class='lbracket'>[</span>
        <span class='const'>OptInt</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>WfsDelay</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='lbracket'>[</span> <span class='kw'>false</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Additional delay when waiting for a session</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>0</span> <span class='rbracket'>]</span><span class='rparen'>)</span>
      <span class='rbracket'>]</span><span class='comma'>,</span> <span class='const'>Msf</span><span class='op'>::</span><span class='const'>Exploit</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='comment'># Allow all exploits to leverage context keyed encoding
</span>  <span class='id identifier rubyid_register_advanced_options'>register_advanced_options</span><span class='lparen'>(</span>
    <span class='lbracket'>[</span>
      <span class='const'>OptBool</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>EnableContextEncoding</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='lbracket'>[</span> <span class='kw'>false</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Use transient context when encoding payloads</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='kw'>false</span> <span class='rbracket'>]</span><span class='rparen'>)</span><span class='comma'>,</span>
      <span class='const'>OptPath</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>ContextInformationFile</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='lbracket'>[</span> <span class='kw'>false</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>The information file that contains context information</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='kw'>nil</span> <span class='rbracket'>]</span><span class='rparen'>)</span>
    <span class='rbracket'>]</span><span class='comma'>,</span> <span class='const'>Msf</span><span class='op'>::</span><span class='const'>Exploit</span><span class='rparen'>)</span>

  <span class='comment'># Allow all exploits to disable their payload handlers
</span>  <span class='id identifier rubyid_register_advanced_options'>register_advanced_options</span><span class='lparen'>(</span>
    <span class='lbracket'>[</span>
      <span class='const'>OptBool</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>DisablePayloadHandler</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='lbracket'>[</span> <span class='kw'>false</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Disable the handler code for the selected payload</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='kw'>false</span> <span class='rbracket'>]</span><span class='rparen'>)</span>
    <span class='rbracket'>]</span><span class='comma'>,</span> <span class='const'>Msf</span><span class='op'>::</span><span class='const'>Exploit</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
  
</div>

  <div id="instance_attr_details" class="attr_details">
    <h2>Instance Attribute Details</h2>
    
      
      <span id="active_timeout=-instance_method"></span>
      <div class="method_details first">
  <h3 class="signature first" id="active_timeout-instance_method">
  
    - (<tt>Object</tt>) <strong>active_timeout</strong>  <span class="extras">(protected)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Maximum number of seconds for active handlers</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1471
1472
1473</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/exploit.rb', line 1471</span>

<span class='kw'>def</span> <span class='id identifier rubyid_active_timeout'>active_timeout</span>
  <span class='ivar'>@active_timeout</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="default_target=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="default_target-instance_method">
  
    - (<tt>Object</tt>) <strong>default_target</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>The default target.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1424
1425
1426</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/exploit.rb', line 1424</span>

<span class='kw'>def</span> <span class='id identifier rubyid_default_target'>default_target</span>
  <span class='ivar'>@default_target</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="fail_detail=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="fail_detail-instance_method">
  
    - (<tt>Object</tt>) <strong>fail_detail</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Detailed exception string indicating why the exploit was not successful</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1415
1416
1417</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/exploit.rb', line 1415</span>

<span class='kw'>def</span> <span class='id identifier rubyid_fail_detail'>fail_detail</span>
  <span class='ivar'>@fail_detail</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="fail_reason=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="fail_reason-instance_method">
  
    - (<tt>Object</tt>) <strong>fail_reason</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>The reason why the exploit was not successful (one of Msf::Module::Failure)</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1410
1411
1412</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/exploit.rb', line 1410</span>

<span class='kw'>def</span> <span class='id identifier rubyid_fail_reason'>fail_reason</span>
  <span class='ivar'>@fail_reason</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="payload=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="payload-instance_method">
  
    - (<tt>Object</tt>) <strong>payload</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>The encoded payload instance.  An instance of an EncodedPayload object.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1437
1438
1439</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/exploit.rb', line 1437</span>

<span class='kw'>def</span> <span class='id identifier rubyid_payload'>payload</span>
  <span class='ivar'>@payload</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="payload_info=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="payload_info-instance_method">
  
    - (<tt>Object</tt>) <strong>payload_info</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>The payload requirement hash.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1428
1429
1430</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/exploit.rb', line 1428</span>

<span class='kw'>def</span> <span class='id identifier rubyid_payload_info'>payload_info</span>
  <span class='ivar'>@payload_info</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="payload_instance=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="payload_instance-instance_method">
  
    - (<tt>Object</tt>) <strong>payload_instance</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>The active payload instance.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1432
1433
1434</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/exploit.rb', line 1432</span>

<span class='kw'>def</span> <span class='id identifier rubyid_payload_instance'>payload_instance</span>
  <span class='ivar'>@payload_instance</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="session_count=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="session_count-instance_method">
  
    - (<tt>Object</tt>) <strong>session_count</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>The number of active sessions created by this instance</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1442
1443
1444</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/exploit.rb', line 1442</span>

<span class='kw'>def</span> <span class='id identifier rubyid_session_count'>session_count</span>
  <span class='ivar'>@session_count</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="successful=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="successful-instance_method">
  
    - (<tt>Object</tt>) <strong>successful</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>The boolean indicating whether the exploit succeeded</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1447
1448
1449</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/exploit.rb', line 1447</span>

<span class='kw'>def</span> <span class='id identifier rubyid_successful'>successful</span>
  <span class='ivar'>@successful</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="targets=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="targets-instance_method">
  
    - (<tt>Object</tt>) <strong>targets</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>The list of targets.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1420
1421
1422</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/exploit.rb', line 1420</span>

<span class='kw'>def</span> <span class='id identifier rubyid_targets'>targets</span>
  <span class='ivar'>@targets</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>


  <div id="class_method_details" class="method_details_list">
    <h2>Class Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="mixins-class_method">
  
    + (<tt>Array</tt>) <strong>mixins</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns an array of all of the exploit mixins.  Lame algorithm right now.
We search the Msf::Exploit namespace for all modules that do not have any
constants in them.  In the future we can replace this with a better
algorithm.  It&#39;s just important that it returns an array of all of the
mixin modules.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Array</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/exploit.rb', line 234</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_mixins'>mixins</span>
  <span class='id identifier rubyid_mixins'>mixins</span>  <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_wl'>wl</span>      <span class='op'>=</span> <span class='lbracket'>[</span> <span class='const'>Msf</span><span class='op'>::</span><span class='const'>Exploit</span> <span class='rbracket'>]</span>
  <span class='id identifier rubyid_visited'>visited</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>

  <span class='kw'>until</span> <span class='id identifier rubyid_wl'>wl</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span> <span class='op'>==</span> <span class='int'>0</span>
    <span class='id identifier rubyid_wl'>wl</span><span class='period'>.</span><span class='id identifier rubyid_delete_if'>delete_if</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_mod'>mod</span><span class='op'>|</span>
      <span class='id identifier rubyid_mod'>mod</span><span class='period'>.</span><span class='id identifier rubyid_constants'>constants</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_const'>const</span><span class='op'>|</span>
        <span class='id identifier rubyid_child'>child</span> <span class='op'>=</span> <span class='id identifier rubyid_mod'>mod</span><span class='period'>.</span><span class='id identifier rubyid_const_get'>const_get</span><span class='lparen'>(</span><span class='id identifier rubyid_const'>const</span><span class='rparen'>)</span>

        <span class='kw'>next</span> <span class='kw'>if</span> <span class='id identifier rubyid_child'>child</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span> <span class='op'>!~</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^Msf::Exploit</span><span class='regexp_end'>/</span></span>

        <span class='kw'>next</span> <span class='kw'>if</span> <span class='id identifier rubyid_visited'>visited</span><span class='lbracket'>[</span><span class='id identifier rubyid_child'>child</span><span class='rbracket'>]</span>

        <span class='kw'>next</span> <span class='kw'>if</span> <span class='id identifier rubyid_child'>child</span><span class='period'>.</span><span class='id identifier rubyid_kind_of?'>kind_of?</span><span class='lparen'>(</span><span class='op'>::</span><span class='const'>Module</span><span class='rparen'>)</span> <span class='op'>==</span> <span class='kw'>false</span>

        <span class='id identifier rubyid_visited'>visited</span><span class='lbracket'>[</span><span class='id identifier rubyid_child'>child</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='kw'>true</span>

        <span class='kw'>if</span> <span class='id identifier rubyid_child'>child</span><span class='period'>.</span><span class='id identifier rubyid_constants'>constants</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span> <span class='op'>&gt;</span> <span class='int'>0</span>
          <span class='id identifier rubyid_wl'>wl</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_child'>child</span>
        <span class='kw'>else</span>
          <span class='id identifier rubyid_mixins'>mixins</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_child'>child</span>
        <span class='kw'>end</span>
      <span class='rbrace'>}</span>

      <span class='kw'>true</span>
    <span class='rbrace'>}</span>
  <span class='kw'>end</span>

  <span class='kw'>return</span> <span class='id identifier rubyid_mixins'>mixins</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="type-class_method">
  
    + (<tt>Object</tt>) <strong>type</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns MODULE_EXPLOIT to indicate that this is an exploit module.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


623
624
625</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/exploit.rb', line 623</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_type'>type</span>
  <span class='const'>Msf</span><span class='op'>::</span><span class='const'>MODULE_EXPLOIT</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="add_handler-instance_method">
  
    - (<tt>Object</tt>) <strong>add_handler</strong>(opts = {}) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Allows the payload handler to spawn a new monitor</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


468
469
470
471
472</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/exploit.rb', line 468</span>

<span class='kw'>def</span> <span class='id identifier rubyid_add_handler'>add_handler</span><span class='lparen'>(</span><span class='id identifier rubyid_opts'>opts</span><span class='op'>=</span><span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='kw'>if</span> <span class='kw'>not</span> <span class='id identifier rubyid_payload_instance'>payload_instance</span>
  <span class='kw'>return</span> <span class='kw'>if</span> <span class='kw'>not</span> <span class='id identifier rubyid_handler_enabled?'>handler_enabled?</span>
  <span class='id identifier rubyid_payload_instance'>payload_instance</span><span class='period'>.</span><span class='id identifier rubyid_add_handler'>add_handler</span><span class='lparen'>(</span><span class='id identifier rubyid_opts'>opts</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="aggressive?-instance_method">
  
    - (<tt>Boolean</tt>) <strong>aggressive?</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns true if the exploit has an aggressive stance.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


651
652
653</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/exploit.rb', line 651</span>

<span class='kw'>def</span> <span class='id identifier rubyid_aggressive?'>aggressive?</span>
  <span class='lparen'>(</span><span class='id identifier rubyid_stance'>stance</span> <span class='op'>==</span> <span class='const'>Stance</span><span class='op'>::</span><span class='const'>Aggressive</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="autofilter-instance_method">
  
    - (<tt>Object</tt>) <strong>autofilter</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Performs last-minute sanity checking of auxiliary parameters. This method
is called during automated exploitation attempts and allows an auxiliary
module to filter bad attempts, obtain more information, and choose better
parameters based on the available data. Returning anything that evaluates
to “false” will cause this specific auxiliary attempt to be skipped. This
method can and will change datastore values and may interact with the
backend database.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


354
355
356</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/exploit.rb', line 354</span>

<span class='kw'>def</span> <span class='id identifier rubyid_autofilter'>autofilter</span>
  <span class='kw'>true</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="autofilter_ports-instance_method">
  
    - (<tt>Object</tt>) <strong>autofilter_ports</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Provides a list of ports that can be used for matching this module against
target systems.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


362
363
364</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/exploit.rb', line 362</span>

<span class='kw'>def</span> <span class='id identifier rubyid_autofilter_ports'>autofilter_ports</span>
  <span class='ivar'>@autofilter_ports</span> <span class='op'>||</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="autofilter_services-instance_method">
  
    - (<tt>Object</tt>) <strong>autofilter_services</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Provides a list of services that can be used for matching this module
against target systems.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


370
371
372</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/exploit.rb', line 370</span>

<span class='kw'>def</span> <span class='id identifier rubyid_autofilter_services'>autofilter_services</span>
  <span class='ivar'>@autofilter_services</span> <span class='op'>||</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="capabilities-instance_method">
  
    - (<tt>Object</tt>) <strong>capabilities</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns a hash of the capabilities this exploit module has support for,
such as whether or not it supports check and exploit.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


605
606
607
608
609
610</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/exploit.rb', line 605</span>

<span class='kw'>def</span> <span class='id identifier rubyid_capabilities'>capabilities</span>
  <span class='lbrace'>{</span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>check</span><span class='tstring_end'>&#39;</span></span>       <span class='op'>=&gt;</span> <span class='id identifier rubyid_supports_check?'>supports_check?</span><span class='comma'>,</span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>exploit</span><span class='tstring_end'>&#39;</span></span>     <span class='op'>=&gt;</span> <span class='id identifier rubyid_supports_exploit?'>supports_exploit?</span>
  <span class='rbrace'>}</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="cleanup-instance_method">
  
    - (<tt>Object</tt>) <strong>cleanup</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Performs any cleanup that may be necessary, such as disconnecting
connections and any other such fun things.  If a payload is active then its
handler cleanup routines are called as well.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


420
421
422
423
424
425</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/exploit.rb', line 420</span>

<span class='kw'>def</span> <span class='id identifier rubyid_cleanup'>cleanup</span>
  <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_payload_instance'>payload_instance</span> <span class='kw'>and</span> <span class='id identifier rubyid_handler_enabled?'>handler_enabled?</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_payload_instance'>payload_instance</span><span class='period'>.</span><span class='id identifier rubyid_cleanup_handler'>cleanup_handler</span>
  <span class='kw'>end</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_abort_sockets'>abort_sockets</span> <span class='kw'>if</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_respond_to?'>respond_to?</span><span class='lparen'>(</span><span class='symbol'>:abort_sockets</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="compatible_encoders-instance_method">
  
    - (<tt>Object</tt>) <strong>compatible_encoders</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns a list of compatible encoders based on architecture</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


758
759
760
761
762
763
764
765
766
767
768
769
770
771</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/exploit.rb', line 758</span>

<span class='kw'>def</span> <span class='id identifier rubyid_compatible_encoders'>compatible_encoders</span>
  <span class='id identifier rubyid_encoders'>encoders</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>

  <span class='id identifier rubyid_c_platform'>c_platform</span> <span class='op'>=</span> <span class='lparen'>(</span><span class='id identifier rubyid_target'>target</span> <span class='kw'>and</span> <span class='id identifier rubyid_target'>target</span><span class='period'>.</span><span class='id identifier rubyid_platform'>platform</span><span class='rparen'>)</span> <span class='op'>?</span> <span class='id identifier rubyid_target'>target</span><span class='period'>.</span><span class='id identifier rubyid_platform'>platform</span> <span class='op'>:</span> <span class='id identifier rubyid_platform'>platform</span>
  <span class='id identifier rubyid_c_arch'>c_arch</span>     <span class='op'>=</span> <span class='lparen'>(</span><span class='id identifier rubyid_target'>target</span> <span class='kw'>and</span> <span class='id identifier rubyid_target'>target</span><span class='period'>.</span><span class='id identifier rubyid_arch'>arch</span><span class='rparen'>)</span>     <span class='op'>?</span> <span class='id identifier rubyid_target'>target</span><span class='period'>.</span><span class='id identifier rubyid_arch'>arch</span>     <span class='op'>:</span> <span class='lparen'>(</span><span class='id identifier rubyid_arch'>arch</span> <span class='op'>==</span> <span class='lbracket'>[</span><span class='rbracket'>]</span><span class='rparen'>)</span> <span class='op'>?</span> <span class='kw'>nil</span> <span class='op'>:</span> <span class='id identifier rubyid_arch'>arch</span>

  <span class='id identifier rubyid_framework'>framework</span><span class='period'>.</span><span class='id identifier rubyid_encoders'>encoders</span><span class='period'>.</span><span class='id identifier rubyid_each_module_ranked'>each_module_ranked</span><span class='lparen'>(</span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Arch</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_c_arch'>c_arch</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Platform</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_c_platform'>c_platform</span><span class='rparen'>)</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_mod'>mod</span><span class='op'>|</span>

    <span class='id identifier rubyid_encoders'>encoders</span> <span class='op'>&lt;&lt;</span> <span class='lbracket'>[</span> <span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_mod'>mod</span> <span class='rbracket'>]</span>
  <span class='rbrace'>}</span>

  <span class='kw'>return</span> <span class='id identifier rubyid_encoders'>encoders</span><span class='semicolon'>;</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="compatible_payloads-instance_method">
  
    - (<tt>Object</tt>) <strong>compatible_payloads</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns a list of compatible payloads based on platform, architecture, and
size requirements.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


719
720
721
722
723
724
725
726
727
728
729
730
731
732
733
734
735
736
737
738
739
740
741
742
743
744
745
746
747
748
749
750
751
752
753</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/exploit.rb', line 719</span>

<span class='kw'>def</span> <span class='id identifier rubyid_compatible_payloads'>compatible_payloads</span>
  <span class='id identifier rubyid_payloads'>payloads</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>


  <span class='id identifier rubyid_c_platform'>c_platform</span> <span class='op'>=</span> <span class='lparen'>(</span><span class='id identifier rubyid_target'>target</span> <span class='kw'>and</span> <span class='id identifier rubyid_target'>target</span><span class='period'>.</span><span class='id identifier rubyid_platform'>platform</span><span class='rparen'>)</span> <span class='op'>?</span> <span class='id identifier rubyid_target'>target</span><span class='period'>.</span><span class='id identifier rubyid_platform'>platform</span> <span class='op'>:</span> <span class='id identifier rubyid_platform'>platform</span>
  <span class='id identifier rubyid_c_arch'>c_arch</span>     <span class='op'>=</span> <span class='lparen'>(</span><span class='id identifier rubyid_target'>target</span> <span class='kw'>and</span> <span class='id identifier rubyid_target'>target</span><span class='period'>.</span><span class='id identifier rubyid_arch'>arch</span><span class='rparen'>)</span>     <span class='op'>?</span> <span class='id identifier rubyid_target'>target</span><span class='period'>.</span><span class='id identifier rubyid_arch'>arch</span>     <span class='op'>:</span> <span class='lparen'>(</span><span class='id identifier rubyid_arch'>arch</span> <span class='op'>==</span> <span class='lbracket'>[</span><span class='rbracket'>]</span><span class='rparen'>)</span> <span class='op'>?</span> <span class='kw'>nil</span> <span class='op'>:</span> <span class='id identifier rubyid_arch'>arch</span>
  <span class='id identifier rubyid_c_arch'>c_arch</span>   <span class='op'>||=</span> <span class='lbracket'>[</span> <span class='const'>ARCH_X86</span> <span class='rbracket'>]</span>

  <span class='id identifier rubyid_framework'>framework</span><span class='period'>.</span><span class='id identifier rubyid_payloads'>payloads</span><span class='period'>.</span><span class='id identifier rubyid_each_module'>each_module</span><span class='lparen'>(</span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Platform</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_c_platform'>c_platform</span><span class='comma'>,</span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Arch</span><span class='tstring_end'>&#39;</span></span>     <span class='op'>=&gt;</span> <span class='id identifier rubyid_c_arch'>c_arch</span> <span class='rparen'>)</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_mod'>mod</span><span class='op'>|</span>

    <span class='comment'># Skip over payloads that are too big
</span>    <span class='kw'>if</span> <span class='lparen'>(</span><span class='lparen'>(</span><span class='id identifier rubyid_payload_space'>payload_space</span><span class='rparen'>)</span> <span class='kw'>and</span>
        <span class='lparen'>(</span><span class='id identifier rubyid_framework'>framework</span><span class='period'>.</span><span class='id identifier rubyid_payloads'>payloads</span><span class='period'>.</span><span class='id identifier rubyid_sizes'>sizes</span><span class='lbracket'>[</span><span class='id identifier rubyid_name'>name</span><span class='rbracket'>]</span><span class='rparen'>)</span> <span class='kw'>and</span>
        <span class='lparen'>(</span><span class='id identifier rubyid_framework'>framework</span><span class='period'>.</span><span class='id identifier rubyid_payloads'>payloads</span><span class='period'>.</span><span class='id identifier rubyid_sizes'>sizes</span><span class='lbracket'>[</span><span class='id identifier rubyid_name'>name</span><span class='rbracket'>]</span> <span class='op'>&gt;</span> <span class='id identifier rubyid_payload_space'>payload_space</span><span class='rparen'>)</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_dlog'>dlog</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_refname'>refname</span><span class='embexpr_end'>}</span><span class='tstring_content'>: Skipping payload </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_name'>name</span><span class='embexpr_end'>}</span><span class='tstring_content'> for being too large</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>core</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
        <span class='const'>LEV_1</span><span class='rparen'>)</span>
      <span class='kw'>next</span>
    <span class='kw'>end</span>

    <span class='comment'># Are we compatible in terms of conventions and connections and
</span>    <span class='comment'># what not?
</span>    <span class='kw'>next</span> <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_compatible?'>compatible?</span><span class='lparen'>(</span><span class='id identifier rubyid_framework'>framework</span><span class='period'>.</span><span class='id identifier rubyid_payloads'>payloads</span><span class='period'>.</span><span class='id identifier rubyid_instance'>instance</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='rparen'>)</span><span class='rparen'>)</span> <span class='op'>==</span> <span class='kw'>false</span><span class='rparen'>)</span>

    <span class='comment'># If the payload is privileged but the exploit does not give
</span>    <span class='comment'># privileged access, then fail it.
</span>    <span class='kw'>next</span> <span class='kw'>if</span> <span class='lparen'>(</span><span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_privileged'>privileged</span> <span class='op'>==</span> <span class='kw'>false</span> <span class='kw'>and</span> <span class='id identifier rubyid_framework'>framework</span><span class='period'>.</span><span class='id identifier rubyid_payloads'>payloads</span><span class='period'>.</span><span class='id identifier rubyid_instance'>instance</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_privileged'>privileged</span> <span class='op'>==</span> <span class='kw'>true</span><span class='rparen'>)</span>

    <span class='comment'># This one be compatible!
</span>    <span class='id identifier rubyid_payloads'>payloads</span> <span class='op'>&lt;&lt;</span> <span class='lbracket'>[</span> <span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_mod'>mod</span> <span class='rbracket'>]</span>
  <span class='rbrace'>}</span>

  <span class='kw'>return</span> <span class='id identifier rubyid_payloads'>payloads</span><span class='semicolon'>;</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="define_context_encoding_reqs-instance_method">
  
    - (<tt>Object</tt>) <strong>define_context_encoding_reqs</strong>(reqs)  <span class="extras">(protected)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Gets the memory map file and other context information that is required
when wanting to support context keyed encoding</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1508
1509
1510
1511
1512
1513
1514
1515
1516
1517
1518
1519
1520</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/exploit.rb', line 1508</span>

<span class='kw'>def</span> <span class='id identifier rubyid_define_context_encoding_reqs'>define_context_encoding_reqs</span><span class='lparen'>(</span><span class='id identifier rubyid_reqs'>reqs</span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='kw'>if</span> <span class='id identifier rubyid_datastore'>datastore</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>EnableContextEncoding</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>!=</span> <span class='kw'>true</span>

  <span class='comment'># At present, we don&#39;t support any automatic methods of obtaining
</span>  <span class='comment'># context information.  In the future, we might support obtaining
</span>  <span class='comment'># temporal information remotely.
</span>
  <span class='comment'># Pass along the information specified in our exploit datastore as
</span>  <span class='comment'># encoder options
</span>  <span class='id identifier rubyid_reqs'>reqs</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>EncoderOptions</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span> <span class='kw'>if</span> <span class='id identifier rubyid_reqs'>reqs</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>EncoderOptions</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
  <span class='id identifier rubyid_reqs'>reqs</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>EncoderOptions</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>EnableContextEncoding</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>  <span class='op'>=</span> <span class='id identifier rubyid_datastore'>datastore</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>EnableContextEncoding</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_reqs'>reqs</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>EncoderOptions</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>ContextInformationFile</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_datastore'>datastore</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>ContextInformationFile</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="encode_begin-instance_method">
  
    - (<tt>Object</tt>) <strong>encode_begin</strong>(real_payload, reqs) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Called prior to encoding a payload.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


566
567</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/exploit.rb', line 566</span>

<span class='kw'>def</span> <span class='id identifier rubyid_encode_begin'>encode_begin</span><span class='lparen'>(</span><span class='id identifier rubyid_real_payload'>real_payload</span><span class='comma'>,</span> <span class='id identifier rubyid_reqs'>reqs</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="encode_end-instance_method">
  
    - (<tt>Object</tt>) <strong>encode_end</strong>(real_payload, reqs, encoded) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Called after an encoded payload has been generated.  This gives exploits or
mixins a chance to alter the encoded payload.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


573
574
575</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/exploit.rb', line 573</span>

<span class='kw'>def</span> <span class='id identifier rubyid_encode_end'>encode_end</span><span class='lparen'>(</span><span class='id identifier rubyid_real_payload'>real_payload</span><span class='comma'>,</span> <span class='id identifier rubyid_reqs'>reqs</span><span class='comma'>,</span> <span class='id identifier rubyid_encoded'>encoded</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_encoded'>encoded</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="encode_shellcode_stub-instance_method">
  
    - (<tt>Object</tt>) <strong>encode_shellcode_stub</strong>(code, badchars = payload_badchars) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Allows arbitrary shellcode to be encoded from within an exploit</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


449
450
451
452
453
454
455
456
457
458
459
460
461
462
463</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/exploit.rb', line 449</span>

<span class='kw'>def</span> <span class='id identifier rubyid_encode_shellcode_stub'>encode_shellcode_stub</span><span class='lparen'>(</span><span class='id identifier rubyid_code'>code</span><span class='comma'>,</span> <span class='id identifier rubyid_badchars'>badchars</span><span class='op'>=</span><span class='id identifier rubyid_payload_badchars'>payload_badchars</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_platform'>platform</span> <span class='op'>=</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_platform'>platform</span>
  <span class='kw'>if</span><span class='lparen'>(</span><span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_payload_instance'>payload_instance</span><span class='rparen'>)</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_payload_instance'>payload_instance</span><span class='period'>.</span><span class='id identifier rubyid_platform'>platform</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_compatible_encoders'>compatible_encoders</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_mod'>mod</span><span class='op'>|</span>
    <span class='kw'>begin</span>
      <span class='id identifier rubyid_enc'>enc</span> <span class='op'>=</span> <span class='id identifier rubyid_framework'>framework</span><span class='period'>.</span><span class='id identifier rubyid_encoders'>encoders</span><span class='period'>.</span><span class='id identifier rubyid_create'>create</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_raw'>raw</span> <span class='op'>=</span> <span class='id identifier rubyid_enc'>enc</span><span class='period'>.</span><span class='id identifier rubyid_encode'>encode</span><span class='lparen'>(</span><span class='id identifier rubyid_code'>code</span><span class='comma'>,</span> <span class='id identifier rubyid_badchars'>badchars</span><span class='comma'>,</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_platform'>platform</span><span class='rparen'>)</span>
      <span class='kw'>return</span> <span class='id identifier rubyid_raw'>raw</span> <span class='kw'>if</span> <span class='id identifier rubyid_raw'>raw</span>
    <span class='kw'>rescue</span> <span class='op'>::</span><span class='const'>Exception</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='kw'>nil</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="exploit-instance_method">
  
    - (<tt>Object</tt>) <strong>exploit</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Kicks off the actual exploit.  Prior to this call, the framework will have
validated the data store using the options associated with this exploit
module.  It will also pre-generate the desired payload, though exploits can
re-generate the payload if necessary.</p>

<p>This method is designed to be overriden by exploit modules.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


342
343</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/exploit.rb', line 342</span>

<span class='kw'>def</span> <span class='id identifier rubyid_exploit'>exploit</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="exploit_type-instance_method">
  
    - (<tt>Object</tt>) <strong>exploit_type</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>If we don&#39;t know the exploit type, then I guess it&#39;s omnipresent!</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


637
638
639</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/exploit.rb', line 637</span>

<span class='kw'>def</span> <span class='id identifier rubyid_exploit_type'>exploit_type</span>
  <span class='const'>Type</span><span class='op'>::</span><span class='const'>Omni</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="fail_with-instance_method">
  
    - (<tt>void</tt>) <strong>fail_with</strong>(reason, msg = nil) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note returns_void">This method returns an undefined value.</p>
<p>Raises a Msf::Exploit::Failed exception. It overrides the fail_with method
in lib/msf/core/module.rb</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
      <pre class="example code"><code><span class='id identifier rubyid_fail_with'>fail_with</span><span class='lparen'>(</span><span class='const'>Msf</span><span class='op'>::</span><span class='const'>Module</span><span class='op'>::</span><span class='const'>Failure</span><span class='op'>::</span><span class='const'>NoAccess</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Unable to login to upload payload</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span></code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>reason</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>A constant from Msf::Module::Failure. If the reason does not come from
there, then it will default to Msf::Module::Failure::Unknown.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>msg</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>nil</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>(Optional) A message about the failure.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Raises:</p>
<ul class="raise">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="Exploit/Failed.html" title="Msf::Exploit::Failed (class)">Msf::Exploit::Failed</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>A custom Msf::Exploit::Failed exception.</p>
</div>
      
    </li>
  
</ul>

  <p class="tag_title">See Also:</p>
  <ul class="see">
    
      <li><span class='object_link'><a href="Module/Failure.html" title="Msf::Module::Failure (module)">Module::Failure</a></span></li>
    
      <li><span class='object_link'><a href="Module.html#fail_with-instance_method" title="Msf::Module#fail_with (method)">Module#fail_with</a></span></li>
    
  </ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1252
1253
1254
1255
1256
1257
1258
1259
1260
1261
1262
1263
1264</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/exploit.rb', line 1252</span>

<span class='kw'>def</span> <span class='id identifier rubyid_fail_with'>fail_with</span><span class='lparen'>(</span><span class='id identifier rubyid_reason'>reason</span><span class='comma'>,</span><span class='id identifier rubyid_msg'>msg</span><span class='op'>=</span><span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='comment'># The reason being registered here will be used later on, so it&#39;s important we don&#39;t actually
</span>  <span class='comment'># provide a made-up one.
</span>  <span class='id identifier rubyid_allowed_values'>allowed_values</span> <span class='op'>=</span> <span class='const'>Msf</span><span class='op'>::</span><span class='const'>Module</span><span class='op'>::</span><span class='const'>Failure</span><span class='period'>.</span><span class='id identifier rubyid_constants'>constants</span><span class='period'>.</span><span class='id identifier rubyid_collect'>collect</span> <span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_e'>e</span><span class='op'>|</span> <span class='const'>Msf</span><span class='op'>::</span><span class='const'>Module</span><span class='op'>::</span><span class='const'>Failure</span><span class='period'>.</span><span class='id identifier rubyid_const_get'>const_get</span><span class='lparen'>(</span><span class='id identifier rubyid_e'>e</span><span class='rparen'>)</span><span class='rbrace'>}</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_allowed_values'>allowed_values</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_reason'>reason</span><span class='rparen'>)</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_fail_reason'>fail_reason</span> <span class='op'>=</span> <span class='id identifier rubyid_reason'>reason</span>
  <span class='kw'>else</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_fail_reason'>fail_reason</span> <span class='op'>=</span> <span class='const'>Msf</span><span class='op'>::</span><span class='const'>Module</span><span class='op'>::</span><span class='const'>Failure</span><span class='op'>::</span><span class='const'>Unknown</span>
  <span class='kw'>end</span>

  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_fail_detail'>fail_detail</span> <span class='op'>=</span> <span class='id identifier rubyid_msg'>msg</span>
  <span class='id identifier rubyid_raise'>raise</span> <span class='const'>Msf</span><span class='op'>::</span><span class='const'>Exploit</span><span class='op'>::</span><span class='const'>Failed</span><span class='comma'>,</span> <span class='lparen'>(</span><span class='id identifier rubyid_msg'>msg</span> <span class='op'>||</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>No failure message given</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="generate_payload-instance_method">
  
    - (<tt>Object</tt>) <strong>generate_payload</strong>(pinst = nil) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Generates the encoded version of the supplied payload using the payload
requirements specific to this exploit.  The encoded instance is returned to
the caller.  This method is exposed in the manner that it is such that
passive exploits and re-generate an encoded payload on the fly rather than
having to use the pre-generated one.</p>

<p>The return value is an EncodedPayload instance.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


436
437
438
439
440
441
442
443
444</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/exploit.rb', line 436</span>

<span class='kw'>def</span> <span class='id identifier rubyid_generate_payload'>generate_payload</span><span class='lparen'>(</span><span class='id identifier rubyid_pinst'>pinst</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='comment'># Set the encoded payload to the result of the encoding process
</span>  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_payload'>payload</span> <span class='op'>=</span> <span class='id identifier rubyid_generate_single_payload'>generate_single_payload</span><span class='lparen'>(</span><span class='id identifier rubyid_pinst'>pinst</span><span class='rparen'>)</span>

  <span class='comment'># Save the payload instance
</span>  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_payload_instance'>payload_instance</span> <span class='op'>=</span> <span class='lparen'>(</span><span class='id identifier rubyid_pinst'>pinst</span><span class='rparen'>)</span> <span class='op'>?</span> <span class='id identifier rubyid_pinst'>pinst</span> <span class='op'>:</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_payload_instance'>payload_instance</span>

  <span class='kw'>return</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_payload'>payload</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="generate_single_payload-instance_method">
  
    - (<tt>Object</tt>) <strong>generate_single_payload</strong>(pinst = nil, platform = nil, arch = nil, explicit_target = nil) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>This method generates a non-cached payload which is typically useful for
passive exploits that will have more than one client.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


478
479
480
481
482
483
484
485
486
487
488
489
490
491
492
493
494
495
496
497
498
499
500
501
502
503
504
505
506
507
508
509
510
511
512
513
514
515
516
517
518
519
520
521
522
523
524
525
526
527
528
529
530
531
532
533
534
535
536
537
538
539
540
541
542
543
544
545
546
547
548
549
550
551
552</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/exploit.rb', line 478</span>

<span class='kw'>def</span> <span class='id identifier rubyid_generate_single_payload'>generate_single_payload</span><span class='lparen'>(</span><span class='id identifier rubyid_pinst'>pinst</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_platform'>platform</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_arch'>arch</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_explicit_target'>explicit_target</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_explicit_target'>explicit_target</span> <span class='op'>||=</span> <span class='id identifier rubyid_target'>target</span>

  <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_explicit_target'>explicit_target</span> <span class='op'>==</span> <span class='kw'>nil</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'>MissingTargetError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>No target has been specified.</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
      <span class='id identifier rubyid_caller'>caller</span>
  <span class='kw'>end</span>

  <span class='comment'># If a payload instance was supplied, use it, otherwise
</span>  <span class='comment'># use the active payload instance
</span>  <span class='id identifier rubyid_real_payload'>real_payload</span> <span class='op'>=</span> <span class='lparen'>(</span><span class='id identifier rubyid_pinst'>pinst</span><span class='rparen'>)</span> <span class='op'>?</span> <span class='id identifier rubyid_pinst'>pinst</span> <span class='op'>:</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_payload_instance'>payload_instance</span>

  <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_real_payload'>real_payload</span> <span class='op'>==</span> <span class='kw'>nil</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'>MissingPayloadError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>No payload has been selected.</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
      <span class='id identifier rubyid_caller'>caller</span>
  <span class='kw'>end</span>

  <span class='comment'># If this is a generic payload, then we should specify the platform
</span>  <span class='comment'># and architecture so that it knows how to pass things on.
</span>  <span class='kw'>if</span> <span class='id identifier rubyid_real_payload'>real_payload</span><span class='period'>.</span><span class='id identifier rubyid_kind_of?'>kind_of?</span><span class='lparen'>(</span><span class='const'>Msf</span><span class='op'>::</span><span class='const'>Payload</span><span class='op'>::</span><span class='const'>Generic</span><span class='rparen'>)</span>
    <span class='comment'># Convert the architecture specified into an array.
</span>    <span class='kw'>if</span> <span class='id identifier rubyid_arch'>arch</span> <span class='kw'>and</span> <span class='id identifier rubyid_arch'>arch</span><span class='period'>.</span><span class='id identifier rubyid_kind_of?'>kind_of?</span><span class='lparen'>(</span><span class='const'>String</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_arch'>arch</span> <span class='op'>=</span> <span class='lbracket'>[</span> <span class='id identifier rubyid_arch'>arch</span> <span class='rbracket'>]</span>
    <span class='kw'>end</span>

    <span class='comment'># Define the explicit platform and architecture information only if
</span>    <span class='comment'># it&#39;s been specified.
</span>    <span class='kw'>if</span> <span class='id identifier rubyid_platform'>platform</span>
      <span class='id identifier rubyid_real_payload'>real_payload</span><span class='period'>.</span><span class='id identifier rubyid_explicit_platform'>explicit_platform</span> <span class='op'>=</span> <span class='const'>Msf</span><span class='op'>::</span><span class='const'>Module</span><span class='op'>::</span><span class='const'>PlatformList</span><span class='period'>.</span><span class='id identifier rubyid_transform'>transform</span><span class='lparen'>(</span><span class='id identifier rubyid_platform'>platform</span><span class='rparen'>)</span>
    <span class='kw'>end</span>

    <span class='kw'>if</span> <span class='id identifier rubyid_arch'>arch</span>
      <span class='id identifier rubyid_real_payload'>real_payload</span><span class='period'>.</span><span class='id identifier rubyid_explicit_arch'>explicit_arch</span> <span class='op'>=</span> <span class='id identifier rubyid_arch'>arch</span>
    <span class='kw'>end</span>

    <span class='comment'># Force it to reset so that it will find updated information.
</span>    <span class='id identifier rubyid_real_payload'>real_payload</span><span class='period'>.</span><span class='id identifier rubyid_reset'>reset</span>
  <span class='kw'>end</span>

  <span class='comment'># Duplicate the exploit payload requirements
</span>  <span class='id identifier rubyid_reqs'>reqs</span> <span class='op'>=</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_payload_info'>payload_info</span><span class='period'>.</span><span class='id identifier rubyid_dup'>dup</span>

  <span class='comment'># Pass save register requirements to the NOP generator
</span>  <span class='id identifier rubyid_reqs'>reqs</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Space</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>           <span class='op'>=</span> <span class='id identifier rubyid_payload_space'>payload_space</span><span class='lparen'>(</span><span class='id identifier rubyid_explicit_target'>explicit_target</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_reqs'>reqs</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>SaveRegisters</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>   <span class='op'>=</span> <span class='id identifier rubyid_nop_save_registers'>nop_save_registers</span><span class='lparen'>(</span><span class='id identifier rubyid_explicit_target'>explicit_target</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_reqs'>reqs</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Prepend</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>         <span class='op'>=</span> <span class='id identifier rubyid_payload_prepend'>payload_prepend</span><span class='lparen'>(</span><span class='id identifier rubyid_explicit_target'>explicit_target</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_reqs'>reqs</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>PrependEncoder</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>  <span class='op'>=</span> <span class='id identifier rubyid_payload_prepend_encoder'>payload_prepend_encoder</span><span class='lparen'>(</span><span class='id identifier rubyid_explicit_target'>explicit_target</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_reqs'>reqs</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>BadChars</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>        <span class='op'>=</span> <span class='id identifier rubyid_payload_badchars'>payload_badchars</span><span class='lparen'>(</span><span class='id identifier rubyid_explicit_target'>explicit_target</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_reqs'>reqs</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Append</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>          <span class='op'>=</span> <span class='id identifier rubyid_payload_append'>payload_append</span><span class='lparen'>(</span><span class='id identifier rubyid_explicit_target'>explicit_target</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_reqs'>reqs</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>AppendEncoder</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>   <span class='op'>=</span> <span class='id identifier rubyid_payload_append_encoder'>payload_append_encoder</span><span class='lparen'>(</span><span class='id identifier rubyid_explicit_target'>explicit_target</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_reqs'>reqs</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>MaxNops</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>         <span class='op'>=</span> <span class='id identifier rubyid_payload_max_nops'>payload_max_nops</span><span class='lparen'>(</span><span class='id identifier rubyid_explicit_target'>explicit_target</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_reqs'>reqs</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>MinNops</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>         <span class='op'>=</span> <span class='id identifier rubyid_payload_min_nops'>payload_min_nops</span><span class='lparen'>(</span><span class='id identifier rubyid_explicit_target'>explicit_target</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_reqs'>reqs</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Encoder</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>         <span class='op'>=</span> <span class='id identifier rubyid_datastore'>datastore</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>ENCODER</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_reqs'>reqs</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Nop</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>             <span class='op'>=</span> <span class='id identifier rubyid_datastore'>datastore</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>NOP</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_reqs'>reqs</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>EncoderType</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>     <span class='op'>=</span> <span class='id identifier rubyid_payload_encoder_type'>payload_encoder_type</span><span class='lparen'>(</span><span class='id identifier rubyid_explicit_target'>explicit_target</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_reqs'>reqs</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>EncoderOptions</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>  <span class='op'>=</span> <span class='id identifier rubyid_payload_encoder_options'>payload_encoder_options</span><span class='lparen'>(</span><span class='id identifier rubyid_explicit_target'>explicit_target</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_reqs'>reqs</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>ExtendedOptions</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_payload_extended_options'>payload_extended_options</span><span class='lparen'>(</span><span class='id identifier rubyid_explicit_target'>explicit_target</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_reqs'>reqs</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Exploit</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>         <span class='op'>=</span> <span class='kw'>self</span>

  <span class='comment'># Pass along the encoder don&#39;t fall through flag
</span>  <span class='id identifier rubyid_reqs'>reqs</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>EncoderDontFallThrough</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_datastore'>datastore</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>EncoderDontFallThrough</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>

  <span class='comment'># Incorporate any context encoding requirements that are needed
</span>  <span class='id identifier rubyid_define_context_encoding_reqs'>define_context_encoding_reqs</span><span class='lparen'>(</span><span class='id identifier rubyid_reqs'>reqs</span><span class='rparen'>)</span>

  <span class='comment'># Call the encode begin routine.
</span>  <span class='id identifier rubyid_encode_begin'>encode_begin</span><span class='lparen'>(</span><span class='id identifier rubyid_real_payload'>real_payload</span><span class='comma'>,</span> <span class='id identifier rubyid_reqs'>reqs</span><span class='rparen'>)</span>

  <span class='comment'># Generate the encoded payload.
</span>  <span class='id identifier rubyid_encoded'>encoded</span> <span class='op'>=</span> <span class='const'>EncodedPayload</span><span class='period'>.</span><span class='id identifier rubyid_create'>create</span><span class='lparen'>(</span><span class='id identifier rubyid_real_payload'>real_payload</span><span class='comma'>,</span> <span class='id identifier rubyid_reqs'>reqs</span><span class='rparen'>)</span>

  <span class='comment'># Call the encode end routine which is expected to return the actual
</span>  <span class='comment'># encoded payload instance.
</span>  <span class='kw'>return</span> <span class='id identifier rubyid_encode_end'>encode_end</span><span class='lparen'>(</span><span class='id identifier rubyid_real_payload'>real_payload</span><span class='comma'>,</span> <span class='id identifier rubyid_reqs'>reqs</span><span class='comma'>,</span> <span class='id identifier rubyid_encoded'>encoded</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="handle_exception-instance_method">
  
    - (<tt>Object</tt>) <strong>handle_exception</strong>(e) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Handle the exception</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1283
1284
1285
1286
1287
1288
1289
1290
1291
1292
1293
1294
1295
1296
1297
1298
1299
1300
1301
1302
1303
1304
1305
1306
1307
1308
1309
1310
1311
1312
1313
1314
1315
1316
1317
1318
1319
1320
1321
1322
1323
1324
1325
1326
1327
1328
1329
1330
1331
1332
1333
1334
1335
1336
1337
1338
1339
1340
1341
1342
1343
1344
1345
1346
1347
1348
1349
1350
1351
1352
1353
1354</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/exploit.rb', line 1283</span>

<span class='kw'>def</span> <span class='id identifier rubyid_handle_exception'>handle_exception</span> <span class='id identifier rubyid_e'>e</span>
  <span class='id identifier rubyid_msg'>msg</span> <span class='op'>=</span> <span class='id identifier rubyid_setup_fail_detail_from_exception'>setup_fail_detail_from_exception</span> <span class='id identifier rubyid_e'>e</span>

  <span class='kw'>case</span> <span class='id identifier rubyid_e'>e</span>
    <span class='kw'>when</span> <span class='const'>Msf</span><span class='op'>::</span><span class='const'>Exploit</span><span class='op'>::</span><span class='const'>Complete</span>
      <span class='comment'># Nothing to show in this case
</span>      <span class='kw'>return</span>

    <span class='kw'>when</span> <span class='const'>Msf</span><span class='op'>::</span><span class='const'>Exploit</span><span class='op'>::</span><span class='const'>Failed</span>
      <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_print_error'>print_error</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Exploit aborted due to failure: </span><span class='embexpr_beg'>#{</span><span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_fail_reason'>fail_reason</span><span class='embexpr_end'>}</span><span class='tstring_content'>: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_msg'>msg</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>

      <span class='comment'># The caller should have already set self.fail_reason
</span>      <span class='kw'>if</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_fail_reason'>fail_reason</span> <span class='op'>==</span> <span class='const'>Msf</span><span class='op'>::</span><span class='const'>Exploit</span><span class='op'>::</span><span class='const'>Failure</span><span class='op'>::</span><span class='const'>None</span>
        <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_fail_reason'>fail_reason</span> <span class='op'>=</span> <span class='const'>Msf</span><span class='op'>::</span><span class='const'>Exploit</span><span class='op'>::</span><span class='const'>Failure</span><span class='op'>::</span><span class='const'>Unknown</span>
      <span class='kw'>end</span>

    <span class='kw'>when</span> <span class='const'>Rex</span><span class='op'>::</span><span class='const'>ConnectionError</span>
      <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_fail_reason'>fail_reason</span> <span class='op'>=</span> <span class='const'>Msf</span><span class='op'>::</span><span class='const'>Exploit</span><span class='op'>::</span><span class='const'>Failure</span><span class='op'>::</span><span class='const'>Unreachable</span>
      <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_print_error'>print_error</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Exploit failed [</span><span class='embexpr_beg'>#{</span><span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_fail_reason'>fail_reason</span><span class='embexpr_end'>}</span><span class='tstring_content'>]: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_msg'>msg</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
      <span class='id identifier rubyid_elog'>elog</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Exploit failed (</span><span class='embexpr_beg'>#{</span><span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_refname'>refname</span><span class='embexpr_end'>}</span><span class='tstring_content'>): </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_msg'>msg</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>core</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='const'>LEV_0</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_dlog'>dlog</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Call stack:\n</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_backtrace'>backtrace</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\n</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>core</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='const'>LEV_3</span><span class='rparen'>)</span>

    <span class='kw'>when</span> <span class='const'>Rex</span><span class='op'>::</span><span class='const'>BindFailed</span>
      <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_fail_reason'>fail_reason</span> <span class='op'>=</span> <span class='const'>Msf</span><span class='op'>::</span><span class='const'>Exploit</span><span class='op'>::</span><span class='const'>Failure</span><span class='op'>::</span><span class='const'>BadConfig</span>
      <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_print_error'>print_error</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Exploit failed [</span><span class='embexpr_beg'>#{</span><span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_fail_reason'>fail_reason</span><span class='embexpr_end'>}</span><span class='tstring_content'>]: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_msg'>msg</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
      <span class='id identifier rubyid_elog'>elog</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Exploit failed (</span><span class='embexpr_beg'>#{</span><span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_refname'>refname</span><span class='embexpr_end'>}</span><span class='tstring_content'>): </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_msg'>msg</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>core</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='const'>LEV_0</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_dlog'>dlog</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Call stack:\n</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_backtrace'>backtrace</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\n</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>core</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='const'>LEV_3</span><span class='rparen'>)</span>

    <span class='kw'>when</span> <span class='const'>Timeout</span><span class='op'>::</span><span class='const'>Error</span>
      <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_fail_reason'>fail_reason</span> <span class='op'>=</span> <span class='const'>Msf</span><span class='op'>::</span><span class='const'>Exploit</span><span class='op'>::</span><span class='const'>Failure</span><span class='op'>::</span><span class='const'>TimeoutExpired</span>
      <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_print_error'>print_error</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Exploit failed [</span><span class='embexpr_beg'>#{</span><span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_fail_reason'>fail_reason</span><span class='embexpr_end'>}</span><span class='tstring_content'>]: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_msg'>msg</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
      <span class='id identifier rubyid_elog'>elog</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Exploit failed (</span><span class='embexpr_beg'>#{</span><span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_refname'>refname</span><span class='embexpr_end'>}</span><span class='tstring_content'>): </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_msg'>msg</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>core</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='const'>LEV_0</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_dlog'>dlog</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Call stack:\n</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_backtrace'>backtrace</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\n</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>core</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='const'>LEV_3</span><span class='rparen'>)</span>
    <span class='kw'>else</span>

      <span class='comment'># Compare as a string since not all error classes may be loaded
</span>      <span class='kw'>case</span> <span class='id identifier rubyid_msg'>msg</span>
        <span class='kw'>when</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>access.denied|Login Failed</span><span class='regexp_end'>/i</span></span> <span class='comment'># Covers SMB as well as some generic errors
</span>          <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_fail_reason'>fail_reason</span> <span class='op'>=</span> <span class='const'>Msf</span><span class='op'>::</span><span class='const'>Exploit</span><span class='op'>::</span><span class='const'>Failure</span><span class='op'>::</span><span class='const'>NoAccess</span>
        <span class='kw'>when</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>connection reset</span><span class='regexp_end'>/i</span></span>
          <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_fail_reason'>fail_reason</span> <span class='op'>=</span> <span class='const'>Msf</span><span class='op'>::</span><span class='const'>Exploit</span><span class='op'>::</span><span class='const'>Failure</span><span class='op'>::</span><span class='const'>Disconnected</span>
        <span class='kw'>when</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>connection timed out|SSL_connect|unreachable|connection was refused</span><span class='regexp_end'>/i</span></span>
          <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_fail_reason'>fail_reason</span> <span class='op'>=</span> <span class='const'>Msf</span><span class='op'>::</span><span class='const'>Exploit</span><span class='op'>::</span><span class='const'>Failure</span><span class='op'>::</span><span class='const'>Unreachable</span>
        <span class='kw'>when</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>unable.*target</span><span class='regexp_end'>/i</span></span>
          <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_fail_reason'>fail_reason</span> <span class='op'>=</span> <span class='const'>Msf</span><span class='op'>::</span><span class='const'>Exploit</span><span class='op'>::</span><span class='const'>Failure</span><span class='op'>::</span><span class='const'>NoTarget</span>
        <span class='kw'>when</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>execution expired</span><span class='regexp_end'>/i</span></span>
          <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_fail_reason'>fail_reason</span> <span class='op'>=</span> <span class='const'>Msf</span><span class='op'>::</span><span class='const'>Exploit</span><span class='op'>::</span><span class='const'>Failure</span><span class='op'>::</span><span class='const'>TimeoutExpired</span>
        <span class='kw'>when</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>(doesn.t|not).*vulnerable|may.*patched</span><span class='regexp_end'>/i</span></span>
          <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_fail_reason'>fail_reason</span> <span class='op'>=</span> <span class='const'>Msf</span><span class='op'>::</span><span class='const'>Exploit</span><span class='op'>::</span><span class='const'>Failure</span><span class='op'>::</span><span class='const'>NotVulnerable</span>
      <span class='kw'>end</span>

      <span class='comment'># The caller should have already set self.fail_reason
</span>      <span class='kw'>if</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_fail_reason'>fail_reason</span> <span class='op'>==</span> <span class='const'>Msf</span><span class='op'>::</span><span class='const'>Exploit</span><span class='op'>::</span><span class='const'>Failure</span><span class='op'>::</span><span class='const'>None</span>
        <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_fail_reason'>fail_reason</span> <span class='op'>=</span> <span class='const'>Msf</span><span class='op'>::</span><span class='const'>Exploit</span><span class='op'>::</span><span class='const'>Failure</span><span class='op'>::</span><span class='const'>Unknown</span>
      <span class='kw'>end</span>

      <span class='kw'>if</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_fail_reason'>fail_reason</span> <span class='op'>==</span> <span class='const'>Msf</span><span class='op'>::</span><span class='const'>Exploit</span><span class='op'>::</span><span class='const'>Failure</span><span class='op'>::</span><span class='const'>Unknown</span>
        <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_print_error'>print_error</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Exploit failed: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_msg'>msg</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
      <span class='kw'>else</span>
        <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_print_error'>print_error</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Exploit failed [</span><span class='embexpr_beg'>#{</span><span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_fail_reason'>fail_reason</span><span class='embexpr_end'>}</span><span class='tstring_content'>]: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_msg'>msg</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
      <span class='kw'>end</span>

      <span class='id identifier rubyid_elog'>elog</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Exploit failed (</span><span class='embexpr_beg'>#{</span><span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_refname'>refname</span><span class='embexpr_end'>}</span><span class='tstring_content'>): </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_msg'>msg</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>core</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='const'>LEV_0</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_dlog'>dlog</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Call stack:\n</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_backtrace'>backtrace</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\n</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>core</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='const'>LEV_3</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='comment'># Record the error to various places
</span>  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_framework'>framework</span><span class='period'>.</span><span class='id identifier rubyid_events'>events</span><span class='period'>.</span><span class='id identifier rubyid_on_module_error'>on_module_error</span><span class='lparen'>(</span><span class='kw'>self</span><span class='comma'>,</span> <span class='id identifier rubyid_msg'>msg</span><span class='rparen'>)</span>

  <span class='comment'># Report the failure (and attempt) in the database
</span>  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_report_failure'>report_failure</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="handler-instance_method">
  
    - (<tt>Object</tt>) <strong>handler</strong>(*args) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Passes the connection to the associated payload handler to see if the
exploit succeeded and a connection has been established.  The return value
can be one of the Handler::constants.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1199
1200
1201
1202
1203</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/exploit.rb', line 1199</span>

<span class='kw'>def</span> <span class='id identifier rubyid_handler'>handler</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='kw'>if</span> <span class='kw'>not</span> <span class='id identifier rubyid_payload_instance'>payload_instance</span>
  <span class='kw'>return</span> <span class='kw'>if</span> <span class='kw'>not</span> <span class='id identifier rubyid_handler_enabled?'>handler_enabled?</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_payload_instance'>payload_instance</span><span class='period'>.</span><span class='id identifier rubyid_handler'>handler</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="handler_enabled?-instance_method">
  
    - (<tt>Boolean</tt>) <strong>handler_enabled?</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Allow the user to disable the payload handler</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1184
1185
1186</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/exploit.rb', line 1184</span>

<span class='kw'>def</span> <span class='id identifier rubyid_handler_enabled?'>handler_enabled?</span>
  <span class='kw'>not</span> <span class='id identifier rubyid_datastore'>datastore</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>DisablePayloadHandler</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="init_compat-instance_method">
  
    - (<tt>Object</tt>) <strong>init_compat</strong>  <span class="extras">(protected)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Overrides the base class method and serves to initialize default
compatibilities for exploits</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1483
1484
1485
1486
1487
1488
1489
1490
1491
1492
1493
1494
1495
1496
1497
1498
1499
1500
1501
1502</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/exploit.rb', line 1483</span>

<span class='kw'>def</span> <span class='id identifier rubyid_init_compat'>init_compat</span>
  <span class='kw'>super</span>

  <span class='comment'>#
</span>  <span class='comment'># Merge in payload compatible defaults
</span>  <span class='comment'>#
</span>  <span class='id identifier rubyid_p'>p</span> <span class='op'>=</span> <span class='id identifier rubyid_module_info'>module_info</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Compat</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Payload</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>

  <span class='const'>CompatDefaults</span><span class='op'>::</span><span class='const'>Payload</span><span class='period'>.</span><span class='id identifier rubyid_each_pair'>each_pair</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_k'>k</span><span class='comma'>,</span><span class='id identifier rubyid_v'>v</span><span class='op'>|</span>
    <span class='lparen'>(</span><span class='id identifier rubyid_p'>p</span><span class='lbracket'>[</span><span class='id identifier rubyid_k'>k</span><span class='rbracket'>]</span><span class='rparen'>)</span> <span class='op'>?</span> <span class='id identifier rubyid_p'>p</span><span class='lbracket'>[</span><span class='id identifier rubyid_k'>k</span><span class='rbracket'>]</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'> </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_v'>v</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> <span class='op'>:</span> <span class='id identifier rubyid_p'>p</span><span class='lbracket'>[</span><span class='id identifier rubyid_k'>k</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_v'>v</span>
  <span class='rbrace'>}</span>

  <span class='comment'>#
</span>  <span class='comment'># Set the default save registers if none have been explicitly
</span>  <span class='comment'># specified.
</span>  <span class='comment'>#
</span>  <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_module_info'>module_info</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>SaveRegisters</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>==</span> <span class='kw'>nil</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_module_info'>module_info</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>SaveRegisters</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>esp</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>ebp</span><span class='tstring_end'>&#39;</span></span> <span class='rbracket'>]</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="is_payload_compatible?-instance_method">
  
    - (<tt>TrueClass</tt>, <tt>FalseClass</tt>) <strong>is_payload_compatible?</strong>(payload_name) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns whether the requested payload is compatible with the module.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>payload_name</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The payload name</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>TrueClass</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Payload is compatible.</p>
</div>
      
    </li>
  
    <li>
      
      
        <span class='type'>(<tt>FalseClass</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Payload is not compatible.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


709
710
711
712
713</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/exploit.rb', line 709</span>

<span class='kw'>def</span> <span class='id identifier rubyid_is_payload_compatible?'>is_payload_compatible?</span><span class='lparen'>(</span><span class='id identifier rubyid_payload_name'>payload_name</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_payload_names'>payload_names</span> <span class='op'>=</span> <span class='id identifier rubyid_compatible_payloads'>compatible_payloads</span><span class='period'>.</span><span class='id identifier rubyid_collect'>collect</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_entry'>entry</span><span class='op'>|</span> <span class='id identifier rubyid_entry'>entry</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span> <span class='rbrace'>}</span>

  <span class='id identifier rubyid_payload_names'>payload_names</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_payload_name'>payload_name</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="make_nops-instance_method">
  
    - (<tt>Object</tt>) <strong>make_nops</strong>(count) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Generates a nop sled of a supplied length and returns it to the caller.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1008
1009
1010
1011
1012
1013
1014
1015
1016
1017
1018
1019
1020
1021
1022
1023
1024
1025
1026
1027
1028
1029
1030
1031
1032
1033
1034
1035
1036
1037
1038
1039
1040
1041
1042
1043
1044
1045
1046
1047
1048
1049
1050</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/exploit.rb', line 1008</span>

<span class='kw'>def</span> <span class='id identifier rubyid_make_nops'>make_nops</span><span class='lparen'>(</span><span class='id identifier rubyid_count'>count</span><span class='rparen'>)</span>
  <span class='comment'># If we&#39;re debugging, then make_nops will return a safe sled.  We
</span>  <span class='comment'># currently assume x86.
</span>  <span class='kw'>if</span> <span class='id identifier rubyid_debugging?'>debugging?</span>
    <span class='kw'>return</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\x90</span><span class='tstring_end'>&quot;</span></span> <span class='op'>*</span> <span class='id identifier rubyid_count'>count</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_nop_sled'>nop_sled</span> <span class='op'>=</span> <span class='kw'>nil</span>

  <span class='comment'># If there is no payload instance then we can&#39;t succeed.
</span>  <span class='kw'>return</span> <span class='kw'>nil</span> <span class='kw'>if</span> <span class='lparen'>(</span><span class='op'>!</span><span class='id identifier rubyid_payload_instance'>payload_instance</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_payload_instance'>payload_instance</span><span class='period'>.</span><span class='id identifier rubyid_compatible_nops'>compatible_nops</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_nopname'>nopname</span><span class='comma'>,</span> <span class='id identifier rubyid_nopmod'>nopmod</span><span class='op'>|</span>
    <span class='comment'># Create an instance of the nop module
</span>    <span class='id identifier rubyid_nop'>nop</span> <span class='op'>=</span> <span class='id identifier rubyid_nopmod'>nopmod</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>

    <span class='comment'># The list of save registers
</span>    <span class='id identifier rubyid_save_regs'>save_regs</span> <span class='op'>=</span> <span class='id identifier rubyid_nop_save_registers'>nop_save_registers</span> <span class='op'>||</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>

    <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_save_regs'>save_regs</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span> <span class='op'>==</span> <span class='kw'>true</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_save_regs'>save_regs</span> <span class='op'>=</span> <span class='kw'>nil</span>
    <span class='kw'>end</span>

    <span class='kw'>begin</span>
      <span class='id identifier rubyid_nop'>nop</span><span class='period'>.</span><span class='id identifier rubyid_copy_ui'>copy_ui</span><span class='lparen'>(</span><span class='kw'>self</span><span class='rparen'>)</span>

      <span class='id identifier rubyid_nop_sled'>nop_sled</span> <span class='op'>=</span> <span class='id identifier rubyid_nop'>nop</span><span class='period'>.</span><span class='id identifier rubyid_generate_sled'>generate_sled</span><span class='lparen'>(</span><span class='id identifier rubyid_count'>count</span><span class='comma'>,</span>
        <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>BadChars</span><span class='tstring_end'>&#39;</span></span>      <span class='op'>=&gt;</span> <span class='id identifier rubyid_payload_badchars'>payload_badchars</span> <span class='op'>||</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
        <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>SaveRegisters</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_save_regs'>save_regs</span><span class='rparen'>)</span>

      <span class='kw'>if</span> <span class='id identifier rubyid_nop_sled'>nop_sled</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_nop_sled'>nop_sled</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span> <span class='op'>==</span> <span class='id identifier rubyid_count'>count</span>
        <span class='kw'>break</span>
      <span class='kw'>else</span>
        <span class='id identifier rubyid_wlog'>wlog</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_refname'>refname</span><span class='embexpr_end'>}</span><span class='tstring_content'>: Nop generator </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_nop'>nop</span><span class='period'>.</span><span class='id identifier rubyid_refname'>refname</span><span class='embexpr_end'>}</span><span class='tstring_content'> failed to generate sled for exploit</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>core</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='const'>LEV_0</span><span class='rparen'>)</span>
      <span class='kw'>end</span>
    <span class='kw'>rescue</span>
      <span class='id identifier rubyid_wlog'>wlog</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_refname'>refname</span><span class='embexpr_end'>}</span><span class='tstring_content'>: Nop generator </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_nop'>nop</span><span class='period'>.</span><span class='id identifier rubyid_refname'>refname</span><span class='embexpr_end'>}</span><span class='tstring_content'> failed to generate sled for exploit: </span><span class='embexpr_beg'>#{</span><span class='gvar'>$!</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
        <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>core</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='const'>LEV_0</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='rbrace'>}</span>

  <span class='id identifier rubyid_nop_sled'>nop_sled</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="nop_generator-instance_method">
  
    - (<tt>Object</tt>) <strong>nop_generator</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the first compatible NOP generator for this exploit&#39;s payload
instance.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


997
998
999
1000
1001
1002
1003</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/exploit.rb', line 997</span>

<span class='kw'>def</span> <span class='id identifier rubyid_nop_generator'>nop_generator</span>
  <span class='kw'>return</span> <span class='kw'>nil</span> <span class='kw'>if</span> <span class='lparen'>(</span><span class='op'>!</span><span class='id identifier rubyid_payload_instance'>payload_instance</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_payload_instance'>payload_instance</span><span class='period'>.</span><span class='id identifier rubyid_compatible_nops'>compatible_nops</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_nopname'>nopname</span><span class='comma'>,</span> <span class='id identifier rubyid_nopmod'>nopmod</span><span class='op'>|</span>
    <span class='kw'>return</span> <span class='id identifier rubyid_nopmod'>nopmod</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
  <span class='rbrace'>}</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="nop_save_registers-instance_method">
  
    - (<tt>Object</tt>) <strong>nop_save_registers</strong>(explicit_target = nil) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the list of registers that the NOP generator should save, if any. 
It will use the current target&#39;s save registers in precedence over
those defined globally for the exploit module.</p>

<p>If there are no save registers, nil is returned.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


983
984
985
986
987
988
989
990
991</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/exploit.rb', line 983</span>

<span class='kw'>def</span> <span class='id identifier rubyid_nop_save_registers'>nop_save_registers</span><span class='lparen'>(</span><span class='id identifier rubyid_explicit_target'>explicit_target</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_explicit_target'>explicit_target</span> <span class='op'>||=</span> <span class='id identifier rubyid_target'>target</span>

  <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_explicit_target'>explicit_target</span> <span class='kw'>and</span> <span class='id identifier rubyid_explicit_target'>explicit_target</span><span class='period'>.</span><span class='id identifier rubyid_save_registers'>save_registers</span><span class='rparen'>)</span>
    <span class='kw'>return</span> <span class='id identifier rubyid_explicit_target'>explicit_target</span><span class='period'>.</span><span class='id identifier rubyid_save_registers'>save_registers</span>
  <span class='kw'>else</span>
    <span class='kw'>return</span> <span class='id identifier rubyid_module_info'>module_info</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>SaveRegisters</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="on_new_session-instance_method">
  
    - (<tt>Object</tt>) <strong>on_new_session</strong>(session) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>This is called by the payload when a new session is created</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1214
1215
1216
1217</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/exploit.rb', line 1214</span>

<span class='kw'>def</span> <span class='id identifier rubyid_on_new_session'>on_new_session</span><span class='lparen'>(</span><span class='id identifier rubyid_session'>session</span><span class='rparen'>)</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_session_count'>session_count</span> <span class='op'>+=</span> <span class='int'>1</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_successful'>successful</span> <span class='op'>=</span> <span class='kw'>true</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="passive?-instance_method">
  
    - (<tt>Boolean</tt>) <strong>passive?</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns if the exploit has a passive stance.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


658
659
660</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/exploit.rb', line 658</span>

<span class='kw'>def</span> <span class='id identifier rubyid_passive?'>passive?</span>
  <span class='lparen'>(</span><span class='id identifier rubyid_stance'>stance</span> <span class='op'>==</span> <span class='const'>Stance</span><span class='op'>::</span><span class='const'>Passive</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="pattern_create-instance_method">
  
    - (<tt>Object</tt>) <strong>pattern_create</strong>(length, sets = nil) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Generate a non-repeating static random string</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1170
1171
1172</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/exploit.rb', line 1170</span>

<span class='kw'>def</span> <span class='id identifier rubyid_pattern_create'>pattern_create</span><span class='lparen'>(</span><span class='id identifier rubyid_length'>length</span><span class='comma'>,</span> <span class='id identifier rubyid_sets'>sets</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='const'>Rex</span><span class='op'>::</span><span class='const'>Text</span><span class='period'>.</span><span class='id identifier rubyid_pattern_create'>pattern_create</span><span class='lparen'>(</span><span class='id identifier rubyid_length'>length</span><span class='comma'>,</span> <span class='id identifier rubyid_sets'>sets</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="payload_append-instance_method">
  
    - (<tt>Object</tt>) <strong>payload_append</strong>(explicit_target = nil) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Return any text that should be appended to the payload.  The payload module
is passed so that the exploit can take a guess at architecture and platform
if it&#39;s a multi exploit.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


823
824
825
826
827
828
829
830
831</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/exploit.rb', line 823</span>

<span class='kw'>def</span> <span class='id identifier rubyid_payload_append'>payload_append</span><span class='lparen'>(</span><span class='id identifier rubyid_explicit_target'>explicit_target</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_explicit_target'>explicit_target</span> <span class='op'>||=</span> <span class='id identifier rubyid_target'>target</span>

  <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_explicit_target'>explicit_target</span> <span class='kw'>and</span> <span class='id identifier rubyid_explicit_target'>explicit_target</span><span class='period'>.</span><span class='id identifier rubyid_payload_append'>payload_append</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_explicit_target'>explicit_target</span><span class='period'>.</span><span class='id identifier rubyid_payload_append'>payload_append</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_payload_info'>payload_info</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Append</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="payload_append_encoder-instance_method">
  
    - (<tt>Object</tt>) <strong>payload_append_encoder</strong>(explicit_target = nil) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Return any text that should be appended to the encoder of the payload. The
payload module is passed so that the exploit can take a guess at
architecture and platform if it&#39;s a multi exploit.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


855
856
857
858
859
860
861
862
863
864
865</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/exploit.rb', line 855</span>

<span class='kw'>def</span> <span class='id identifier rubyid_payload_append_encoder'>payload_append_encoder</span><span class='lparen'>(</span><span class='id identifier rubyid_explicit_target'>explicit_target</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_explicit_target'>explicit_target</span> <span class='op'>||=</span> <span class='id identifier rubyid_target'>target</span>

  <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_explicit_target'>explicit_target</span> <span class='kw'>and</span> <span class='id identifier rubyid_explicit_target'>explicit_target</span><span class='period'>.</span><span class='id identifier rubyid_payload_append_encoder'>payload_append_encoder</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_p'>p</span> <span class='op'>=</span> <span class='id identifier rubyid_explicit_target'>explicit_target</span><span class='period'>.</span><span class='id identifier rubyid_payload_append_encoder'>payload_append_encoder</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_p'>p</span> <span class='op'>=</span> <span class='id identifier rubyid_payload_info'>payload_info</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>AppendEncoder</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_p'>p</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="payload_badchars-instance_method">
  
    - (<tt>Object</tt>) <strong>payload_badchars</strong>(explicit_target = nil) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the bad characters that cannot be in any payload used by this
exploit.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


914
915
916
917
918
919
920
921
922</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/exploit.rb', line 914</span>

<span class='kw'>def</span> <span class='id identifier rubyid_payload_badchars'>payload_badchars</span><span class='lparen'>(</span><span class='id identifier rubyid_explicit_target'>explicit_target</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_explicit_target'>explicit_target</span> <span class='op'>||=</span> <span class='id identifier rubyid_target'>target</span>

  <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_explicit_target'>explicit_target</span> <span class='kw'>and</span> <span class='id identifier rubyid_explicit_target'>explicit_target</span><span class='period'>.</span><span class='id identifier rubyid_payload_badchars'>payload_badchars</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_explicit_target'>explicit_target</span><span class='period'>.</span><span class='id identifier rubyid_payload_badchars'>payload_badchars</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_payload_info'>payload_info</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>BadChars</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="payload_encoder_options-instance_method">
  
    - (<tt>Object</tt>) <strong>payload_encoder_options</strong>(explicit_target = nil) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the payload encoder option hash that is used to initialize the
datastore of the encoder that is selected when generating an encoded
payload.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


943
944
945
946
947
948
949
950
951</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/exploit.rb', line 943</span>

<span class='kw'>def</span> <span class='id identifier rubyid_payload_encoder_options'>payload_encoder_options</span><span class='lparen'>(</span><span class='id identifier rubyid_explicit_target'>explicit_target</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_explicit_target'>explicit_target</span> <span class='op'>||=</span> <span class='id identifier rubyid_target'>target</span>

  <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_explicit_target'>explicit_target</span> <span class='kw'>and</span> <span class='id identifier rubyid_explicit_target'>explicit_target</span><span class='period'>.</span><span class='id identifier rubyid_payload_encoder_options'>payload_encoder_options</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_explicit_target'>explicit_target</span><span class='period'>.</span><span class='id identifier rubyid_payload_encoder_options'>payload_encoder_options</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_payload_info'>payload_info</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>EncoderOptions</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="payload_encoder_type-instance_method">
  
    - (<tt>Object</tt>) <strong>payload_encoder_type</strong>(explicit_target = nil) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the payload encoder type that is associated with either the current
target of the exploit in general.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


928
929
930
931
932
933
934
935
936</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/exploit.rb', line 928</span>

<span class='kw'>def</span> <span class='id identifier rubyid_payload_encoder_type'>payload_encoder_type</span><span class='lparen'>(</span><span class='id identifier rubyid_explicit_target'>explicit_target</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_explicit_target'>explicit_target</span> <span class='op'>||=</span> <span class='id identifier rubyid_target'>target</span>

  <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_explicit_target'>explicit_target</span> <span class='kw'>and</span> <span class='id identifier rubyid_explicit_target'>explicit_target</span><span class='period'>.</span><span class='id identifier rubyid_payload_encoder_type'>payload_encoder_type</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_explicit_target'>explicit_target</span><span class='period'>.</span><span class='id identifier rubyid_payload_encoder_type'>payload_encoder_type</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_payload_info'>payload_info</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>EncoderType</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="payload_extended_options-instance_method">
  
    - (<tt>Object</tt>) <strong>payload_extended_options</strong>(explicit_target = nil) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the payload extended options hash which is used to provide a
location to store extended information that may be useful to a particular
type of payload or mixin.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


958
959
960
961
962
963
964
965
966</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/exploit.rb', line 958</span>

<span class='kw'>def</span> <span class='id identifier rubyid_payload_extended_options'>payload_extended_options</span><span class='lparen'>(</span><span class='id identifier rubyid_explicit_target'>explicit_target</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_explicit_target'>explicit_target</span> <span class='op'>||=</span> <span class='id identifier rubyid_target'>target</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_explicit_target'>explicit_target</span> <span class='kw'>and</span> <span class='id identifier rubyid_explicit_target'>explicit_target</span><span class='period'>.</span><span class='id identifier rubyid_payload_extended_options'>payload_extended_options</span>
    <span class='id identifier rubyid_explicit_target'>explicit_target</span><span class='period'>.</span><span class='id identifier rubyid_payload_extended_options'>payload_extended_options</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_payload_info'>payload_info</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>ExtendedOptions</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="payload_max_nops-instance_method">
  
    - (<tt>Object</tt>) <strong>payload_max_nops</strong>(explicit_target = nil) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Maximum number of nops to use as a hint to the framework. Nil signifies
that the framework should decide.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


871
872
873
874
875
876
877
878
879</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/exploit.rb', line 871</span>

<span class='kw'>def</span> <span class='id identifier rubyid_payload_max_nops'>payload_max_nops</span><span class='lparen'>(</span><span class='id identifier rubyid_explicit_target'>explicit_target</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_explicit_target'>explicit_target</span> <span class='op'>||=</span> <span class='id identifier rubyid_target'>target</span>

  <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_explicit_target'>explicit_target</span> <span class='kw'>and</span> <span class='id identifier rubyid_explicit_target'>explicit_target</span><span class='period'>.</span><span class='id identifier rubyid_payload_max_nops'>payload_max_nops</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_explicit_target'>explicit_target</span><span class='period'>.</span><span class='id identifier rubyid_payload_max_nops'>payload_max_nops</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_payload_info'>payload_info</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>MaxNops</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='kw'>nil</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="payload_min_nops-instance_method">
  
    - (<tt>Object</tt>) <strong>payload_min_nops</strong>(explicit_target = nil) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Minimum number of nops to use as a hint to the framework. Nil signifies
that the framework should decide.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


885
886
887
888
889
890
891
892
893</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/exploit.rb', line 885</span>

<span class='kw'>def</span> <span class='id identifier rubyid_payload_min_nops'>payload_min_nops</span><span class='lparen'>(</span><span class='id identifier rubyid_explicit_target'>explicit_target</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_explicit_target'>explicit_target</span> <span class='op'>||=</span> <span class='id identifier rubyid_target'>target</span>

  <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_explicit_target'>explicit_target</span> <span class='kw'>and</span> <span class='id identifier rubyid_explicit_target'>explicit_target</span><span class='period'>.</span><span class='id identifier rubyid_payload_min_nops'>payload_min_nops</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_explicit_target'>explicit_target</span><span class='period'>.</span><span class='id identifier rubyid_payload_min_nops'>payload_min_nops</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_payload_info'>payload_info</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>MinNops</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='kw'>nil</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="payload_prepend-instance_method">
  
    - (<tt>Object</tt>) <strong>payload_prepend</strong>(explicit_target = nil) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Return any text that should be prepended to the payload.  The payload
module is passed so that the exploit can take a guess at architecture and
platform if it&#39;s a multi exploit.  This automatically takes into
account any require stack adjustments.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


806
807
808
809
810
811
812
813
814
815
816</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/exploit.rb', line 806</span>

<span class='kw'>def</span> <span class='id identifier rubyid_payload_prepend'>payload_prepend</span><span class='lparen'>(</span><span class='id identifier rubyid_explicit_target'>explicit_target</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_explicit_target'>explicit_target</span> <span class='op'>||=</span> <span class='id identifier rubyid_target'>target</span>

  <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_explicit_target'>explicit_target</span> <span class='kw'>and</span> <span class='id identifier rubyid_explicit_target'>explicit_target</span><span class='period'>.</span><span class='id identifier rubyid_payload_prepend'>payload_prepend</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_p'>p</span> <span class='op'>=</span> <span class='id identifier rubyid_explicit_target'>explicit_target</span><span class='period'>.</span><span class='id identifier rubyid_payload_prepend'>payload_prepend</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_p'>p</span> <span class='op'>=</span> <span class='id identifier rubyid_payload_info'>payload_info</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Prepend</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_stack_adjustment'>stack_adjustment</span> <span class='op'>+</span> <span class='id identifier rubyid_p'>p</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="payload_prepend_encoder-instance_method">
  
    - (<tt>Object</tt>) <strong>payload_prepend_encoder</strong>(explicit_target = nil) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Return any text that should be prepended to the encoder of the payload. The
payload module is passed so that the exploit can take a guess at
architecture and platform if it&#39;s a multi exploit.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


838
839
840
841
842
843
844
845
846
847
848</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/exploit.rb', line 838</span>

<span class='kw'>def</span> <span class='id identifier rubyid_payload_prepend_encoder'>payload_prepend_encoder</span><span class='lparen'>(</span><span class='id identifier rubyid_explicit_target'>explicit_target</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_explicit_target'>explicit_target</span> <span class='op'>||=</span> <span class='id identifier rubyid_target'>target</span>

  <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_explicit_target'>explicit_target</span> <span class='kw'>and</span> <span class='id identifier rubyid_explicit_target'>explicit_target</span><span class='period'>.</span><span class='id identifier rubyid_payload_prepend_encoder'>payload_prepend_encoder</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_p'>p</span> <span class='op'>=</span> <span class='id identifier rubyid_explicit_target'>explicit_target</span><span class='period'>.</span><span class='id identifier rubyid_payload_prepend_encoder'>payload_prepend_encoder</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_p'>p</span> <span class='op'>=</span> <span class='id identifier rubyid_payload_info'>payload_info</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>PrependEncoder</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_p'>p</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="payload_space-instance_method">
  
    - (<tt>Object</tt>) <strong>payload_space</strong>(explicit_target = nil) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the maximum amount of room the exploit has for a payload.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


898
899
900
901
902
903
904
905
906
907
908</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/exploit.rb', line 898</span>

<span class='kw'>def</span> <span class='id identifier rubyid_payload_space'>payload_space</span><span class='lparen'>(</span><span class='id identifier rubyid_explicit_target'>explicit_target</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_explicit_target'>explicit_target</span> <span class='op'>||=</span> <span class='id identifier rubyid_target'>target</span>

  <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_explicit_target'>explicit_target</span> <span class='kw'>and</span> <span class='id identifier rubyid_explicit_target'>explicit_target</span><span class='period'>.</span><span class='id identifier rubyid_payload_space'>payload_space</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_explicit_target'>explicit_target</span><span class='period'>.</span><span class='id identifier rubyid_payload_space'>payload_space</span>
  <span class='kw'>elsif</span> <span class='lparen'>(</span><span class='id identifier rubyid_payload_info'>payload_info</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Space</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_payload_info'>payload_info</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Space</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span>
  <span class='kw'>else</span>
    <span class='kw'>nil</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="rand_char-instance_method">
  
    - (<tt>Object</tt>) <strong>rand_char</strong>(bad = payload_badchars) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Generate a random character avoiding the exploit&#39;s bad characters.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1159
1160
1161
1162
1163
1164
1165</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/exploit.rb', line 1159</span>

<span class='kw'>def</span> <span class='id identifier rubyid_rand_char'>rand_char</span><span class='lparen'>(</span><span class='id identifier rubyid_bad'>bad</span><span class='op'>=</span><span class='id identifier rubyid_payload_badchars'>payload_badchars</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_debugging?'>debugging?</span>
    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>A</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>else</span>
    <span class='const'>Rex</span><span class='op'>::</span><span class='const'>Text</span><span class='period'>.</span><span class='id identifier rubyid_rand_char'>rand_char</span><span class='lparen'>(</span><span class='id identifier rubyid_bad'>bad</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="rand_text-instance_method">
  
    - (<tt>Object</tt>) <strong>rand_text</strong>(length, bad = payload_badchars) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Generate random text characters avoiding the exploit&#39;s bad characters.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1063
1064
1065
1066
1067
1068
1069</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/exploit.rb', line 1063</span>

<span class='kw'>def</span> <span class='id identifier rubyid_rand_text'>rand_text</span><span class='lparen'>(</span><span class='id identifier rubyid_length'>length</span><span class='comma'>,</span> <span class='id identifier rubyid_bad'>bad</span><span class='op'>=</span><span class='id identifier rubyid_payload_badchars'>payload_badchars</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_debugging?'>debugging?</span>
    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>A</span><span class='tstring_end'>&quot;</span></span> <span class='op'>*</span> <span class='id identifier rubyid_length'>length</span>
  <span class='kw'>else</span>
    <span class='const'>Rex</span><span class='op'>::</span><span class='const'>Text</span><span class='period'>.</span><span class='id identifier rubyid_rand_text'>rand_text</span><span class='lparen'>(</span><span class='id identifier rubyid_length'>length</span><span class='comma'>,</span> <span class='id identifier rubyid_bad'>bad</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="rand_text_alpha-instance_method">
  
    - (<tt>Object</tt>) <strong>rand_text_alpha</strong>(length, bad = payload_badchars) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Generate random alpha characters avoiding the exploit&#39;s bad characters.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1099
1100
1101
1102
1103
1104
1105</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/exploit.rb', line 1099</span>

<span class='kw'>def</span> <span class='id identifier rubyid_rand_text_alpha'>rand_text_alpha</span><span class='lparen'>(</span><span class='id identifier rubyid_length'>length</span><span class='comma'>,</span> <span class='id identifier rubyid_bad'>bad</span><span class='op'>=</span><span class='id identifier rubyid_payload_badchars'>payload_badchars</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_debugging?'>debugging?</span>
    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>A</span><span class='tstring_end'>&quot;</span></span> <span class='op'>*</span> <span class='id identifier rubyid_length'>length</span>
  <span class='kw'>else</span>
    <span class='const'>Rex</span><span class='op'>::</span><span class='const'>Text</span><span class='period'>.</span><span class='id identifier rubyid_rand_text_alpha'>rand_text_alpha</span><span class='lparen'>(</span><span class='id identifier rubyid_length'>length</span><span class='comma'>,</span> <span class='id identifier rubyid_bad'>bad</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="rand_text_alpha_lower-instance_method">
  
    - (<tt>Object</tt>) <strong>rand_text_alpha_lower</strong>(length, bad = payload_badchars) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Generate random alpha lower characters avoiding the exploit&#39;s bad
characters.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1123
1124
1125
1126
1127
1128
1129</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/exploit.rb', line 1123</span>

<span class='kw'>def</span> <span class='id identifier rubyid_rand_text_alpha_lower'>rand_text_alpha_lower</span><span class='lparen'>(</span><span class='id identifier rubyid_length'>length</span><span class='comma'>,</span> <span class='id identifier rubyid_bad'>bad</span><span class='op'>=</span><span class='id identifier rubyid_payload_badchars'>payload_badchars</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_debugging?'>debugging?</span>
    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>a</span><span class='tstring_end'>&quot;</span></span> <span class='op'>*</span> <span class='id identifier rubyid_length'>length</span>
  <span class='kw'>else</span>
    <span class='const'>Rex</span><span class='op'>::</span><span class='const'>Text</span><span class='period'>.</span><span class='id identifier rubyid_rand_text_alpha_lower'>rand_text_alpha_lower</span><span class='lparen'>(</span><span class='id identifier rubyid_length'>length</span><span class='comma'>,</span> <span class='id identifier rubyid_bad'>bad</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="rand_text_alpha_upper-instance_method">
  
    - (<tt>Object</tt>) <strong>rand_text_alpha_upper</strong>(length, bad = payload_badchars) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Generate random alpha upper characters avoiding the exploit&#39;s bad
characters.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1111
1112
1113
1114
1115
1116
1117</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/exploit.rb', line 1111</span>

<span class='kw'>def</span> <span class='id identifier rubyid_rand_text_alpha_upper'>rand_text_alpha_upper</span><span class='lparen'>(</span><span class='id identifier rubyid_length'>length</span><span class='comma'>,</span> <span class='id identifier rubyid_bad'>bad</span><span class='op'>=</span><span class='id identifier rubyid_payload_badchars'>payload_badchars</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_debugging?'>debugging?</span>
    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>A</span><span class='tstring_end'>&quot;</span></span> <span class='op'>*</span> <span class='id identifier rubyid_length'>length</span>
  <span class='kw'>else</span>
    <span class='const'>Rex</span><span class='op'>::</span><span class='const'>Text</span><span class='period'>.</span><span class='id identifier rubyid_rand_text_alpha_upper'>rand_text_alpha_upper</span><span class='lparen'>(</span><span class='id identifier rubyid_length'>length</span><span class='comma'>,</span> <span class='id identifier rubyid_bad'>bad</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="rand_text_alphanumeric-instance_method">
  
    - (<tt>Object</tt>) <strong>rand_text_alphanumeric</strong>(length, bad = payload_badchars) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Generate random alphanumeric characters avoiding the exploit&#39;s bad
characters.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1135
1136
1137
1138
1139
1140
1141</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/exploit.rb', line 1135</span>

<span class='kw'>def</span> <span class='id identifier rubyid_rand_text_alphanumeric'>rand_text_alphanumeric</span><span class='lparen'>(</span><span class='id identifier rubyid_length'>length</span><span class='comma'>,</span> <span class='id identifier rubyid_bad'>bad</span><span class='op'>=</span><span class='id identifier rubyid_payload_badchars'>payload_badchars</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_debugging?'>debugging?</span>
    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>A</span><span class='tstring_end'>&quot;</span></span> <span class='op'>*</span> <span class='id identifier rubyid_length'>length</span>
  <span class='kw'>else</span>
    <span class='const'>Rex</span><span class='op'>::</span><span class='const'>Text</span><span class='period'>.</span><span class='id identifier rubyid_rand_text_alphanumeric'>rand_text_alphanumeric</span><span class='lparen'>(</span><span class='id identifier rubyid_length'>length</span><span class='comma'>,</span> <span class='id identifier rubyid_bad'>bad</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="rand_text_english-instance_method">
  
    - (<tt>Object</tt>) <strong>rand_text_english</strong>(length, bad = payload_badchars) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Generate random english-like avoiding the exploit&#39;s bad characters.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1075
1076
1077
1078
1079
1080
1081</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/exploit.rb', line 1075</span>

<span class='kw'>def</span> <span class='id identifier rubyid_rand_text_english'>rand_text_english</span><span class='lparen'>(</span><span class='id identifier rubyid_length'>length</span><span class='comma'>,</span> <span class='id identifier rubyid_bad'>bad</span><span class='op'>=</span><span class='id identifier rubyid_payload_badchars'>payload_badchars</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_debugging?'>debugging?</span>
    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>A</span><span class='tstring_end'>&quot;</span></span> <span class='op'>*</span> <span class='id identifier rubyid_length'>length</span>
  <span class='kw'>else</span>
    <span class='const'>Rex</span><span class='op'>::</span><span class='const'>Text</span><span class='period'>.</span><span class='id identifier rubyid_rand_text_english'>rand_text_english</span><span class='lparen'>(</span><span class='id identifier rubyid_length'>length</span><span class='comma'>,</span> <span class='id identifier rubyid_bad'>bad</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="rand_text_highascii-instance_method">
  
    - (<tt>Object</tt>) <strong>rand_text_highascii</strong>(length, bad = payload_badchars) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Generate random high ascii characters avoiding the exploit&#39;s bad
characters.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1087
1088
1089
1090
1091
1092
1093</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/exploit.rb', line 1087</span>

<span class='kw'>def</span> <span class='id identifier rubyid_rand_text_highascii'>rand_text_highascii</span><span class='lparen'>(</span><span class='id identifier rubyid_length'>length</span><span class='comma'>,</span> <span class='id identifier rubyid_bad'>bad</span><span class='op'>=</span><span class='id identifier rubyid_payload_badchars'>payload_badchars</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_debugging?'>debugging?</span>
    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>A</span><span class='tstring_end'>&quot;</span></span> <span class='op'>*</span> <span class='id identifier rubyid_length'>length</span>
  <span class='kw'>else</span>
    <span class='const'>Rex</span><span class='op'>::</span><span class='const'>Text</span><span class='period'>.</span><span class='id identifier rubyid_rand_text_highascii'>rand_text_highascii</span><span class='lparen'>(</span><span class='id identifier rubyid_length'>length</span><span class='comma'>,</span> <span class='id identifier rubyid_bad'>bad</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="rand_text_numeric-instance_method">
  
    - (<tt>Object</tt>) <strong>rand_text_numeric</strong>(length, bad = payload_badchars) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Generate random numeric characters avoiding the exploit&#39;s bad
characters.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1147
1148
1149
1150
1151
1152
1153</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/exploit.rb', line 1147</span>

<span class='kw'>def</span> <span class='id identifier rubyid_rand_text_numeric'>rand_text_numeric</span><span class='lparen'>(</span><span class='id identifier rubyid_length'>length</span><span class='comma'>,</span> <span class='id identifier rubyid_bad'>bad</span><span class='op'>=</span><span class='id identifier rubyid_payload_badchars'>payload_badchars</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_debugging?'>debugging?</span>
    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>0</span><span class='tstring_end'>&quot;</span></span> <span class='op'>*</span> <span class='id identifier rubyid_length'>length</span>
  <span class='kw'>else</span>
    <span class='const'>Rex</span><span class='op'>::</span><span class='const'>Text</span><span class='period'>.</span><span class='id identifier rubyid_rand_text_numeric'>rand_text_numeric</span><span class='lparen'>(</span><span class='id identifier rubyid_length'>length</span><span class='comma'>,</span> <span class='id identifier rubyid_bad'>bad</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="regenerate_payload-instance_method">
  
    - (<tt>Object</tt>) <strong>regenerate_payload</strong>(platform = nil, arch = nil, explicit_target = nil) 
  

  
    <span class="aliases">Also known as:
    <span class="names"><span id='exploit_regenerate_payload-instance_method'>exploit_regenerate_payload</span></span>
    </span>
  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Re-generates an encoded payload, typically called after something in the
datastore has changed.  An optional platform and architecture can be
supplied as well.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


559
560
561</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/exploit.rb', line 559</span>

<span class='kw'>def</span> <span class='id identifier rubyid_regenerate_payload'>regenerate_payload</span><span class='lparen'>(</span><span class='id identifier rubyid_platform'>platform</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_arch'>arch</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_explicit_target'>explicit_target</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_generate_single_payload'>generate_single_payload</span><span class='lparen'>(</span><span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_platform'>platform</span><span class='comma'>,</span> <span class='id identifier rubyid_arch'>arch</span><span class='comma'>,</span> <span class='id identifier rubyid_explicit_target'>explicit_target</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="register_autofilter_ports-instance_method">
  
    - (<tt>Object</tt>) <strong>register_autofilter_ports</strong>(ports = []) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Adds a port into the list of ports</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


377
378
379
380
381
382</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/exploit.rb', line 377</span>

<span class='kw'>def</span> <span class='id identifier rubyid_register_autofilter_ports'>register_autofilter_ports</span><span class='lparen'>(</span><span class='id identifier rubyid_ports'>ports</span><span class='op'>=</span><span class='lbracket'>[</span><span class='rbracket'>]</span><span class='rparen'>)</span>
  <span class='ivar'>@autofilter_ports</span> <span class='op'>||=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
  <span class='ivar'>@autofilter_ports</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_ports'>ports</span>
  <span class='ivar'>@autofilter_ports</span><span class='period'>.</span><span class='id identifier rubyid_flatten!'>flatten!</span>
  <span class='ivar'>@autofilter_ports</span><span class='period'>.</span><span class='id identifier rubyid_uniq!'>uniq!</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="register_autofilter_services-instance_method">
  
    - (<tt>Object</tt>) <strong>register_autofilter_services</strong>(services = []) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


384
385
386
387
388
389</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/exploit.rb', line 384</span>

<span class='kw'>def</span> <span class='id identifier rubyid_register_autofilter_services'>register_autofilter_services</span><span class='lparen'>(</span><span class='id identifier rubyid_services'>services</span><span class='op'>=</span><span class='lbracket'>[</span><span class='rbracket'>]</span><span class='rparen'>)</span>
  <span class='ivar'>@autofilter_services</span> <span class='op'>||=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
  <span class='ivar'>@autofilter_services</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_services'>services</span>
  <span class='ivar'>@autofilter_services</span><span class='period'>.</span><span class='id identifier rubyid_flatten!'>flatten!</span>
  <span class='ivar'>@autofilter_services</span><span class='period'>.</span><span class='id identifier rubyid_uniq!'>uniq!</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="report_failure-instance_method">
  
    - (<tt>Object</tt>) <strong>report_failure</strong> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1356
1357
1358
1359
1360
1361
1362
1363
1364
1365
1366
1367
1368
1369
1370
1371
1372
1373
1374
1375
1376
1377
1378
1379
1380
1381
1382
1383</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/exploit.rb', line 1356</span>

<span class='kw'>def</span> <span class='id identifier rubyid_report_failure'>report_failure</span>
  <span class='kw'>return</span> <span class='kw'>unless</span> <span class='id identifier rubyid_framework'>framework</span><span class='period'>.</span><span class='id identifier rubyid_db'>db</span> <span class='kw'>and</span> <span class='id identifier rubyid_framework'>framework</span><span class='period'>.</span><span class='id identifier rubyid_db'>db</span><span class='period'>.</span><span class='id identifier rubyid_active'>active</span>

  <span class='id identifier rubyid_info'>info</span> <span class='op'>=</span> <span class='lbrace'>{</span>
    <span class='symbol'>:timestamp</span>   <span class='op'>=&gt;</span> <span class='const'>Time</span><span class='period'>.</span><span class='id identifier rubyid_now'>now</span><span class='period'>.</span><span class='id identifier rubyid_utc'>utc</span><span class='comma'>,</span>
    <span class='symbol'>:workspace</span>   <span class='op'>=&gt;</span> <span class='id identifier rubyid_framework'>framework</span><span class='period'>.</span><span class='id identifier rubyid_db'>db</span><span class='period'>.</span><span class='id identifier rubyid_find_workspace'>find_workspace</span><span class='lparen'>(</span><span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_workspace'>workspace</span><span class='rparen'>)</span><span class='comma'>,</span>
    <span class='symbol'>:module</span>      <span class='op'>=&gt;</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_fullname'>fullname</span><span class='comma'>,</span>
    <span class='symbol'>:fail_reason</span> <span class='op'>=&gt;</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_fail_reason'>fail_reason</span><span class='comma'>,</span>
    <span class='symbol'>:fail_detail</span> <span class='op'>=&gt;</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_fail_detail'>fail_detail</span><span class='comma'>,</span>
    <span class='symbol'>:target_name</span> <span class='op'>=&gt;</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_target'>target</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='comma'>,</span>
    <span class='symbol'>:username</span>    <span class='op'>=&gt;</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_owner'>owner</span><span class='comma'>,</span>
    <span class='symbol'>:refs</span>        <span class='op'>=&gt;</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_references'>references</span><span class='comma'>,</span>
    <span class='symbol'>:run_id</span>      <span class='op'>=&gt;</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_datastore'>datastore</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>RUN_ID</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
  <span class='rbrace'>}</span>

  <span class='kw'>if</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_datastore'>datastore</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>RHOST</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='kw'>and</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>RHOST</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_info'>info</span><span class='lbracket'>[</span><span class='symbol'>:host</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_datastore'>datastore</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>RHOST</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
  <span class='kw'>end</span>

  <span class='kw'>if</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_datastore'>datastore</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>RPORT</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='kw'>and</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>RPORT</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_info'>info</span><span class='lbracket'>[</span><span class='symbol'>:port</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_datastore'>datastore</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>RPORT</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
    <span class='kw'>if</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='period'>.</span><span class='id identifier rubyid_ancestors'>ancestors</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='const'>Msf</span><span class='op'>::</span><span class='const'>Exploit</span><span class='op'>::</span><span class='const'>Remote</span><span class='op'>::</span><span class='const'>Tcp</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_info'>info</span><span class='lbracket'>[</span><span class='symbol'>:proto</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>tcp</span><span class='tstring_end'>&#39;</span></span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_framework'>framework</span><span class='period'>.</span><span class='id identifier rubyid_db'>db</span><span class='period'>.</span><span class='id identifier rubyid_report_exploit_failure'>report_exploit_failure</span><span class='lparen'>(</span><span class='id identifier rubyid_info'>info</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="reset_session_counts-instance_method">
  
    - (<tt>Object</tt>) <strong>reset_session_counts</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Reset the session counter to zero (which occurs during set up of the
exploit prior to calling exploit).</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1230
1231
1232</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/exploit.rb', line 1230</span>

<span class='kw'>def</span> <span class='id identifier rubyid_reset_session_counts'>reset_session_counts</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_session_count'>session_count</span> <span class='op'>=</span> <span class='int'>0</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="session_created?-instance_method">
  
    - (<tt>Boolean</tt>) <strong>session_created?</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>A boolean for whether a session has been created yet</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1222
1223
1224</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/exploit.rb', line 1222</span>

<span class='kw'>def</span> <span class='id identifier rubyid_session_created?'>session_created?</span>
  <span class='lparen'>(</span><span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_session_count'>session_count</span> <span class='op'>&gt;</span> <span class='int'>0</span><span class='rparen'>)</span> <span class='op'>?</span> <span class='kw'>true</span> <span class='op'>:</span> <span class='kw'>false</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="setup-instance_method">
  
    - (<tt>Object</tt>) <strong>setup</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Prepares the module for exploitation, initializes any state, and starts the
payload handler.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


395
396
397
398
399
400
401
402
403
404
405
406
407
408
409
410
411
412
413</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/exploit.rb', line 395</span>

<span class='kw'>def</span> <span class='id identifier rubyid_setup'>setup</span>
  <span class='comment'># Reset the session counts to zero.
</span>  <span class='id identifier rubyid_reset_session_counts'>reset_session_counts</span>

  <span class='kw'>return</span> <span class='kw'>if</span> <span class='kw'>not</span> <span class='id identifier rubyid_payload_instance'>payload_instance</span>
  <span class='kw'>return</span> <span class='kw'>if</span> <span class='kw'>not</span> <span class='id identifier rubyid_handler_enabled?'>handler_enabled?</span>

  <span class='comment'># Configure the payload handler
</span>  <span class='id identifier rubyid_payload_instance'>payload_instance</span><span class='period'>.</span><span class='id identifier rubyid_exploit_config'>exploit_config</span> <span class='op'>=</span> <span class='lbrace'>{</span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>active_timeout</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_active_timeout'>active_timeout</span>
  <span class='rbrace'>}</span>

  <span class='comment'># Set up the payload handlers
</span>  <span class='id identifier rubyid_payload_instance'>payload_instance</span><span class='period'>.</span><span class='id identifier rubyid_setup_handler'>setup_handler</span>

  <span class='comment'># Start the payload handler
</span>  <span class='id identifier rubyid_payload_instance'>payload_instance</span><span class='period'>.</span><span class='id identifier rubyid_start_handler'>start_handler</span>

<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="setup_fail_detail_from_exception-instance_method">
  
    - (<tt>Object</tt>) <strong>setup_fail_detail_from_exception</strong>(e) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1266
1267
1268
1269
1270
1271
1272
1273
1274
1275
1276
1277
1278</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/exploit.rb', line 1266</span>

<span class='kw'>def</span> <span class='id identifier rubyid_setup_fail_detail_from_exception'>setup_fail_detail_from_exception</span> <span class='id identifier rubyid_e'>e</span>
  <span class='comment'># Build a user-friendly error message
</span>  <span class='id identifier rubyid_msg'>msg</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_e'>e</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>unless</span> <span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span> <span class='op'>==</span> <span class='const'>Msf</span><span class='op'>::</span><span class='const'>Exploit</span><span class='op'>::</span><span class='const'>Failed</span>
    <span class='id identifier rubyid_msg'>msg</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='embexpr_end'>}</span><span class='tstring_content'> </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_e'>e</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>

  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_error'>error</span> <span class='op'>=</span> <span class='id identifier rubyid_e'>e</span>

  <span class='comment'># Record the detailed reason
</span>  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_fail_detail'>fail_detail</span> <span class='op'>||=</span> <span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span>
  <span class='id identifier rubyid_msg'>msg</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="stack_adjustment-instance_method">
  
    - (<tt>Object</tt>) <strong>stack_adjustment</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>This method returns the number of bytes that should be adjusted to the
stack pointer prior to executing any code.  The number of bytes to adjust
is indicated to the routine through the payload &#39;StackAdjustment&#39;
attribute or through a target&#39;s payload &#39;StackAdjustment&#39;
attribute.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


779
780
781
782
783
784
785
786
787
788
789
790
791
792
793
794
795
796
797
798</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/exploit.rb', line 779</span>

<span class='kw'>def</span> <span class='id identifier rubyid_stack_adjustment'>stack_adjustment</span>
  <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_target'>target</span> <span class='kw'>and</span> <span class='id identifier rubyid_target'>target</span><span class='period'>.</span><span class='id identifier rubyid_payload_stack_adjustment'>payload_stack_adjustment</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_adj'>adj</span> <span class='op'>=</span> <span class='id identifier rubyid_target'>target</span><span class='period'>.</span><span class='id identifier rubyid_payload_stack_adjustment'>payload_stack_adjustment</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_adj'>adj</span> <span class='op'>=</span> <span class='id identifier rubyid_payload_info'>payload_info</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>StackAdjustment</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
  <span class='kw'>end</span>

  <span class='comment'># Get the architecture for the current target or use the one specific to
</span>  <span class='comment'># this exploit
</span>  <span class='id identifier rubyid_arch'>arch</span> <span class='op'>=</span> <span class='lparen'>(</span><span class='id identifier rubyid_target'>target</span> <span class='kw'>and</span> <span class='id identifier rubyid_target'>target</span><span class='period'>.</span><span class='id identifier rubyid_arch'>arch</span><span class='rparen'>)</span> <span class='op'>?</span> <span class='id identifier rubyid_target'>target</span><span class='period'>.</span><span class='id identifier rubyid_arch'>arch</span> <span class='op'>:</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_arch'>arch</span>

  <span class='comment'># Default to x86 if we can&#39;t find a list of architectures
</span>  <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_arch'>arch</span> <span class='kw'>and</span> <span class='id identifier rubyid_arch'>arch</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span> <span class='op'>==</span> <span class='kw'>false</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_arch'>arch</span> <span class='op'>=</span> <span class='id identifier rubyid_arch'>arch</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>, </span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_arch'>arch</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>x86</span><span class='tstring_end'>&#39;</span></span>
  <span class='kw'>end</span>

  <span class='lparen'>(</span><span class='id identifier rubyid_adj'>adj</span> <span class='op'>!=</span> <span class='kw'>nil</span><span class='rparen'>)</span> <span class='op'>?</span> <span class='const'>Rex</span><span class='op'>::</span><span class='const'>Arch</span><span class='op'>::</span><span class='id identifier rubyid_adjust_stack_pointer'>adjust_stack_pointer</span><span class='lparen'>(</span><span class='id identifier rubyid_arch'>arch</span><span class='comma'>,</span> <span class='id identifier rubyid_adj'>adj</span><span class='rparen'>)</span> <span class='op'>||</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span> <span class='op'>:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="stance-instance_method">
  
    - (<tt>Object</tt>) <strong>stance</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Generally, all exploits take an aggressive stance.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


644
645
646</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/exploit.rb', line 644</span>

<span class='kw'>def</span> <span class='id identifier rubyid_stance'>stance</span>
  <span class='id identifier rubyid_module_info'>module_info</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Stance</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='const'>Stance</span><span class='op'>::</span><span class='const'>Aggressive</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="supports_check?-instance_method">
  
    - (<tt>Boolean</tt>) <strong>supports_check?</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns true if the exploit module supports the check method.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


590
591
592</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/exploit.rb', line 590</span>

<span class='kw'>def</span> <span class='id identifier rubyid_supports_check?'>supports_check?</span>
  <span class='id identifier rubyid_derived_implementor?'>derived_implementor?</span><span class='lparen'>(</span><span class='const'>Msf</span><span class='op'>::</span><span class='const'>Exploit</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>check</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="supports_exploit?-instance_method">
  
    - (<tt>Boolean</tt>) <strong>supports_exploit?</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns true if the exploit module supports the exploit method.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


597
598
599</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/exploit.rb', line 597</span>

<span class='kw'>def</span> <span class='id identifier rubyid_supports_exploit?'>supports_exploit?</span>
  <span class='id identifier rubyid_derived_implementor?'>derived_implementor?</span><span class='lparen'>(</span><span class='const'>Msf</span><span class='op'>::</span><span class='const'>Exploit</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>exploit</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="target-instance_method">
  
    - (<tt>Object</tt>) <strong>target</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the active target for this exploit.  If not target has been
defined, nil is returned.  If no target was defined but there is a default
target, that one will be automatically used.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


667
668
669
670
671</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/exploit.rb', line 667</span>

<span class='kw'>def</span> <span class='id identifier rubyid_target'>target</span>
  <span class='id identifier rubyid_target_idx'>target_idx</span> <span class='op'>=</span> <span class='id identifier rubyid_target_index'>target_index</span>

  <span class='kw'>return</span> <span class='lparen'>(</span><span class='id identifier rubyid_target_idx'>target_idx</span><span class='rparen'>)</span> <span class='op'>?</span> <span class='id identifier rubyid_targets'>targets</span><span class='lbracket'>[</span><span class='id identifier rubyid_target_idx'>target_idx</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span><span class='rbracket'>]</span> <span class='op'>:</span> <span class='kw'>nil</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="target_arch-instance_method">
  
    - (<tt>Object</tt>) <strong>target_arch</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the target&#39;s architecture, or the one assigned to the module
itself.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


697
698
699</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/exploit.rb', line 697</span>

<span class='kw'>def</span> <span class='id identifier rubyid_target_arch'>target_arch</span>
  <span class='lparen'>(</span><span class='id identifier rubyid_target'>target</span> <span class='kw'>and</span> <span class='id identifier rubyid_target'>target</span><span class='period'>.</span><span class='id identifier rubyid_arch'>arch</span><span class='rparen'>)</span> <span class='op'>?</span> <span class='id identifier rubyid_target'>target</span><span class='period'>.</span><span class='id identifier rubyid_arch'>arch</span> <span class='op'>:</span> <span class='lparen'>(</span><span class='id identifier rubyid_arch'>arch</span> <span class='op'>==</span> <span class='lbracket'>[</span><span class='rbracket'>]</span><span class='rparen'>)</span> <span class='op'>?</span> <span class='kw'>nil</span> <span class='op'>:</span> <span class='id identifier rubyid_arch'>arch</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="target_index-instance_method">
  
    - (<tt>Object</tt>) <strong>target_index</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>The target index that has been selected.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


676
677
678
679
680
681
682
683
684</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/exploit.rb', line 676</span>

<span class='kw'>def</span> <span class='id identifier rubyid_target_index'>target_index</span>
  <span class='id identifier rubyid_target_idx'>target_idx</span> <span class='op'>=</span> <span class='id identifier rubyid_datastore'>datastore</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>TARGET</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>

  <span class='comment'># Use the default target if one was not supplied.
</span>  <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_target_idx'>target_idx</span> <span class='op'>==</span> <span class='kw'>nil</span> <span class='kw'>and</span> <span class='id identifier rubyid_default_target'>default_target</span> <span class='kw'>and</span> <span class='id identifier rubyid_default_target'>default_target</span> <span class='op'>&gt;=</span> <span class='int'>0</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_target_idx'>target_idx</span> <span class='op'>=</span> <span class='id identifier rubyid_default_target'>default_target</span>
  <span class='kw'>end</span>
  <span class='kw'>return</span> <span class='lparen'>(</span><span class='id identifier rubyid_target_idx'>target_idx</span><span class='rparen'>)</span> <span class='op'>?</span> <span class='id identifier rubyid_target_idx'>target_idx</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span> <span class='op'>:</span> <span class='kw'>nil</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="target_platform-instance_method">
  
    - (<tt>Object</tt>) <strong>target_platform</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the target&#39;s platform, or the one assigned to the module
itself.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


689
690
691</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/exploit.rb', line 689</span>

<span class='kw'>def</span> <span class='id identifier rubyid_target_platform'>target_platform</span>
  <span class='lparen'>(</span><span class='id identifier rubyid_target'>target</span> <span class='kw'>and</span> <span class='id identifier rubyid_target'>target</span><span class='period'>.</span><span class='id identifier rubyid_platform'>platform</span><span class='rparen'>)</span> <span class='op'>?</span> <span class='id identifier rubyid_target'>target</span><span class='period'>.</span><span class='id identifier rubyid_platform'>platform</span> <span class='op'>:</span> <span class='id identifier rubyid_platform'>platform</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="type-instance_method">
  
    - (<tt>Object</tt>) <strong>type</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns MODULE_EXPLOIT to indicate that this is an exploit module.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


630
631
632</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/exploit.rb', line 630</span>

<span class='kw'>def</span> <span class='id identifier rubyid_type'>type</span>
  <span class='const'>Msf</span><span class='op'>::</span><span class='const'>MODULE_EXPLOIT</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="wfs_delay-instance_method">
  
    - (<tt>Object</tt>) <strong>wfs_delay</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>The default “wait for session” delay is zero for all exploits.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1177
1178
1179</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/exploit.rb', line 1177</span>

<span class='kw'>def</span> <span class='id identifier rubyid_wfs_delay'>wfs_delay</span>
  <span class='lparen'>(</span><span class='id identifier rubyid_datastore'>datastore</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>WfsDelay</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='int'>0</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

    <div id="footer">
  Generated on Tue Jan 19 22:35:34 2016 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.8.7.6 (ruby-2.1.7).
</div>

  </body>
</html>