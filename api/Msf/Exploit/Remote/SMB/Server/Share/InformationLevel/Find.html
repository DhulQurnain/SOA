<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>
  Module: Msf::Exploit::Remote::SMB::Server::Share::InformationLevel::Find
  
    &mdash; Documentation by YARD 0.8.7.6
  
</title>

  <link rel="stylesheet" href="../../../../../../../css/style.css" type="text/css" charset="utf-8" />

  <link rel="stylesheet" href="../../../../../../../css/common.css" type="text/css" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  hasFrames = window.top.frames.main ? true : false;
  relpath = '../../../../../../../';
  framesUrl = "../../../../../../../frames.html#!Msf/Exploit/Remote/SMB/Server/Share/InformationLevel/Find.html";
</script>


  <script type="text/javascript" charset="utf-8" src="../../../../../../../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../../../../../../../js/app.js"></script>


  </head>
  <body>
    <div id="header">
      <div id="menu">
  
    <a href="../../../../../../../_index.html">Index (F)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../../../../../../../Msf.html" title="Msf (module)">Msf</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../../../../../../Exploit.html" title="Msf::Exploit (class)">Exploit</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../../../../../Remote.html" title="Msf::Exploit::Remote (class)">Remote</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../../../../SMB.html" title="Msf::Exploit::Remote::SMB (module)">SMB</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../../../Server.html" title="Msf::Exploit::Remote::SMB::Server (module)">Server</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../../Share.html" title="Msf::Exploit::Remote::SMB::Server::Share (module)">Share</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../InformationLevel.html" title="Msf::Exploit::Remote::SMB::Server::Share::InformationLevel (module)">InformationLevel</a></span></span>
     &raquo; 
    <span class="title">Find</span>
  

  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../../../../../../../class_list.html">
      Class List
    </a>
  
    <a class="full_list_link" id="method_list_link"
        href="../../../../../../../method_list.html">
      Method List
    </a>
  
    <a class="full_list_link" id="file_list_link"
        href="../../../../../../../file_list.html">
      File List
    </a>
  
</div>
      <div class="clear"></div>
    </div>

    <iframe id="search_frame"></iframe>

    <div id="content"><h1>Module: Msf::Exploit::Remote::SMB::Server::Share::InformationLevel::Find
  
  
  
</h1>

<dl class="box">
  
  
    
  
    
  
  
    <dt class="r1">Included in:</dt>
    <dd class="r1"><span class='object_link'><a href="../../Share.html" title="Msf::Exploit::Remote::SMB::Server::Share (module)">Msf::Exploit::Remote::SMB::Server::Share</a></span></dd>
    
  
  
    <dt class="r2 last">Defined in:</dt>
    <dd class="r2 last">lib/msf/core/exploit/smb/server/share/information_level/find.rb</dd>
  
</dl>
<div class="clear"></div>








  
    <h2>
      Instance Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#send_find_file_both_directory_info_res-instance_method" title="#send_find_file_both_directory_info_res (instance method)">- (Fixnum) <strong>send_find_file_both_directory_info_res</strong>(c, opts = {}) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Builds and sends an TRANS2_FIND_FIRST2 response with
SMB_FIND_FILE_BOTH_DIRECTORY_INFO information level.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#send_find_file_names_info_res-instance_method" title="#send_find_file_names_info_res (instance method)">- (Fixnum) <strong>send_find_file_names_info_res</strong>(c, opts = {}) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Builds and sends an TRANS2_FIND_FIRST2 response with
SMB_FIND_FILE_NAMES_INFO information level.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#send_find_full_directory_info_res-instance_method" title="#send_find_full_directory_info_res (instance method)">- (Fixnum) <strong>send_find_full_directory_info_res</strong>(c, opts = {}) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Builds and sends an TRANS2_FIND_FIRST2 response with
SMB_FIND_FILE_FULL_DIRECTORY_INFO information level.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#smb_cmd_find_file_both_directory_info-instance_method" title="#smb_cmd_find_file_both_directory_info (instance method)">- (Fixnum) <strong>smb_cmd_find_file_both_directory_info</strong>(c, path) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Handles a TRANS2_FIND_FIRST2 transaction request with
SMB_FIND_FILE_BOTH_DIRECTORY_INFO Information Level.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#smb_cmd_find_file_full_directory_info-instance_method" title="#smb_cmd_find_file_full_directory_info (instance method)">- (Fixnum) <strong>smb_cmd_find_file_full_directory_info</strong>(c, path) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Handles a TRANS2_FIND_FIRST2 transaction request with
SMB_FIND_FILE_FULL_DIRECTORY_INFO Information Level.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#smb_cmd_find_file_names_info-instance_method" title="#smb_cmd_find_file_names_info (instance method)">- (Fixnum) <strong>smb_cmd_find_file_names_info</strong>(c, path) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Handles a TRANS2_FIND_FIRST2 transaction request with
SMB_FIND_FILE_NAMES_INFO Information Level.</p>
</div></span>
  
</li>

      
    </ul>
  



  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="send_find_file_both_directory_info_res-instance_method">
  
    - (<tt>Fixnum</tt>) <strong>send_find_file_both_directory_info_res</strong>(c, opts = {}) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Builds and sends an TRANS2_FIND_FIRST2 response with
SMB_FIND_FILE_BOTH_DIRECTORY_INFO information level.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>c</span>
      
      
        <span class='type'>(<tt>Socket</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The client to answer.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>opts</span>
      
      
        <span class='type'>(<tt>Hash{Symbol =&gt; &lt;Fixnum, String&gt;}</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>{}</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>Response custom values.</p>
</div>
      
    </li>
  
</ul>

  
    
    
    
    
    <p class="tag_title">Options Hash (<tt>opts</tt>):</p>
    <ul class="option">
      
        <li>
          <span class="name">:search_count</span>
          <span class="type">(<tt>Fixnum</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>The number of entries returned by the search.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:end_of_search</span>
          <span class="type">(<tt>Fixnum</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>0 if search continues or nonzero otherwise.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:ea_error_offset</span>
          <span class="type">(<tt>Fixnum</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>should be 0 for SMB_FIND_FILE_BOTH_DIRECTORY_INFO.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:end_of_file</span>
          <span class="type">(<tt>Fixnum</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>The byte offset to the end of the file.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:allocation_size</span>
          <span class="type">(<tt>Fixnum</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>The file allocation size in bytes.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:file_attributes</span>
          <span class="type">(<tt>Fixnum</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>The extended file attributes of the file.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:data</span>
          <span class="type">(<tt>String</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>The long name of the file.</p>
</div>
          
        </li>
      
    </ul>
  

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Fixnum</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The number of bytes returned to the client as response.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/exploit/smb/server/share/information_level/find.rb', line 132</span>

<span class='kw'>def</span> <span class='id identifier rubyid_send_find_file_both_directory_info_res'>send_find_file_both_directory_info_res</span><span class='lparen'>(</span><span class='id identifier rubyid_c'>c</span><span class='comma'>,</span> <span class='id identifier rubyid_opts'>opts</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_data'>data</span> <span class='op'>=</span> <span class='id identifier rubyid_opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:data</span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span>
  <span class='id identifier rubyid_search_count'>search_count</span> <span class='op'>=</span> <span class='id identifier rubyid_opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:search_count</span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='int'>0</span>
  <span class='id identifier rubyid_end_of_search'>end_of_search</span> <span class='op'>=</span> <span class='id identifier rubyid_opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:end_of_search</span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='int'>0</span>
  <span class='id identifier rubyid_ea_error_offset'>ea_error_offset</span> <span class='op'>=</span> <span class='id identifier rubyid_opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:ea_error_offset</span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='int'>0</span>
  <span class='id identifier rubyid_end_of_file'>end_of_file</span> <span class='op'>=</span> <span class='id identifier rubyid_opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:end_of_file</span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='int'>0</span>
  <span class='id identifier rubyid_allocation_size'>allocation_size</span> <span class='op'>=</span> <span class='id identifier rubyid_opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:allocation_size</span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='int'>0</span>
  <span class='id identifier rubyid_file_attributes'>file_attributes</span> <span class='op'>=</span> <span class='id identifier rubyid_opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:file_attributes</span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='int'>0</span>

  <span class='id identifier rubyid_pkt'>pkt</span> <span class='op'>=</span> <span class='const'>CONST</span><span class='op'>::</span><span class='const'>SMB_TRANS_RES_PKT</span><span class='period'>.</span><span class='id identifier rubyid_make_struct'>make_struct</span>
  <span class='id identifier rubyid_smb_set_defaults'>smb_set_defaults</span><span class='lparen'>(</span><span class='id identifier rubyid_c'>c</span><span class='comma'>,</span> <span class='id identifier rubyid_pkt'>pkt</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_trans2_params'>trans2_params</span> <span class='op'>=</span> <span class='const'>CONST</span><span class='op'>::</span><span class='const'>SMB_TRANS2_FIND_FIRST2_RES_PARAMETERS</span><span class='period'>.</span><span class='id identifier rubyid_make_struct'>make_struct</span>
  <span class='id identifier rubyid_trans2_params'>trans2_params</span><span class='period'>.</span><span class='id identifier rubyid_v'>v</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>SID</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='int'>0xfffd</span>
  <span class='id identifier rubyid_trans2_params'>trans2_params</span><span class='period'>.</span><span class='id identifier rubyid_v'>v</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>SearchCount</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_search_count'>search_count</span>
  <span class='id identifier rubyid_trans2_params'>trans2_params</span><span class='period'>.</span><span class='id identifier rubyid_v'>v</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>EndOfSearch</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_end_of_search'>end_of_search</span>
  <span class='id identifier rubyid_trans2_params'>trans2_params</span><span class='period'>.</span><span class='id identifier rubyid_v'>v</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>EaErrorOffset</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_ea_error_offset'>ea_error_offset</span>
  <span class='id identifier rubyid_trans2_params'>trans2_params</span><span class='period'>.</span><span class='id identifier rubyid_v'>v</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>LastNameOffset</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='int'>0</span>

  <span class='id identifier rubyid_find_file'>find_file</span> <span class='op'>=</span> <span class='const'>CONST</span><span class='op'>::</span><span class='const'>SMB_FIND_FILE_BOTH_DIRECTORY_INFO_HDR</span><span class='period'>.</span><span class='id identifier rubyid_make_struct'>make_struct</span>
  <span class='id identifier rubyid_find_file'>find_file</span><span class='period'>.</span><span class='id identifier rubyid_v'>v</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>NextEntryOffset</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='const'>CONST</span><span class='op'>::</span><span class='const'>SMB_FIND_FILE_BOTH_DIRECTORY_INFO_HDR_LENGTH</span> <span class='op'>+</span> <span class='id identifier rubyid_data'>data</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span>
  <span class='id identifier rubyid_find_file'>find_file</span><span class='period'>.</span><span class='id identifier rubyid_v'>v</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>FileIndex</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='int'>0</span>
  <span class='id identifier rubyid_find_file'>find_file</span><span class='period'>.</span><span class='id identifier rubyid_v'>v</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>loCreationTime</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_lo'>lo</span>
  <span class='id identifier rubyid_find_file'>find_file</span><span class='period'>.</span><span class='id identifier rubyid_v'>v</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>hiCreationTime</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_hi'>hi</span>
  <span class='id identifier rubyid_find_file'>find_file</span><span class='period'>.</span><span class='id identifier rubyid_v'>v</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>loLastAccessTime</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_lo'>lo</span>
  <span class='id identifier rubyid_find_file'>find_file</span><span class='period'>.</span><span class='id identifier rubyid_v'>v</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>hiLastAccessTime</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_hi'>hi</span>
  <span class='id identifier rubyid_find_file'>find_file</span><span class='period'>.</span><span class='id identifier rubyid_v'>v</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>loLastWriteTime</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_lo'>lo</span>
  <span class='id identifier rubyid_find_file'>find_file</span><span class='period'>.</span><span class='id identifier rubyid_v'>v</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>hiLastWriteTime</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_hi'>hi</span>
  <span class='id identifier rubyid_find_file'>find_file</span><span class='period'>.</span><span class='id identifier rubyid_v'>v</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>loLastChangeTime</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_lo'>lo</span>
  <span class='id identifier rubyid_find_file'>find_file</span><span class='period'>.</span><span class='id identifier rubyid_v'>v</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>hiLastChangeTime</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_hi'>hi</span>
  <span class='id identifier rubyid_find_file'>find_file</span><span class='period'>.</span><span class='id identifier rubyid_v'>v</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>EndOfFile</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_end_of_file'>end_of_file</span>
  <span class='id identifier rubyid_find_file'>find_file</span><span class='period'>.</span><span class='id identifier rubyid_v'>v</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>AllocationSize</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_allocation_size'>allocation_size</span>
  <span class='id identifier rubyid_find_file'>find_file</span><span class='period'>.</span><span class='id identifier rubyid_v'>v</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>ExtFileAttributes</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_file_attributes'>file_attributes</span>
  <span class='id identifier rubyid_find_file'>find_file</span><span class='period'>.</span><span class='id identifier rubyid_v'>v</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>FileName</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_data'>data</span>

  <span class='id identifier rubyid_send_trans2_res'>send_trans2_res</span><span class='lparen'>(</span><span class='id identifier rubyid_c'>c</span><span class='comma'>,</span> <span class='id identifier rubyid_trans2_params'>trans2_params</span><span class='comma'>,</span> <span class='id identifier rubyid_find_file'>find_file</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="send_find_file_names_info_res-instance_method">
  
    - (<tt>Fixnum</tt>) <strong>send_find_file_names_info_res</strong>(c, opts = {}) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Builds and sends an TRANS2_FIND_FIRST2 response with
SMB_FIND_FILE_NAMES_INFO information level.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>c</span>
      
      
        <span class='type'>(<tt>Socket</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The client to answer.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>opts</span>
      
      
        <span class='type'>(<tt>Hash{Symbol =&gt; &lt;Fixnum, String&gt;}</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>{}</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>Response custom values.</p>
</div>
      
    </li>
  
</ul>

  
    
    
    
    
    <p class="tag_title">Options Hash (<tt>opts</tt>):</p>
    <ul class="option">
      
        <li>
          <span class="name">:data</span>
          <span class="type">(<tt>String</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>The long name of the file.</p>
</div>
          
        </li>
      
    </ul>
  

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Fixnum</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The number of bytes returned to the client as response.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/exploit/smb/server/share/information_level/find.rb', line 176</span>

<span class='kw'>def</span> <span class='id identifier rubyid_send_find_file_names_info_res'>send_find_file_names_info_res</span><span class='lparen'>(</span><span class='id identifier rubyid_c'>c</span><span class='comma'>,</span> <span class='id identifier rubyid_opts'>opts</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_data'>data</span> <span class='op'>=</span> <span class='id identifier rubyid_opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:data</span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span>

  <span class='id identifier rubyid_pkt'>pkt</span> <span class='op'>=</span> <span class='const'>CONST</span><span class='op'>::</span><span class='const'>SMB_TRANS_RES_PKT</span><span class='period'>.</span><span class='id identifier rubyid_make_struct'>make_struct</span>
  <span class='id identifier rubyid_smb_set_defaults'>smb_set_defaults</span><span class='lparen'>(</span><span class='id identifier rubyid_c'>c</span><span class='comma'>,</span> <span class='id identifier rubyid_pkt'>pkt</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_find_file'>find_file</span> <span class='op'>=</span> <span class='const'>CONST</span><span class='op'>::</span><span class='const'>SMB_FIND_FILE_NAMES_INFO_HDR</span><span class='period'>.</span><span class='id identifier rubyid_make_struct'>make_struct</span>
  <span class='id identifier rubyid_find_file'>find_file</span><span class='period'>.</span><span class='id identifier rubyid_v'>v</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>NextEntryOffset</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='const'>CONST</span><span class='op'>::</span><span class='const'>SMB_FIND_FILE_NAMES_INFO_HDR_LENGTH</span> <span class='op'>+</span> <span class='id identifier rubyid_data'>data</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span>
  <span class='id identifier rubyid_find_file'>find_file</span><span class='period'>.</span><span class='id identifier rubyid_v'>v</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>FileIndex</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='int'>0</span>
  <span class='id identifier rubyid_find_file'>find_file</span><span class='period'>.</span><span class='id identifier rubyid_v'>v</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>FileName</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_data'>data</span>

  <span class='id identifier rubyid_trans2_params'>trans2_params</span> <span class='op'>=</span> <span class='const'>CONST</span><span class='op'>::</span><span class='const'>SMB_TRANS2_FIND_FIRST2_RES_PARAMETERS</span><span class='period'>.</span><span class='id identifier rubyid_make_struct'>make_struct</span>
  <span class='id identifier rubyid_trans2_params'>trans2_params</span><span class='period'>.</span><span class='id identifier rubyid_v'>v</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>SID</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='int'>0xfffd</span>
  <span class='id identifier rubyid_trans2_params'>trans2_params</span><span class='period'>.</span><span class='id identifier rubyid_v'>v</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>SearchCount</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='int'>1</span>
  <span class='id identifier rubyid_trans2_params'>trans2_params</span><span class='period'>.</span><span class='id identifier rubyid_v'>v</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>EndOfSearch</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='int'>1</span>
  <span class='id identifier rubyid_trans2_params'>trans2_params</span><span class='period'>.</span><span class='id identifier rubyid_v'>v</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>EaErrorOffset</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='int'>0</span>
  <span class='id identifier rubyid_trans2_params'>trans2_params</span><span class='period'>.</span><span class='id identifier rubyid_v'>v</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>LastNameOffset</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='int'>0</span>

  <span class='id identifier rubyid_send_trans2_res'>send_trans2_res</span><span class='lparen'>(</span><span class='id identifier rubyid_c'>c</span><span class='comma'>,</span> <span class='id identifier rubyid_trans2_params'>trans2_params</span><span class='comma'>,</span> <span class='id identifier rubyid_find_file'>find_file</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="send_find_full_directory_info_res-instance_method">
  
    - (<tt>Fixnum</tt>) <strong>send_find_full_directory_info_res</strong>(c, opts = {}) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Builds and sends an TRANS2_FIND_FIRST2 response with
SMB_FIND_FILE_FULL_DIRECTORY_INFO information level.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>c</span>
      
      
        <span class='type'>(<tt>Socket</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The client to answer.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>opts</span>
      
      
        <span class='type'>(<tt>Hash{Symbol =&gt; &lt;Fixnum, String&gt;}</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>{}</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>Response custom values.</p>
</div>
      
    </li>
  
</ul>

  
    
    
    
    
    <p class="tag_title">Options Hash (<tt>opts</tt>):</p>
    <ul class="option">
      
        <li>
          <span class="name">:search_count</span>
          <span class="type">(<tt>Fixnum</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>The number of entries returned by the search.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:end_of_search</span>
          <span class="type">(<tt>Fixnum</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>0 if search continues or nonzero otherwise.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:ea_error_offset</span>
          <span class="type">(<tt>Fixnum</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>should be 0 for SMB_FIND_FILE_FULL_DIRECTORY_INFO.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:end_of_file</span>
          <span class="type">(<tt>Fixnum</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>The byte offset to the end of the file.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:allocation_size</span>
          <span class="type">(<tt>Fixnum</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>The file allocation size in bytes.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:file_attributes</span>
          <span class="type">(<tt>Fixnum</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>The extended file attributes of the file.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:data</span>
          <span class="type">(<tt>String</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>The long name of the file.</p>
</div>
          
        </li>
      
    </ul>
  

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Fixnum</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The number of bytes returned to the client as response.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/exploit/smb/server/share/information_level/find.rb', line 210</span>

<span class='kw'>def</span> <span class='id identifier rubyid_send_find_full_directory_info_res'>send_find_full_directory_info_res</span><span class='lparen'>(</span><span class='id identifier rubyid_c'>c</span><span class='comma'>,</span> <span class='id identifier rubyid_opts'>opts</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_data'>data</span> <span class='op'>=</span> <span class='id identifier rubyid_opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:data</span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span>
  <span class='id identifier rubyid_search_count'>search_count</span> <span class='op'>=</span> <span class='id identifier rubyid_opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:search_count</span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='int'>0</span>
  <span class='id identifier rubyid_end_of_search'>end_of_search</span> <span class='op'>=</span> <span class='id identifier rubyid_opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:end_of_search</span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='int'>0</span>
  <span class='id identifier rubyid_ea_error_offset'>ea_error_offset</span> <span class='op'>=</span> <span class='id identifier rubyid_opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:ea_error_offset</span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='int'>0</span>
  <span class='id identifier rubyid_end_of_file'>end_of_file</span> <span class='op'>=</span> <span class='id identifier rubyid_opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:end_of_file</span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='int'>0</span>
  <span class='id identifier rubyid_allocation_size'>allocation_size</span> <span class='op'>=</span> <span class='id identifier rubyid_opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:allocation_size</span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='int'>0</span>
  <span class='id identifier rubyid_file_attributes'>file_attributes</span> <span class='op'>=</span> <span class='id identifier rubyid_opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:file_attributes</span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='int'>0</span>

  <span class='id identifier rubyid_find_file'>find_file</span> <span class='op'>=</span> <span class='const'>CONST</span><span class='op'>::</span><span class='const'>SMB_FIND_FILE_FULL_DIRECTORY_INFO_HDR</span><span class='period'>.</span><span class='id identifier rubyid_make_struct'>make_struct</span>
  <span class='id identifier rubyid_find_file'>find_file</span><span class='period'>.</span><span class='id identifier rubyid_v'>v</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>NextEntryOffset</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='const'>CONST</span><span class='op'>::</span><span class='const'>SMB_FIND_FILE_FULL_DIRECTORY_INFO_HDR_LENGTH</span> <span class='op'>+</span> <span class='id identifier rubyid_data'>data</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span>
  <span class='id identifier rubyid_find_file'>find_file</span><span class='period'>.</span><span class='id identifier rubyid_v'>v</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>FileIndex</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='int'>0</span>
  <span class='id identifier rubyid_find_file'>find_file</span><span class='period'>.</span><span class='id identifier rubyid_v'>v</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>loCreationTime</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_lo'>lo</span>
  <span class='id identifier rubyid_find_file'>find_file</span><span class='period'>.</span><span class='id identifier rubyid_v'>v</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>hiCreationTime</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_hi'>hi</span>
  <span class='id identifier rubyid_find_file'>find_file</span><span class='period'>.</span><span class='id identifier rubyid_v'>v</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>loLastAccessTime</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_lo'>lo</span>
  <span class='id identifier rubyid_find_file'>find_file</span><span class='period'>.</span><span class='id identifier rubyid_v'>v</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>hiLastAccessTime</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_hi'>hi</span>
  <span class='id identifier rubyid_find_file'>find_file</span><span class='period'>.</span><span class='id identifier rubyid_v'>v</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>loLastWriteTime</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_lo'>lo</span>
  <span class='id identifier rubyid_find_file'>find_file</span><span class='period'>.</span><span class='id identifier rubyid_v'>v</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>hiLastWriteTime</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_hi'>hi</span>
  <span class='id identifier rubyid_find_file'>find_file</span><span class='period'>.</span><span class='id identifier rubyid_v'>v</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>loLastChangeTime</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_lo'>lo</span>
  <span class='id identifier rubyid_find_file'>find_file</span><span class='period'>.</span><span class='id identifier rubyid_v'>v</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>hiLastChangeTime</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_hi'>hi</span>
  <span class='id identifier rubyid_find_file'>find_file</span><span class='period'>.</span><span class='id identifier rubyid_v'>v</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>EndOfFile</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_end_of_file'>end_of_file</span>
  <span class='id identifier rubyid_find_file'>find_file</span><span class='period'>.</span><span class='id identifier rubyid_v'>v</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>AllocationSize</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_allocation_size'>allocation_size</span>
  <span class='id identifier rubyid_find_file'>find_file</span><span class='period'>.</span><span class='id identifier rubyid_v'>v</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>ExtFileAttributes</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_file_attributes'>file_attributes</span>
  <span class='id identifier rubyid_find_file'>find_file</span><span class='period'>.</span><span class='id identifier rubyid_v'>v</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>FileName</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_data'>data</span>

  <span class='id identifier rubyid_trans2_params'>trans2_params</span> <span class='op'>=</span> <span class='const'>CONST</span><span class='op'>::</span><span class='const'>SMB_TRANS2_FIND_FIRST2_RES_PARAMETERS</span><span class='period'>.</span><span class='id identifier rubyid_make_struct'>make_struct</span>
  <span class='id identifier rubyid_trans2_params'>trans2_params</span><span class='period'>.</span><span class='id identifier rubyid_v'>v</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>SID</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='int'>0xfffd</span>
  <span class='id identifier rubyid_trans2_params'>trans2_params</span><span class='period'>.</span><span class='id identifier rubyid_v'>v</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>SearchCount</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_search_count'>search_count</span>
  <span class='id identifier rubyid_trans2_params'>trans2_params</span><span class='period'>.</span><span class='id identifier rubyid_v'>v</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>EndOfSearch</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_end_of_search'>end_of_search</span>
  <span class='id identifier rubyid_trans2_params'>trans2_params</span><span class='period'>.</span><span class='id identifier rubyid_v'>v</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>EaErrorOffset</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_ea_error_offset'>ea_error_offset</span>
  <span class='id identifier rubyid_trans2_params'>trans2_params</span><span class='period'>.</span><span class='id identifier rubyid_v'>v</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>LastNameOffset</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='int'>0</span>

  <span class='id identifier rubyid_send_trans2_res'>send_trans2_res</span><span class='lparen'>(</span><span class='id identifier rubyid_c'>c</span><span class='comma'>,</span> <span class='id identifier rubyid_trans2_params'>trans2_params</span><span class='comma'>,</span> <span class='id identifier rubyid_find_file'>find_file</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="smb_cmd_find_file_both_directory_info-instance_method">
  
    - (<tt>Fixnum</tt>) <strong>smb_cmd_find_file_both_directory_info</strong>(c, path) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Handles a TRANS2_FIND_FIRST2 transaction request with
SMB_FIND_FILE_BOTH_DIRECTORY_INFO Information Level.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>c</span>
      
      
        <span class='type'>(<tt>Socket</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The client sending the request.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>path</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The path which the client is requesting info from.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Fixnum</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The number of bytes returned to the client as response.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/exploit/smb/server/share/information_level/find.rb', line 15</span>

<span class='kw'>def</span> <span class='id identifier rubyid_smb_cmd_find_file_both_directory_info'>smb_cmd_find_file_both_directory_info</span><span class='lparen'>(</span><span class='id identifier rubyid_c'>c</span><span class='comma'>,</span> <span class='id identifier rubyid_path'>path</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_contents'>contents</span> <span class='op'>=</span> <span class='id identifier rubyid_get_file_contents'>get_file_contents</span><span class='lparen'>(</span><span class='label'>client:</span> <span class='id identifier rubyid_c'>c</span><span class='rparen'>)</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_path'>path</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_path'>path</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_file_name'>file_name</span><span class='period'>.</span><span class='id identifier rubyid_downcase'>downcase</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_data'>data</span> <span class='op'>=</span> <span class='const'>Rex</span><span class='op'>::</span><span class='const'>Text</span><span class='period'>.</span><span class='id identifier rubyid_to_unicode'>to_unicode</span><span class='lparen'>(</span><span class='id identifier rubyid_file_name'>file_name</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_length'>length</span> <span class='op'>=</span> <span class='id identifier rubyid_contents'>contents</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span>
    <span class='id identifier rubyid_ea'>ea</span> <span class='op'>=</span> <span class='int'>0</span>
    <span class='id identifier rubyid_alloc'>alloc</span> <span class='op'>=</span> <span class='int'>1048576</span> <span class='comment'># Allocation Size = 1048576 || 1Mb
</span>    <span class='id identifier rubyid_attrib'>attrib</span> <span class='op'>=</span> <span class='const'>CONST</span><span class='op'>::</span><span class='const'>SMB_EXT_FILE_ATTR_NORMAL</span>
    <span class='id identifier rubyid_search'>search</span> <span class='op'>=</span> <span class='int'>1</span>
  <span class='kw'>elsif</span> <span class='id identifier rubyid_path'>path</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_folder_name'>folder_name</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_path'>path</span><span class='period'>.</span><span class='id identifier rubyid_ends_with?'>ends_with?</span><span class='lparen'>(</span><span class='id identifier rubyid_folder_name'>folder_name</span><span class='period'>.</span><span class='id identifier rubyid_downcase'>downcase</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_data'>data</span> <span class='op'>=</span> <span class='const'>Rex</span><span class='op'>::</span><span class='const'>Text</span><span class='period'>.</span><span class='id identifier rubyid_to_unicode'>to_unicode</span><span class='lparen'>(</span><span class='id identifier rubyid_path'>path</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_length'>length</span> <span class='op'>=</span> <span class='int'>0</span>
    <span class='id identifier rubyid_ea'>ea</span> <span class='op'>=</span> <span class='int'>0x21</span>
    <span class='id identifier rubyid_alloc'>alloc</span> <span class='op'>=</span> <span class='int'>0</span> <span class='comment'># 0Mb
</span>    <span class='id identifier rubyid_attrib'>attrib</span> <span class='op'>=</span> <span class='const'>CONST</span><span class='op'>::</span><span class='const'>SMB_EXT_FILE_ATTR_DIRECTORY</span>
    <span class='id identifier rubyid_search'>search</span> <span class='op'>=</span> <span class='int'>0x100</span>
  <span class='kw'>elsif</span> <span class='id identifier rubyid_path'>path</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_path'>path</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\\</span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_data'>data</span> <span class='op'>=</span> <span class='const'>Rex</span><span class='op'>::</span><span class='const'>Text</span><span class='period'>.</span><span class='id identifier rubyid_to_unicode'>to_unicode</span><span class='lparen'>(</span><span class='id identifier rubyid_path'>path</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_length'>length</span> <span class='op'>=</span> <span class='int'>0</span>
    <span class='id identifier rubyid_ea'>ea</span> <span class='op'>=</span> <span class='int'>0x21</span>
    <span class='id identifier rubyid_alloc'>alloc</span> <span class='op'>=</span> <span class='int'>0</span> <span class='comment'># 0Mb
</span>    <span class='id identifier rubyid_attrib'>attrib</span> <span class='op'>=</span> <span class='const'>CONST</span><span class='op'>::</span><span class='const'>SMB_EXT_FILE_ATTR_DIRECTORY</span>
    <span class='id identifier rubyid_search'>search</span> <span class='op'>=</span> <span class='int'>0x100</span>
  <span class='kw'>else</span>
    <span class='kw'>return</span> <span class='id identifier rubyid_smb_error'>smb_error</span><span class='lparen'>(</span><span class='const'>CONST</span><span class='op'>::</span><span class='const'>SMB_COM_TRANSACTION2</span><span class='comma'>,</span> <span class='id identifier rubyid_c'>c</span><span class='comma'>,</span> <span class='const'>CONST</span><span class='op'>::</span><span class='const'>SMB_STATUS_NO_SUCH_FILE</span><span class='comma'>,</span> <span class='kw'>true</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_send_find_file_both_directory_info_res'>send_find_file_both_directory_info_res</span><span class='lparen'>(</span><span class='id identifier rubyid_c'>c</span><span class='comma'>,</span> <span class='lbrace'>{</span>
    <span class='label'>data:</span> <span class='id identifier rubyid_data'>data</span><span class='comma'>,</span>
    <span class='label'>end_of_file:</span> <span class='id identifier rubyid_length'>length</span><span class='comma'>,</span>
    <span class='label'>ea_error_offset:</span> <span class='id identifier rubyid_ea'>ea</span><span class='comma'>,</span>
    <span class='label'>allocation_size:</span> <span class='id identifier rubyid_alloc'>alloc</span><span class='comma'>,</span>
    <span class='label'>file_attributes:</span> <span class='id identifier rubyid_attrib'>attrib</span><span class='comma'>,</span>
    <span class='label'>search_count:</span> <span class='id identifier rubyid_search'>search</span><span class='comma'>,</span>
    <span class='label'>search_offset:</span> <span class='id identifier rubyid_search'>search</span>
  <span class='rbrace'>}</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="smb_cmd_find_file_full_directory_info-instance_method">
  
    - (<tt>Fixnum</tt>) <strong>smb_cmd_find_file_full_directory_info</strong>(c, path) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Handles a TRANS2_FIND_FIRST2 transaction request with
SMB_FIND_FILE_FULL_DIRECTORY_INFO Information Level.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>c</span>
      
      
        <span class='type'>(<tt>Socket</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The client sending the request.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>path</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The path which the client is requesting info from.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Fixnum</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The number of bytes returned to the client as response.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/exploit/smb/server/share/information_level/find.rb', line 80</span>

<span class='kw'>def</span> <span class='id identifier rubyid_smb_cmd_find_file_full_directory_info'>smb_cmd_find_file_full_directory_info</span><span class='lparen'>(</span><span class='id identifier rubyid_c'>c</span><span class='comma'>,</span> <span class='id identifier rubyid_path'>path</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_contents'>contents</span> <span class='op'>=</span> <span class='id identifier rubyid_get_file_contents'>get_file_contents</span><span class='lparen'>(</span><span class='label'>client:</span> <span class='id identifier rubyid_c'>c</span><span class='rparen'>)</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_path'>path</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_path'>path</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_file_name'>file_name</span><span class='period'>.</span><span class='id identifier rubyid_downcase'>downcase</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_data'>data</span> <span class='op'>=</span> <span class='const'>Rex</span><span class='op'>::</span><span class='const'>Text</span><span class='period'>.</span><span class='id identifier rubyid_to_unicode'>to_unicode</span><span class='lparen'>(</span><span class='id identifier rubyid_file_name'>file_name</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_length'>length</span> <span class='op'>=</span> <span class='id identifier rubyid_contents'>contents</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span>
    <span class='id identifier rubyid_ea'>ea</span> <span class='op'>=</span> <span class='int'>0</span>
    <span class='id identifier rubyid_alloc'>alloc</span> <span class='op'>=</span> <span class='int'>1048576</span> <span class='comment'># Allocation Size = 1048576 || 1Mb
</span>    <span class='id identifier rubyid_attrib'>attrib</span> <span class='op'>=</span> <span class='const'>CONST</span><span class='op'>::</span><span class='const'>SMB_EXT_FILE_ATTR_NORMAL</span> <span class='comment'># File
</span>    <span class='id identifier rubyid_search'>search</span> <span class='op'>=</span> <span class='int'>0x100</span>
  <span class='kw'>elsif</span> <span class='id identifier rubyid_path'>path</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_folder_name'>folder_name</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_path'>path</span><span class='period'>.</span><span class='id identifier rubyid_ends_with?'>ends_with?</span><span class='lparen'>(</span><span class='id identifier rubyid_folder_name'>folder_name</span><span class='period'>.</span><span class='id identifier rubyid_downcase'>downcase</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_data'>data</span> <span class='op'>=</span> <span class='const'>Rex</span><span class='op'>::</span><span class='const'>Text</span><span class='period'>.</span><span class='id identifier rubyid_to_unicode'>to_unicode</span><span class='lparen'>(</span><span class='id identifier rubyid_path'>path</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_length'>length</span> <span class='op'>=</span> <span class='int'>0</span>
    <span class='id identifier rubyid_ea'>ea</span> <span class='op'>=</span> <span class='int'>0x21</span>
    <span class='id identifier rubyid_alloc'>alloc</span> <span class='op'>=</span> <span class='int'>0</span> <span class='comment'># 0Mb
</span>    <span class='id identifier rubyid_attrib'>attrib</span> <span class='op'>=</span> <span class='const'>CONST</span><span class='op'>::</span><span class='const'>SMB_EXT_FILE_ATTR_DIRECTORY</span>
    <span class='id identifier rubyid_search'>search</span> <span class='op'>=</span> <span class='int'>1</span>
  <span class='kw'>elsif</span> <span class='id identifier rubyid_path'>path</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_path'>path</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\\</span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_data'>data</span> <span class='op'>=</span> <span class='const'>Rex</span><span class='op'>::</span><span class='const'>Text</span><span class='period'>.</span><span class='id identifier rubyid_to_unicode'>to_unicode</span><span class='lparen'>(</span><span class='id identifier rubyid_path'>path</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_length'>length</span> <span class='op'>=</span> <span class='int'>0</span>
    <span class='id identifier rubyid_ea'>ea</span> <span class='op'>=</span> <span class='int'>0x21</span>
    <span class='id identifier rubyid_alloc'>alloc</span> <span class='op'>=</span> <span class='int'>0</span> <span class='comment'># 0Mb
</span>    <span class='id identifier rubyid_attrib'>attrib</span> <span class='op'>=</span> <span class='const'>CONST</span><span class='op'>::</span><span class='const'>SMB_EXT_FILE_ATTR_DIRECTORY</span>
    <span class='id identifier rubyid_search'>search</span> <span class='op'>=</span> <span class='int'>1</span>
  <span class='kw'>else</span>
    <span class='kw'>return</span> <span class='id identifier rubyid_smb_error'>smb_error</span><span class='lparen'>(</span><span class='const'>CONST</span><span class='op'>::</span><span class='const'>SMB_COM_TRANSACTION2</span><span class='comma'>,</span> <span class='id identifier rubyid_c'>c</span><span class='comma'>,</span> <span class='const'>CONST</span><span class='op'>::</span><span class='const'>SMB_STATUS_NO_SUCH_FILE</span><span class='comma'>,</span> <span class='kw'>true</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_send_find_full_directory_info_res'>send_find_full_directory_info_res</span><span class='lparen'>(</span><span class='id identifier rubyid_c'>c</span><span class='comma'>,</span> <span class='lbrace'>{</span>
    <span class='label'>data:</span> <span class='id identifier rubyid_data'>data</span><span class='comma'>,</span>
    <span class='label'>end_of_file:</span> <span class='id identifier rubyid_length'>length</span><span class='comma'>,</span>
    <span class='label'>ea_error_offset:</span> <span class='id identifier rubyid_ea'>ea</span><span class='comma'>,</span>
    <span class='label'>allocation_size:</span> <span class='id identifier rubyid_alloc'>alloc</span><span class='comma'>,</span>
    <span class='label'>file_attributes:</span> <span class='id identifier rubyid_attrib'>attrib</span><span class='comma'>,</span>
    <span class='label'>search_count:</span> <span class='id identifier rubyid_search'>search</span><span class='comma'>,</span>
    <span class='label'>search_offset:</span> <span class='id identifier rubyid_search'>search</span>
  <span class='rbrace'>}</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="smb_cmd_find_file_names_info-instance_method">
  
    - (<tt>Fixnum</tt>) <strong>smb_cmd_find_file_names_info</strong>(c, path) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Handles a TRANS2_FIND_FIRST2 transaction request with
SMB_FIND_FILE_NAMES_INFO Information Level.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>c</span>
      
      
        <span class='type'>(<tt>Socket</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The client sending the request.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>path</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The path which the client is requesting info from.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Fixnum</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The number of bytes returned to the client as response.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


60
61
62
63
64
65
66
67
68
69
70
71
72</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/exploit/smb/server/share/information_level/find.rb', line 60</span>

<span class='kw'>def</span> <span class='id identifier rubyid_smb_cmd_find_file_names_info'>smb_cmd_find_file_names_info</span><span class='lparen'>(</span><span class='id identifier rubyid_c'>c</span><span class='comma'>,</span> <span class='id identifier rubyid_path'>path</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_path'>path</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_path'>path</span><span class='period'>.</span><span class='id identifier rubyid_ends_with?'>ends_with?</span><span class='lparen'>(</span><span class='id identifier rubyid_file_name'>file_name</span><span class='period'>.</span><span class='id identifier rubyid_downcase'>downcase</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_data'>data</span> <span class='op'>=</span> <span class='const'>Rex</span><span class='op'>::</span><span class='const'>Text</span><span class='period'>.</span><span class='id identifier rubyid_to_unicode'>to_unicode</span><span class='lparen'>(</span><span class='id identifier rubyid_file_name'>file_name</span><span class='rparen'>)</span>
  <span class='kw'>elsif</span> <span class='id identifier rubyid_path'>path</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_folder_name'>folder_name</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_path'>path</span><span class='period'>.</span><span class='id identifier rubyid_ends_with?'>ends_with?</span><span class='lparen'>(</span><span class='id identifier rubyid_folder_name'>folder_name</span><span class='period'>.</span><span class='id identifier rubyid_downcase'>downcase</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_data'>data</span> <span class='op'>=</span> <span class='const'>Rex</span><span class='op'>::</span><span class='const'>Text</span><span class='period'>.</span><span class='id identifier rubyid_to_unicode'>to_unicode</span><span class='lparen'>(</span><span class='id identifier rubyid_path'>path</span><span class='rparen'>)</span>
  <span class='kw'>elsif</span> <span class='id identifier rubyid_path'>path</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_path'>path</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\\</span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_data'>data</span> <span class='op'>=</span> <span class='const'>Rex</span><span class='op'>::</span><span class='const'>Text</span><span class='period'>.</span><span class='id identifier rubyid_to_unicode'>to_unicode</span><span class='lparen'>(</span><span class='id identifier rubyid_path'>path</span><span class='rparen'>)</span>
  <span class='kw'>else</span>
    <span class='kw'>return</span> <span class='id identifier rubyid_smb_error'>smb_error</span><span class='lparen'>(</span><span class='const'>CONST</span><span class='op'>::</span><span class='const'>SMB_COM_TRANSACTION2</span><span class='comma'>,</span> <span class='id identifier rubyid_c'>c</span><span class='comma'>,</span> <span class='const'>CONST</span><span class='op'>::</span><span class='const'>SMB_STATUS_NO_SUCH_FILE</span><span class='comma'>,</span> <span class='kw'>true</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_send_find_file_names_info_res'>send_find_file_names_info_res</span><span class='lparen'>(</span><span class='id identifier rubyid_c'>c</span><span class='comma'>,</span> <span class='lbrace'>{</span> <span class='label'>data:</span> <span class='id identifier rubyid_data'>data</span> <span class='rbrace'>}</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

    <div id="footer">
  Generated on Tue Jan 19 22:34:46 2016 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.8.7.6 (ruby-2.1.7).
</div>

  </body>
</html>